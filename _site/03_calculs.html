<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jordan Ouellette-Plante" />

<meta name="date" content="2021-09-30" />

<title>Calculs des captures à l’âge</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Morue</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="01_preparation_programme.html">1. Préparation initiale</a>
</li>
<li>
  <a href="02_preparation_data.html">2. Préparation des intrants</a>
</li>
<li>
  <a href="03_calculs.html">3. Calculs</a>
</li>
<li>
  <a href="04_comparaisons_valeurs_historiques.html">4. Comparaisons avec valeurs historiques</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Calculs des captures à l’âge</h1>
<h4 class="author">Jordan Ouellette-Plante</h4>
<h4 class="date">2021-09-30</h4>

</div>


<div id="objectifs" class="section level1">
<h1><span class="header-section-number">1</span> Objectifs</h1>
<p>Calculer les :</p>
<ul>
<li>Captures à l’âge annuelles</li>
<li>Poids moyens à l’âge annuelles</li>
<li>Longueur moyennes à l’âge annuelles</li>
</ul>
</div>
<div id="initialisation" class="section level1">
<h1><span class="header-section-number">2</span> Initialisation</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Pour le fichier Rmarkdown</span></a>
<a class="sourceLine" id="cb1-2" title="2">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> T, <span class="dt">collapse =</span> T, <span class="dt">fig.align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">fig.width =</span> <span class="dv">9</span>, </a>
<a class="sourceLine" id="cb1-3" title="3">                      <span class="dt">fig.height =</span> <span class="dv">6</span>, <span class="dt">message =</span> F, <span class="dt">warning =</span> F)</a></code></pre></div>
<div id="répertoires-et-infos-utiles" class="section level2">
<h2><span class="header-section-number">2.1</span> Répertoires et infos utiles</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">temp &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.R&quot;</span>) <span class="co"># https://gist.github.com/noamross/a549ee50e8a4fd68b8b1</span></a>
<a class="sourceLine" id="cb2-2" title="2">knitr<span class="op">::</span><span class="kw">purl</span>(<span class="dt">input =</span> <span class="st">&quot;01_preparation_programme.Rmd&quot;</span>, <span class="dt">output =</span> temp, <span class="dt">quiet =</span> T)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">## [1] &quot;C:\\Users\\OUELLE~1\\AppData\\Local\\Temp\\1\\RtmpCqyFQv\\file42423b05eb3.R&quot;</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">source</span>(temp)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">rm</span>(temp)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">source</span>(<span class="st">&quot;~/R/Fonctions_DSDB/plot_diag_lm.R&quot;</span>, <span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) <span class="co"># pour les figures diagnostiques de régressions</span></a></code></pre></div>
</div>
<div id="packages-requis" class="section level2">
<h2><span class="header-section-number">2.2</span> packages requis</h2>
<p>Des packages supplémentaires sont requis.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">library</span>(grid)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">library</span>(RColorBrewer)</a></code></pre></div>
</div>
</div>
<div id="relations-masse-longueur" class="section level1">
<h1><span class="header-section-number">3</span> Relations masse-longueur</h1>
<p>Le poids des échantillons est souvent manquant et n’est pas corrigé pour avoir la valeur en équivalents <em>poissons ronds</em>. Pour pallier à ça, le poids des échantillons est reconstruit d’après les fréquences de longueur associées à chaque échantillon. J’utilise une courbe masse-longueur provenant des relevés écosystémiques d’été (série <em>Alfred Needler</em>/<em>Teleost</em>) et d’hiver (série <em>Gadus Atlantica</em>). Pour les mois de janvier-mars et octobre-décembre, la relation masse-longueur obtenue d’après le relevé hivernal a été utilisée. Si aucune donnée du relevé hivernal n’était disponible ou si les mois étaient avril-septembre, la relation masse-longueur obtenue d’après le relevé estival était utilisée. Cette approche était celle utilisée par <span class="citation">Fréchet et Schwab (<a href="#ref-Frechet1992_fr" role="doc-biblioref">1992</a>)</span>. Pour les années où je n’ai aucune donnée, j’utilise les données les plus rapprochées disponibles.</p>
<p>J’utilise la même méthode que dans <span class="citation">Bourdages et Ouellet (<a href="#ref-Bourdages2011_fr" role="doc-biblioref">2011</a>)</span> pour éliminer certaines morues à ne pas utiliser dans le calcul de la relation masse-longueur.</p>
<p>EVB utilise les données biologiques de l’échantillonnage à quai pour le maquereau. Pour la morue, le poids individuel n’est cependant pas une valeur prise et c’est pour cette raison que je me rabats sur les données des relevés écosystémiques du MPO.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Série AN-TE</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">load</span>(intrant_ngsl) <span class="co"># ouvre ngsl</span></a>
<a class="sourceLine" id="cb4-3" title="3">dat_NGSL &lt;-<span class="st"> </span>ngsl<span class="op">$</span>carbio <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">            </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(longueur), <span class="op">!</span><span class="kw">is.na</span>(pds_tot)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># je me fous de type_ech, je veux le plus de morues</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">            </span><span class="kw">left_join</span>(., ngsl<span class="op">$</span>set <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(nav, rel, trait, annee, opano), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;nav&quot;</span>, <span class="st">&quot;rel&quot;</span>, <span class="st">&quot;trait&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="st">            </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="st">&quot;estival&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="st">            </span><span class="kw">select</span>(nav, rel, trait, espece, annee, longueur, pds_tot, type, opano)</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="kw">dim</span>(dat_NGSL) <span class="co"># 53111 obs et 9 var</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">## [1] 53111     9</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="kw">rm</span>(ngsl)</a>
<a class="sourceLine" id="cb4-11" title="11"></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co"># Série Gadus</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="kw">load</span>(intrant_Gadus) <span class="co"># ouvre gadus</span></a>
<a class="sourceLine" id="cb4-14" title="14">dat_GA &lt;-<span class="st"> </span>gadus<span class="op">$</span>carbio <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="st">          </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(longueur), <span class="op">!</span><span class="kw">is.na</span>(pds_tot)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="st">          </span><span class="kw">left_join</span>(., gadus<span class="op">$</span>set <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(nav, rel, trait, annee, opano), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;nav&quot;</span>, <span class="st">&quot;rel&quot;</span>, <span class="st">&quot;trait&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="st">&quot;hivernal&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="st">          </span><span class="kw">select</span>(nav, rel, trait, espece, annee, longueur, pds_tot, type, opano)</a>
<a class="sourceLine" id="cb4-19" title="19"><span class="kw">dim</span>(dat_GA) <span class="co"># 14296 obs et 9 var</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">## [1] 14296     9</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="kw">rm</span>(gadus)</a>
<a class="sourceLine" id="cb4-22" title="22"></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co"># Combinaison des données. J&#39;utilise toutes les morues disponibles, qu&#39;importe leur provenance</span></a>
<a class="sourceLine" id="cb4-24" title="24">dat &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(dat_NGSL, dat_GA)</a>
<a class="sourceLine" id="cb4-25" title="25"><span class="kw">dim</span>(dat) <span class="co"># 67407 obs et 9 var</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">## [1] 67407     9</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="kw">rm</span>(dat_NGSL, dat_GA)</a>
<a class="sourceLine" id="cb4-28" title="28"></a>
<a class="sourceLine" id="cb4-29" title="29"><span class="kw">table</span>(dat<span class="op">$</span>opano, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># d&#39;où proviennent les morues de 4Vn et 3Ps?</span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co">##   3Pn   3Ps    4R    4S    4T   4Vn  &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb4-32" title="32"><span class="co">##  4506   354 35007 23426  3896   218     0</span></a>
<a class="sourceLine" id="cb4-33" title="33">dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(opano <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;3Ps&quot;</span>, <span class="st">&quot;4Vn&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(nav, annee, type, opano) <span class="op">%&gt;%</span><span class="st"> </span>count</a>
<a class="sourceLine" id="cb4-34" title="34"><span class="co">## # A tibble: 4 x 5</span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">## # Groups:   nav, annee, type, opano [4]</span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="co">##     nav annee type     opano     n</span></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co">##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co">## 1    20  1994 hivernal 3Ps     354</span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">## 2    20  1994 hivernal 4Vn     199</span></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="co">## 3    39  2006 estival  4Vn      11</span></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">## 4    39  2009 estival  4Vn       8</span></a>
<a class="sourceLine" id="cb4-42" title="42"><span class="co"># Je crois que ces stations ont été faites par inadvertance à l&#39;extérieur de 4RST...</span></a>
<a class="sourceLine" id="cb4-43" title="43"><span class="co"># Calcul des relations masse-longueur</span></a>
<a class="sourceLine" id="cb4-44" title="44">rels &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">annee =</span> <span class="kw">c</span>(<span class="dv">1993</span><span class="op">:</span><span class="dv">2020</span>, <span class="dv">1993</span><span class="op">:</span><span class="dv">1994</span>),</a>
<a class="sourceLine" id="cb4-45" title="45">               <span class="dt">type =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;estival&quot;</span>, <span class="kw">length</span>(<span class="dv">1993</span><span class="op">:</span><span class="dv">2020</span>)), <span class="kw">rep</span>(<span class="st">&quot;hivernal&quot;</span>, <span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb4-46" title="46">               <span class="dt">n_brute =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb4-47" title="47">               <span class="dt">n_net =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb4-48" title="48">               <span class="dt">intercept =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb4-49" title="49">               <span class="dt">slope =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb4-50" title="50">               <span class="dt">r_squared =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb4-51" title="51">               <span class="dt">source =</span> <span class="ot">NA</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-52" title="52"><span class="st">        </span><span class="kw">arrange</span>(annee, type)</a>
<a class="sourceLine" id="cb4-53" title="53">rels</a>
<a class="sourceLine" id="cb4-54" title="54"><span class="co">## # A tibble: 30 x 8</span></a>
<a class="sourceLine" id="cb4-55" title="55"><span class="co">##    annee type     n_brute n_net intercept slope r_squared source</span></a>
<a class="sourceLine" id="cb4-56" title="56"><span class="co">##    &lt;int&gt; &lt;chr&gt;    &lt;lgl&gt;   &lt;lgl&gt; &lt;lgl&gt;     &lt;lgl&gt; &lt;lgl&gt;     &lt;lgl&gt; </span></a>
<a class="sourceLine" id="cb4-57" title="57"><span class="co">##  1  1993 estival  NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-58" title="58"><span class="co">##  2  1993 hivernal NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-59" title="59"><span class="co">##  3  1994 estival  NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-60" title="60"><span class="co">##  4  1994 hivernal NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-61" title="61"><span class="co">##  5  1995 estival  NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-62" title="62"><span class="co">##  6  1996 estival  NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-63" title="63"><span class="co">##  7  1997 estival  NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-64" title="64"><span class="co">##  8  1998 estival  NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-65" title="65"><span class="co">##  9  1999 estival  NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-66" title="66"><span class="co">## 10  2000 estival  NA      NA    NA        NA    NA        NA    </span></a>
<a class="sourceLine" id="cb4-67" title="67"><span class="co">## # ... with 20 more rows</span></a>
<a class="sourceLine" id="cb4-68" title="68"></a>
<a class="sourceLine" id="cb4-69" title="69">diags &lt;-<span class="st"> </span><span class="kw">list</span>() <span class="co"># liste vide où je vais mettre toutes les figures diagnostiques</span></a>
<a class="sourceLine" id="cb4-70" title="70"></a>
<a class="sourceLine" id="cb4-71" title="71"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(rels)){</a>
<a class="sourceLine" id="cb4-72" title="72">  y &lt;-<span class="st"> </span>rels<span class="op">$</span>annee[i]</a>
<a class="sourceLine" id="cb4-73" title="73">  t &lt;-<span class="st"> </span>rels<span class="op">$</span>type[i]</a>
<a class="sourceLine" id="cb4-74" title="74">  <span class="co"># Sélection des morues à utiliser</span></a>
<a class="sourceLine" id="cb4-75" title="75">  cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">with</span>(dat, annee <span class="op">==</span><span class="st"> </span>y <span class="op">&amp;</span><span class="st"> </span>type <span class="op">==</span><span class="st"> </span>t))</a>
<a class="sourceLine" id="cb4-76" title="76"></a>
<a class="sourceLine" id="cb4-77" title="77">  <span class="co"># Ménage des données pour le modèle, comme dans @Bourdages2011_fr</span></a>
<a class="sourceLine" id="cb4-78" title="78">  temp &lt;-<span class="st"> </span>dat[cor, ] <span class="co"># données à utiliser</span></a>
<a class="sourceLine" id="cb4-79" title="79">  rels<span class="op">$</span>n_brute[i] &lt;-<span class="st"> </span><span class="kw">length</span>(cor) <span class="co"># nombre de morues initialement disponible</span></a>
<a class="sourceLine" id="cb4-80" title="80"></a>
<a class="sourceLine" id="cb4-81" title="81">  mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(pds_tot <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(longueur <span class="op">/</span><span class="st"> </span><span class="dv">10</span>), <span class="dt">data =</span> temp) <span class="co"># longueur en cm, poids en kg.</span></a>
<a class="sourceLine" id="cb4-82" title="82">  resid_studentized &lt;-<span class="st"> </span><span class="kw">rstudent</span>(mod)</a>
<a class="sourceLine" id="cb4-83" title="83">  <span class="co">#hist(resid_studentized, main = &quot;Studentized Residual Distribution&quot;)</span></a>
<a class="sourceLine" id="cb4-84" title="84">  </a>
<a class="sourceLine" id="cb4-85" title="85">  <span class="co"># J&#39;enlève les lignes où la valeurs des résidus est &lt; -1.5 ou &gt; 1.5 (comme Hugo)</span></a>
<a class="sourceLine" id="cb4-86" title="86">  <span class="co">#length(resid_studentized)</span></a>
<a class="sourceLine" id="cb4-87" title="87">  cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">abs</span>(resid_studentized) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb4-88" title="88">  <span class="co">#length(cor)</span></a>
<a class="sourceLine" id="cb4-89" title="89">  </a>
<a class="sourceLine" id="cb4-90" title="90">  <span class="co"># Calcul des coefficients à utiliser avec les données nettoyées</span></a>
<a class="sourceLine" id="cb4-91" title="91">  temp &lt;-<span class="st"> </span>temp[cor, ] <span class="co"># les morues que je conserve au final</span></a>
<a class="sourceLine" id="cb4-92" title="92">  rels<span class="op">$</span>n_net[i] &lt;-<span class="st"> </span><span class="kw">length</span>(cor) <span class="co"># nombre de morues utilisées au final pour établir la relation masse-longueur</span></a>
<a class="sourceLine" id="cb4-93" title="93">  </a>
<a class="sourceLine" id="cb4-94" title="94">  mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(pds_tot <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(longueur <span class="op">/</span><span class="st"> </span><span class="dv">10</span>), <span class="dt">data =</span> temp) <span class="co"># longueur en cm, poids en kg.</span></a>
<a class="sourceLine" id="cb4-95" title="95">  </a>
<a class="sourceLine" id="cb4-96" title="96">  <span class="co"># Création des figures de diagnostique (1 par année)</span></a>
<a class="sourceLine" id="cb4-97" title="97">  title &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">draw_label</span>(<span class="kw">paste0</span>(y, <span class="st">&quot;-&quot;</span>, t), <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>)</a>
<a class="sourceLine" id="cb4-98" title="98">  graph &lt;-<span class="st"> </span><span class="kw">plot_diag_lm</span>(mod, <span class="dt">langue =</span> <span class="st">&quot;fr&quot;</span>)</a>
<a class="sourceLine" id="cb4-99" title="99">  diags[[i]] &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(title, graph, </a>
<a class="sourceLine" id="cb4-100" title="100">                                          <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb4-101" title="101">  </a>
<a class="sourceLine" id="cb4-102" title="102">  <span class="co"># Transfert des valeurs utiles dans une table</span></a>
<a class="sourceLine" id="cb4-103" title="103">  rels<span class="op">$</span>intercept[i] &lt;-<span class="st"> </span><span class="kw">coef</span>(<span class="kw">summary</span>(mod))[<span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">3</span>) <span class="co"># conserve 3 décimales</span></a>
<a class="sourceLine" id="cb4-104" title="104">  rels<span class="op">$</span>slope[i] &lt;-<span class="st"> </span><span class="kw">coef</span>(<span class="kw">summary</span>(mod))[<span class="dv">2</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">3</span>) <span class="co"># conserve 3 décimales</span></a>
<a class="sourceLine" id="cb4-105" title="105">  rels<span class="op">$</span>r_squared[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(mod)<span class="op">$</span>adj.r.squared <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">3</span>) <span class="co"># conserve 3 décimales</span></a>
<a class="sourceLine" id="cb4-106" title="106">  rels<span class="op">$</span>source[i] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(t <span class="op">==</span><span class="st"> &quot;estival&quot;</span>, <span class="kw">paste</span>(<span class="st">&quot;RE&quot;</span>, y), <span class="kw">paste</span>(<span class="st">&quot;RH&quot;</span>, y)) <span class="co"># RE = relevé estival, RH = relevé hivernal</span></a>
<a class="sourceLine" id="cb4-107" title="107">  <span class="kw">rm</span>(y, t, cor, temp, mod, resid_studentized, title, graph)  </a>
<a class="sourceLine" id="cb4-108" title="108">}</a></code></pre></div>
<p>Comment sont les figures diagnostiques?</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(diags)){</a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="kw">print</span>(diags[[i]])</a>
<a class="sourceLine" id="cb5-3" title="3">}</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-5-1.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-2.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-3.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-4.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-5.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-6.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-7.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-8.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-9.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-10.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-11.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-12.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-13.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-14.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-15.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-16.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-17.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-18.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-19.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-20.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-21.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-22.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-23.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-24.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-25.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-26.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-27.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-28.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-29.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-5-30.png" width="864" style="display: block; margin: auto;" /> Après vérification des figures diagnostiques, j’en conclus que chaque régression satisfait aux prémisses d’un modèle de régression linéaire simple.</p>
<p>Maintenant, je vais créer un jeu <code>lw</code> que je vais pouvoir utiliser plus bas.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># fichier de base que je dois remplir</span></a>
<a class="sourceLine" id="cb6-2" title="2">lw &lt;-<span class="st"> </span><span class="kw">expand_grid</span>(<span class="dt">annee =</span> my_year, <span class="dt">mois =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw">ifelse</span>(mois <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">12</span>), <span class="st">&quot;hivernal&quot;</span>, <span class="st">&quot;estival&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">      </span><span class="kw">arrange</span>(annee, mois)</a>
<a class="sourceLine" id="cb6-5" title="5">lw</a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">## # A tibble: 336 x 3</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">##    annee  mois type    </span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;   </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">##  1  1993     1 hivernal</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">##  2  1993     2 hivernal</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">##  3  1993     3 hivernal</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">##  4  1993     4 estival </span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">##  5  1993     5 estival </span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">##  6  1993     6 estival </span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">##  7  1993     7 estival </span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">##  8  1993     8 estival </span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">##  9  1993     9 estival </span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">## 10  1993    10 hivernal</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">## # ... with 326 more rows</span></a>
<a class="sourceLine" id="cb6-20" title="20"></a>
<a class="sourceLine" id="cb6-21" title="21">lw &lt;-<span class="st"> </span><span class="kw">left_join</span>(lw, rels, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;type&quot;</span>))</a>
<a class="sourceLine" id="cb6-22" title="22">cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">with</span>(lw, <span class="kw">is.na</span>(n_brute))) <span class="co"># lignes où le merge n&#39;a pas fonctionné</span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="kw">length</span>(cor) <span class="co"># 156 lignes</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="co">## [1] 156</span></a>
<a class="sourceLine" id="cb6-25" title="25"><span class="kw">unique</span>(lw<span class="op">$</span>type[cor]) </a>
<a class="sourceLine" id="cb6-26" title="26"><span class="co">## [1] &quot;hivernal&quot;</span></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="co"># Pour ces lignes, on aurait voulu les données du Gadus, mais elles n&#39;existent pas.</span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="co"># On prend donc les coefficients de la régression estival à la place</span></a>
<a class="sourceLine" id="cb6-29" title="29"></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="kw">dim</span>(lw) <span class="co"># 336 obs et 9 var</span></a>
<a class="sourceLine" id="cb6-31" title="31"><span class="co">## [1] 336   9</span></a>
<a class="sourceLine" id="cb6-32" title="32">lw &lt;-<span class="st"> </span><span class="kw">left_join</span>(lw, rels <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;estival&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>type), <span class="dt">by =</span> <span class="st">&quot;annee&quot;</span>)</a>
<a class="sourceLine" id="cb6-33" title="33"><span class="kw">dim</span>(lw) <span class="co"># 336 obs et 15 var</span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="co">## [1] 336  15</span></a>
<a class="sourceLine" id="cb6-35" title="35"></a>
<a class="sourceLine" id="cb6-36" title="36">lw<span class="op">$</span>n_brute.x[cor] &lt;-<span class="st"> </span>lw<span class="op">$</span>n_brute.y[cor]</a>
<a class="sourceLine" id="cb6-37" title="37">lw<span class="op">$</span>n_net.x[cor] &lt;-<span class="st"> </span>lw<span class="op">$</span>n_net.y[cor]</a>
<a class="sourceLine" id="cb6-38" title="38">lw<span class="op">$</span>intercept.x[cor] &lt;-<span class="st"> </span>lw<span class="op">$</span>intercept.y[cor]</a>
<a class="sourceLine" id="cb6-39" title="39">lw<span class="op">$</span>slope.x[cor] &lt;-<span class="st"> </span>lw<span class="op">$</span>slope.y[cor]</a>
<a class="sourceLine" id="cb6-40" title="40">lw<span class="op">$</span>r_squared.x[cor] &lt;-<span class="st"> </span>lw<span class="op">$</span>r_squared.y[cor]</a>
<a class="sourceLine" id="cb6-41" title="41">lw<span class="op">$</span>source.x[cor] &lt;-<span class="st"> </span>lw<span class="op">$</span>source.y[cor]</a>
<a class="sourceLine" id="cb6-42" title="42"></a>
<a class="sourceLine" id="cb6-43" title="43">lw[, <span class="kw">c</span>(<span class="st">&quot;n_brute.y&quot;</span>, <span class="st">&quot;n_net.y&quot;</span>, <span class="st">&quot;intercept.y&quot;</span>, <span class="st">&quot;slope.y&quot;</span>, <span class="st">&quot;r_squared.y&quot;</span>, <span class="st">&quot;source.y&quot;</span>)] &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># rendu inutile</span></a>
<a class="sourceLine" id="cb6-44" title="44"><span class="kw">names</span>(lw) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">.x&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">names</span>(lw))</a>
<a class="sourceLine" id="cb6-45" title="45">cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">with</span>(lw, <span class="kw">is.na</span>(n_brute))); <span class="kw">length</span>(cor) <span class="co"># 0 ligne = tout est beau.</span></a>
<a class="sourceLine" id="cb6-46" title="46"><span class="co">## [1] 0</span></a>
<a class="sourceLine" id="cb6-47" title="47"><span class="kw">rm</span>(cor, rels)</a>
<a class="sourceLine" id="cb6-48" title="48"></a>
<a class="sourceLine" id="cb6-49" title="49"><span class="kw">dim</span>(lw) <span class="co"># 336 obs et 9 var</span></a>
<a class="sourceLine" id="cb6-50" title="50"><span class="co">## [1] 336   9</span></a>
<a class="sourceLine" id="cb6-51" title="51"><span class="kw">save</span>(lw, <span class="dt">file =</span> dat_lw)</a>
<a class="sourceLine" id="cb6-52" title="52"></a>
<a class="sourceLine" id="cb6-53" title="53">lw</a>
<a class="sourceLine" id="cb6-54" title="54"><span class="co">## # A tibble: 336 x 9</span></a>
<a class="sourceLine" id="cb6-55" title="55"><span class="co">##    annee  mois type     n_brute n_net intercept slope r_squared source </span></a>
<a class="sourceLine" id="cb6-56" title="56"><span class="co">##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb6-57" title="57"><span class="co">##  1  1993     1 hivernal    1097  1000     -12.2  3.13     0.995 RH 1993</span></a>
<a class="sourceLine" id="cb6-58" title="58"><span class="co">##  2  1993     2 hivernal    1097  1000     -12.2  3.13     0.995 RH 1993</span></a>
<a class="sourceLine" id="cb6-59" title="59"><span class="co">##  3  1993     3 hivernal    1097  1000     -12.2  3.13     0.995 RH 1993</span></a>
<a class="sourceLine" id="cb6-60" title="60"><span class="co">##  4  1993     4 estival      477   449     -12.0  3.10     0.99  RE 1993</span></a>
<a class="sourceLine" id="cb6-61" title="61"><span class="co">##  5  1993     5 estival      477   449     -12.0  3.10     0.99  RE 1993</span></a>
<a class="sourceLine" id="cb6-62" title="62"><span class="co">##  6  1993     6 estival      477   449     -12.0  3.10     0.99  RE 1993</span></a>
<a class="sourceLine" id="cb6-63" title="63"><span class="co">##  7  1993     7 estival      477   449     -12.0  3.10     0.99  RE 1993</span></a>
<a class="sourceLine" id="cb6-64" title="64"><span class="co">##  8  1993     8 estival      477   449     -12.0  3.10     0.99  RE 1993</span></a>
<a class="sourceLine" id="cb6-65" title="65"><span class="co">##  9  1993     9 estival      477   449     -12.0  3.10     0.99  RE 1993</span></a>
<a class="sourceLine" id="cb6-66" title="66"><span class="co">## 10  1993    10 hivernal    1097  1000     -12.2  3.13     0.995 RH 1993</span></a>
<a class="sourceLine" id="cb6-67" title="67"><span class="co">## # ... with 326 more rows</span></a></code></pre></div>
</div>
<div id="préparation-des-données" class="section level1">
<h1><span class="header-section-number">4</span> Préparation des données</h1>
<div id="échantillonneurs-à-quai" class="section level2">
<h2><span class="header-section-number">4.1</span> Échantillonneurs à quai</h2>
<div id="fl" class="section level3">
<h3><span class="header-section-number">4.1.1</span> FL</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Ouverture</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">load</span>(dat_LF); <span class="kw">dim</span>(lf) <span class="co"># 137136 obs et 38 var</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">## [1] 137136     38</span></a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co"># Variables d&#39;intérêt, bonnes années, pas d&#39;outliers</span></a>
<a class="sourceLine" id="cb7-6" title="6">lf_caa &lt;-<span class="st"> </span>lf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="st">          </span><span class="kw">filter</span>(annee <span class="op">%in%</span><span class="st"> </span>my_year, outlier <span class="op">==</span><span class="st"> </span>F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="st">          </span><span class="kw">select</span>(annee, mois, opano, engin, longueur, n_mes, ech_id, source)</a>
<a class="sourceLine" id="cb7-9" title="9"><span class="kw">dim</span>(lf_caa) <span class="co"># 57270 obs et 8 var</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">## [1] 57270     8</span></a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co"># Regroupements d&#39;engins</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="kw">load</span>(dat_engin_obs); <span class="kw">dim</span>(engins_obs) <span class="co"># 14 obs et 4 var</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">## [1] 14  4</span></a>
<a class="sourceLine" id="cb7-15" title="15">engins_obs</a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">## # A tibble: 14 x 4</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">##    engin engin_fr                          engin_en                 engin_groupe</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">##    &lt;chr&gt; &lt;chr&gt;                             &lt;chr&gt;                    &lt;ord&gt;       </span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">##  1 GNS   Filets maillants calés (ancrés)   Set gillnets (anchored)  Gillnets    </span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">##  2 LLS   Palangres calées                  Set longlines            Longlines   </span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">##  3 GN    Filets maillants (non spécifiés)  Gillnets (not specified) Gillnets    </span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">##  4 LL    Palangres (non spécifiées)        Longlines (not specifie~ Longlines   </span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">##  5 LLG   Palangrotte                       Handline                 Hand gear   </span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">##  6 FPN   Filets-pièges fixes non couverts  Stationary uncovered po~ Traps       </span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">##  7 LX    Hameçons et lignes (non spécifié~ Hooks and lines (not sp~ Hand gear   </span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">##  8 OTB2  Chalut de fond à panneaux (arriè~ Stern otter trawls       Other trawls</span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">##  9 FIX   Pièges (non spécifiés)            Traps (not specified)    Traps       </span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">## 10 SDN   Seine danoise, écossaise, ou pai~ Danish, Scotish or pair~ Seines      </span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">## 11 LHP   Lignes à main et lignes à cannes~ Handlines and pole-line~ Hand gear   </span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">## 12 PS    Seine bourse                      Purse seine              Seines      </span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">## 13 OTM   Chalut pélagique                  Midwater trawl           Other trawls</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">## 14 ST    Chalut à crevette                 Shrimp trawl             Shrimp trawl</span></a>
<a class="sourceLine" id="cb7-33" title="33"></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="kw">dim</span>(lf_caa) <span class="co"># 57270 obs et 8 var</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">## [1] 57270     8</span></a>
<a class="sourceLine" id="cb7-36" title="36">lf_caa &lt;-<span class="st"> </span><span class="kw">left_join</span>(lf_caa, engins_obs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(engin, engin_groupe), <span class="dt">by =</span> <span class="st">&quot;engin&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">engin_groupe =</span> <span class="kw">as.character</span>(engin_groupe)) <span class="co"># je ne veux pas des facteurs</span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="kw">dim</span>(lf_caa) <span class="co"># 57270 obs et 9 var</span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">## [1] 57270     9</span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="kw">table</span>(lf_caa<span class="op">$</span>engin_groupe, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># parfait.</span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">##     Gillnets    Hand gear    Longlines Other trawls       Seines Shrimp trawl </span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">##        20263         3692        21299         1635         1077         7640 </span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">##        Traps         &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">##         1664            0</span></a>
<a class="sourceLine" id="cb7-46" title="46"></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="co"># zones unitaires de l&#39;OPANO</span></a>
<a class="sourceLine" id="cb7-48" title="48"><span class="kw">dim</span>(lf_caa) <span class="co"># 57270 obs et 9 var</span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="co">## [1] 57270     9</span></a>
<a class="sourceLine" id="cb7-50" title="50">lf_caa &lt;-<span class="st"> </span>lf_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;4R|4S|3Pn&quot;</span>, opano))</a>
<a class="sourceLine" id="cb7-51" title="51"><span class="kw">dim</span>(lf_caa) <span class="co"># 57270 obs et 9 var</span></a>
<a class="sourceLine" id="cb7-52" title="52"><span class="co">## [1] 57270     9</span></a>
<a class="sourceLine" id="cb7-53" title="53"><span class="kw">unique</span>(lf_caa<span class="op">$</span>opano) <span class="co"># les valeurs à 2 caractères (4R et 4S) sont des zones unitaires vagues (quelque part dans 4R ou 4S)</span></a>
<a class="sourceLine" id="cb7-54" title="54"><span class="co">##  [1] &quot;3Pn&quot; &quot;4R&quot;  &quot;4Ra&quot; &quot;4Rb&quot; &quot;4Rc&quot; &quot;4Rd&quot; &quot;4S&quot;  &quot;4Si&quot; &quot;4Ss&quot; &quot;4Sv&quot; &quot;4Sw&quot; &quot;4Sx&quot;</span></a>
<a class="sourceLine" id="cb7-55" title="55"><span class="co">## [13] &quot;4Sy&quot; &quot;4Sz&quot;</span></a>
<a class="sourceLine" id="cb7-56" title="56"></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="co"># Recalcul du poids de l&#39;échantillon</span></a>
<a class="sourceLine" id="cb7-58" title="58"><span class="kw">dim</span>(lf_caa) <span class="co"># 57270 obs et 9 var</span></a>
<a class="sourceLine" id="cb7-59" title="59"><span class="co">## [1] 57270     9</span></a>
<a class="sourceLine" id="cb7-60" title="60">lf_caa &lt;-<span class="st"> </span><span class="kw">left_join</span>(lf_caa, lw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(annee, mois, intercept, slope), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;mois&quot;</span>))</a>
<a class="sourceLine" id="cb7-61" title="61"><span class="kw">dim</span>(lf_caa) <span class="co"># 57270 obs et 11 var</span></a>
<a class="sourceLine" id="cb7-62" title="62"><span class="co">## [1] 57270    11</span></a>
<a class="sourceLine" id="cb7-63" title="63">lf_caa<span class="op">$</span>weight.unit &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">with</span>(lf_caa, intercept <span class="op">+</span><span class="st"> </span>slope <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(longueur))) <span class="co"># la longueur est déjà en cm. donne le pds en kg</span></a>
<a class="sourceLine" id="cb7-64" title="64"><span class="kw">summary</span>(lf_caa<span class="op">$</span>weight.unit) <span class="co"># aucune valeur NA = parfait</span></a>
<a class="sourceLine" id="cb7-65" title="65"><span class="co">##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></a>
<a class="sourceLine" id="cb7-66" title="66"><span class="co">##  0.00044  0.89102  1.62861  1.96531  2.57903 31.92444</span></a>
<a class="sourceLine" id="cb7-67" title="67"><span class="co"># ggplot(data = lf_caa, aes(x = longueur, y = weight.unit)) +</span></a>
<a class="sourceLine" id="cb7-68" title="68"><span class="co">#   geom_point(color = &quot;red&quot;, alpha = 0.25) +</span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="co">#   labs(x = &quot;Longueur (mm)&quot;, y = &quot;Masse (kg)&quot;)</span></a>
<a class="sourceLine" id="cb7-70" title="70"></a>
<a class="sourceLine" id="cb7-71" title="71">lf_caa[, <span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;slope&quot;</span>)] &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># rendu inutile</span></a>
<a class="sourceLine" id="cb7-72" title="72"></a>
<a class="sourceLine" id="cb7-73" title="73"><span class="co"># Classe de longueur: les longueurs sont déjà prises au cm près. je laisse ainsi</span></a>
<a class="sourceLine" id="cb7-74" title="74"></a>
<a class="sourceLine" id="cb7-75" title="75"><span class="co"># Renomme les colonnes (pour que les noms concordent avec ce que EVB utilise)</span></a>
<a class="sourceLine" id="cb7-76" title="76"><span class="kw">names</span>(lf_caa) &lt;-<span class="st"> </span><span class="kw">recode</span>(<span class="kw">names</span>(lf_caa), <span class="st">&quot;opano&quot;</span> =<span class="st"> &quot;region&quot;</span>, <span class="st">&quot;engin_groupe&quot;</span> =<span class="st"> &quot;gear&quot;</span>, <span class="st">&quot;mois&quot;</span> =<span class="st"> &quot;period&quot;</span>, <span class="st">&quot;annee&quot;</span> =<span class="st"> &quot;year&quot;</span>, </a>
<a class="sourceLine" id="cb7-77" title="77">                        <span class="st">&quot;longueur&quot;</span> =<span class="st"> &quot;length&quot;</span>, <span class="st">&quot;n_mes&quot;</span> =<span class="st"> &quot;n&quot;</span>, <span class="st">&quot;ech_id&quot;</span> =<span class="st"> &quot;sample.id&quot;</span>)</a>
<a class="sourceLine" id="cb7-78" title="78">lf_caa &lt;-<span class="st"> </span>lf_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, period, region, gear, sample.id, length, weight.unit, n, source) </a></code></pre></div>
<p>Je peux maintenant sauvegarder.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">save</span>(lf_caa, <span class="dt">file =</span> <span class="kw">paste0</span>(result, <span class="st">&quot;03_lf_caa.Rda&quot;</span>))</a></code></pre></div>
</div>
<div id="données-biologiques" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Données biologiques</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">load</span>(dat_bio); <span class="kw">dim</span>(bio) <span class="co"># 105098 obs et 26 var</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">## [1] 105098     26</span></a>
<a class="sourceLine" id="cb9-3" title="3"></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">names</span>(bio) &lt;-<span class="st"> </span><span class="kw">recode</span>(<span class="kw">names</span>(bio), <span class="st">&quot;annee&quot;</span> =<span class="st"> &quot;year&quot;</span>, <span class="st">&quot;mois&quot;</span> =<span class="st"> &quot;month&quot;</span>, <span class="st">&quot;opano&quot;</span> =<span class="st"> &quot;region&quot;</span>, <span class="st">&quot;engin&quot;</span> =<span class="st"> &quot;gear&quot;</span>, </a>
<a class="sourceLine" id="cb9-5" title="5">                     <span class="st">&quot;longueur&quot;</span> =<span class="st"> &quot;length&quot;</span>, <span class="st">&quot;ech_id&quot;</span> =<span class="st"> &quot;sample.id&quot;</span>)</a>
<a class="sourceLine" id="cb9-6" title="6"></a>
<a class="sourceLine" id="cb9-7" title="7">bio_caa &lt;-<span class="st"> </span>bio <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="st">           </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span>my_year, outlier <span class="op">==</span><span class="st"> </span>F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="st">           </span><span class="kw">select</span>(year, month, region, gear, length, age, sample.id, source) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="st">           </span>as_tibble</a>
<a class="sourceLine" id="cb9-11" title="11"><span class="kw">dim</span>(bio_caa) <span class="co"># 47294 obs et 8 var</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">## [1] 47294     8</span></a>
<a class="sourceLine" id="cb9-13" title="13">bio_caa</a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">## # A tibble: 47,294 x 8</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">##     year month region gear  length   age sample.id source</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">##    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt;     &lt;int&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">##  1  2011     7 4Sw    GNS       66     7     50722 quai  </span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">##  2  1994     5 4Rc    LLS       43     5       346 quai  </span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">##  3  2014     7 4Sw    GNS       54     7     56116 quai  </span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">##  4  1995     8 4Sv    GN        71    11      1654 quai  </span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">##  5  1995     8 4Sw    GN        38     4      1825 quai  </span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">##  6  1995    10 4Sw    GN        43     5      2111 quai  </span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">##  7  2019     8 4Si    GNS       61     7     64223 quai  </span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">##  8  2001    10 4Rc    LLS       53     7     15705 quai  </span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">##  9  1997     7 4Sw    GN        89    10      8296 quai  </span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">## 10  2002     8 4Sw    GNS       51     6     16168 quai  </span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">## # ... with 47,284 more rows</span></a>
<a class="sourceLine" id="cb9-28" title="28"></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="kw">table</span>(bio_caa<span class="op">$</span>age) <span class="co"># toutes les âges sont plausibles</span></a>
<a class="sourceLine" id="cb9-30" title="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-31" title="31"><span class="co">##    0    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15 </span></a>
<a class="sourceLine" id="cb9-32" title="32"><span class="co">##   72 1516 3274 3982 5280 5423 6749 6397 5667 4080 2415 1304  605  322  112   66 </span></a>
<a class="sourceLine" id="cb9-33" title="33"><span class="co">##   16   17   18 </span></a>
<a class="sourceLine" id="cb9-34" title="34"><span class="co">##   20    9    1</span></a>
<a class="sourceLine" id="cb9-35" title="35"><span class="kw">table</span>(bio_caa<span class="op">$</span>month, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># parfait</span></a>
<a class="sourceLine" id="cb9-36" title="36"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-37" title="37"><span class="co">##     1     2     3     4     5     6     7     8     9    10    11    12  &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-38" title="38"><span class="co">##   301    55   129   430  1870  2166  8772 24557  3563  3406  1308   737     0</span></a>
<a class="sourceLine" id="cb9-39" title="39"></a>
<a class="sourceLine" id="cb9-40" title="40"><span class="co"># Région d&#39;où proviennent les échantillons</span></a>
<a class="sourceLine" id="cb9-41" title="41"><span class="kw">unique</span>(bio_caa<span class="op">$</span>region) <span class="co"># les valeurs à 2 caractères (4R et 4S) sont des zones unitaires vagues (quelque part dans 4R ou 4S)</span></a>
<a class="sourceLine" id="cb9-42" title="42"><span class="co">##  [1] &quot;4Sw&quot; &quot;4Rc&quot; &quot;4Sv&quot; &quot;4Si&quot; &quot;4Sx&quot; &quot;4Rd&quot; &quot;4Ss&quot; &quot;4Sz&quot; &quot;4Rb&quot; &quot;4S&quot;  &quot;3Pn&quot; &quot;4Sy&quot;</span></a>
<a class="sourceLine" id="cb9-43" title="43"><span class="co">## [13] &quot;4R&quot;  &quot;4Ra&quot; NA</span></a>
<a class="sourceLine" id="cb9-44" title="44">bio_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">is.na</span>(region)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(source) <span class="op">%&gt;%</span><span class="st"> </span>unique <span class="co"># normal</span></a>
<a class="sourceLine" id="cb9-45" title="45"><span class="co">## [1] &quot;nGSL&quot;</span></a>
<a class="sourceLine" id="cb9-46" title="46"></a>
<a class="sourceLine" id="cb9-47" title="47"><span class="co"># Regroupements d&#39;engins</span></a>
<a class="sourceLine" id="cb9-48" title="48"><span class="kw">dim</span>(bio_caa) <span class="co"># 47294 obs et 8 var</span></a>
<a class="sourceLine" id="cb9-49" title="49"><span class="co">## [1] 47294     8</span></a>
<a class="sourceLine" id="cb9-50" title="50">bio_caa &lt;-<span class="st"> </span><span class="kw">left_join</span>(bio_caa, engins_obs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(engin, engin_groupe), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;gear&quot;</span> =<span class="st"> &quot;engin&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-51" title="51"><span class="st">           </span><span class="kw">mutate</span>(<span class="dt">engin_groupe =</span> <span class="kw">as.character</span>(engin_groupe)) <span class="co"># je ne veux pas des facteurs</span></a>
<a class="sourceLine" id="cb9-52" title="52"><span class="kw">dim</span>(bio_caa) <span class="co"># 47294 obs et 9 var</span></a>
<a class="sourceLine" id="cb9-53" title="53"><span class="co">## [1] 47294     9</span></a>
<a class="sourceLine" id="cb9-54" title="54"><span class="kw">table</span>(bio_caa<span class="op">$</span>engin_groupe, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># parfait.</span></a>
<a class="sourceLine" id="cb9-55" title="55"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-56" title="56"><span class="co">##     Gillnets    Hand gear    Longlines Other trawls       Seines Shrimp trawl </span></a>
<a class="sourceLine" id="cb9-57" title="57"><span class="co">##         9913          648        14501          914          866        19913 </span></a>
<a class="sourceLine" id="cb9-58" title="58"><span class="co">##        Traps         &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb9-59" title="59"><span class="co">##          539            0</span></a>
<a class="sourceLine" id="cb9-60" title="60">bio_caa<span class="op">$</span>gear &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># inutile maintenant</span></a>
<a class="sourceLine" id="cb9-61" title="61"></a>
<a class="sourceLine" id="cb9-62" title="62"><span class="co"># Classe de longueur: les longueurs sont déjà prises au cm près. je laisse ainsi</span></a>
<a class="sourceLine" id="cb9-63" title="63"></a>
<a class="sourceLine" id="cb9-64" title="64"><span class="co"># Renomme les colonnes (pour que les noms concordent avec ce que EVB utilise)</span></a>
<a class="sourceLine" id="cb9-65" title="65"><span class="kw">names</span>(bio_caa) &lt;-<span class="st"> </span><span class="kw">recode</span>(<span class="kw">names</span>(bio_caa), <span class="st">&quot;engin_groupe&quot;</span> =<span class="st"> &quot;gear&quot;</span>, <span class="st">&quot;month&quot;</span> =<span class="st"> &quot;period&quot;</span>)</a>
<a class="sourceLine" id="cb9-66" title="66">bio_caa &lt;-<span class="st"> </span>bio_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, period, region, gear, sample.id, length, age, source)</a></code></pre></div>
<p>Je peux maintenant sauvegarder.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">save</span>(bio_caa, <span class="dt">file =</span> <span class="kw">paste0</span>(result, <span class="st">&quot;03_bio_caa.Rda&quot;</span>))</a></code></pre></div>
</div>
</div>
<div id="débarquements" class="section level2">
<h2><span class="header-section-number">4.2</span> Débarquements</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">load</span>(dat_catch); <span class="kw">dim</span>(catch) <span class="co"># 593461 obs et 13 var</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">## [1] 593461     13</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">names</span>(catch) &lt;-<span class="st"> </span><span class="kw">recode</span>(<span class="kw">names</span>(catch), <span class="st">&quot;annee&quot;</span> =<span class="st"> &quot;year&quot;</span>, <span class="st">&quot;mois&quot;</span> =<span class="st"> &quot;period&quot;</span>, <span class="st">&quot;opano&quot;</span> =<span class="st"> &quot;region&quot;</span>, <span class="st">&quot;engin&quot;</span> =<span class="st"> &quot;gear&quot;</span>)</a>
<a class="sourceLine" id="cb11-4" title="4">catch &lt;-<span class="st"> </span>catch <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span>my_year) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, period, region, gear, catch)</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">dim</span>(catch) <span class="co"># 331398 obs et 5 var</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">## [1] 331398      5</span></a>
<a class="sourceLine" id="cb11-7" title="7"></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co"># Regroupements d&#39;engins</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw">dim</span>(catch) <span class="co"># 331398 obs et 5 var</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">## [1] 331398      5</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="kw">load</span>(dat_engin_deb) <span class="co"># engins_deb</span></a>
<a class="sourceLine" id="cb11-12" title="12">catch &lt;-<span class="st"> </span><span class="kw">left_join</span>(catch, engins_deb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(engin, engin_groupe), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;gear&quot;</span> =<span class="st"> &quot;engin&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">gear =</span> engin_groupe) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="st">         </span><span class="kw">select</span>(<span class="op">-</span>engin_groupe)</a>
<a class="sourceLine" id="cb11-15" title="15"><span class="kw">dim</span>(catch) <span class="co"># 331398 obs et 5 var</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">## [1] 331398      5</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="kw">table</span>(catch<span class="op">$</span>gear, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># 0 valeurs NA = parfait.</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">##     Shrimp trawl     Other trawls           Seines         Gillnets </span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="co">##             1767             8351             4514           163975 </span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">##        Longlines        Hand gear            Traps Others / unknown </span></a>
<a class="sourceLine" id="cb11-22" title="22"><span class="co">##           112523            36221             3936              111 </span></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="co">##             &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb11-24" title="24"><span class="co">##                0</span></a>
<a class="sourceLine" id="cb11-25" title="25"></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="co"># total catch by level</span></a>
<a class="sourceLine" id="cb11-27" title="27">catch_caa &lt;-<span class="st"> </span>catch <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-28" title="28"><span class="st">             </span><span class="kw">group_by</span>(year, region, period, gear) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># regroupe par strate</span></a>
<a class="sourceLine" id="cb11-29" title="29"><span class="st">             </span><span class="kw">summarise</span>(<span class="dt">catch =</span> <span class="kw">sum</span>(catch, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-30" title="30"><span class="st">             </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-31" title="31"><span class="st">             </span><span class="kw">filter</span>(catch <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># pour une raison inconnue, on pouvait avoir des strates avec 0 kg débarqué...</span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="st">             </span><span class="kw">select</span>(year, period, region, gear, catch) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="st">             </span><span class="kw">mutate</span>(<span class="dt">gear =</span> <span class="kw">as.character</span>(gear)) <span class="co"># je ne veux pas des facteurs</span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="kw">dim</span>(catch_caa) <span class="co"># 4591 obs et 5 var</span></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="co">## [1] 4591    5</span></a>
<a class="sourceLine" id="cb11-36" title="36"></a>
<a class="sourceLine" id="cb11-37" title="37"><span class="cf">if</span> (langue <span class="op">==</span><span class="st"> &quot;fr&quot;</span>){</a>
<a class="sourceLine" id="cb11-38" title="38">  misc &lt;-<span class="st"> &quot;Autres / inconnus&quot;</span></a>
<a class="sourceLine" id="cb11-39" title="39">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb11-40" title="40">  misc &lt;-<span class="st"> &quot;Others / unknown&quot;</span></a>
<a class="sourceLine" id="cb11-41" title="41">}</a>
<a class="sourceLine" id="cb11-42" title="42"></a>
<a class="sourceLine" id="cb11-43" title="43">cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">with</span>(catch_caa, gear <span class="op">==</span><span class="st"> </span>misc)); <span class="kw">length</span>(cor)  <span class="co"># 49 strates où l&#39;engin est &quot;Autres / inconnus&quot;</span></a>
<a class="sourceLine" id="cb11-44" title="44"><span class="co">## [1] 49</span></a>
<a class="sourceLine" id="cb11-45" title="45"><span class="co"># Pour les besoins de la cause, je remplace par NA. get.samples() comprendra que je veux qu&#39;il cherche dans tous les types d&#39;engins</span></a>
<a class="sourceLine" id="cb11-46" title="46">catch_caa<span class="op">$</span>gear[cor] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb11-47" title="47"></a>
<a class="sourceLine" id="cb11-48" title="48"><span class="kw">save</span>(catch_caa, <span class="dt">file =</span>  <span class="kw">paste0</span>(result, <span class="st">&quot;03_catch_caa.Rda&quot;</span>))</a>
<a class="sourceLine" id="cb11-49" title="49"><span class="kw">rm</span>(cor)</a></code></pre></div>
<p>Les données de débarquements sont en kg.</p>
</div>
</div>
<div id="calculs-à-lâge" class="section level1">
<h1><span class="header-section-number">5</span> Calculs à l’âge</h1>
<div id="sélection-des-échantillons" class="section level2">
<h2><span class="header-section-number">5.1</span> Sélection des échantillons</h2>
<p>Je fais le calcul en 2 étapes: - Strates associées aux chaluts à crevettes - Autres strates</p>
<p>La raison est que je ne veux utiliser les données des observateurs à quai / relevé nGSL <strong>QUE</strong> pour ces strates et pas les autres.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Strates avec chalut à crevettes</span></a>
<a class="sourceLine" id="cb12-2" title="2">intrant_catch &lt;-<span class="st"> </span>catch_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gear <span class="op">==</span><span class="st"> &quot;Shrimp trawl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a>
<a class="sourceLine" id="cb12-3" title="3">intrant_lf &lt;-<span class="st"> </span>lf_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gear <span class="op">==</span><span class="st"> &quot;Shrimp trawl&quot;</span>, source <span class="op">==</span><span class="st"> &quot;observateur&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>source) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a>
<a class="sourceLine" id="cb12-4" title="4">intrant_bio &lt;-<span class="st"> </span>bio_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gear <span class="op">==</span><span class="st"> &quot;Shrimp trawl&quot;</span>, source <span class="op">==</span><span class="st"> &quot;nGSL&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>source) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6">caa_all_crev &lt;-<span class="st"> </span><span class="kw">get.samples</span>(<span class="dt">catch =</span> intrant_catch, </a>
<a class="sourceLine" id="cb12-7" title="7">                            <span class="dt">lf =</span> intrant_lf, </a>
<a class="sourceLine" id="cb12-8" title="8">                            <span class="dt">al =</span> intrant_bio, </a>
<a class="sourceLine" id="cb12-9" title="9">                            <span class="dt">min.lf.samples =</span> <span class="dv">2</span>, <span class="co"># min samples for length-frequency</span></a>
<a class="sourceLine" id="cb12-10" title="10">                            <span class="dt">min.al.samples =</span> <span class="dv">1</span>, <span class="co"># min samples for age-length key. Différent ici puisque les âges de nGSL</span></a>
<a class="sourceLine" id="cb12-11" title="11">                            <span class="co"># sont vues comme un seul échantillon...</span></a>
<a class="sourceLine" id="cb12-12" title="12">                            <span class="dt">min.al.fish =</span> <span class="dv">100</span>, <span class="co"># min number of fish required in alk</span></a>
<a class="sourceLine" id="cb12-13" title="13">                            <span class="dt">period.unit =</span> <span class="st">&quot;month&quot;</span>,</a>
<a class="sourceLine" id="cb12-14" title="14">                            <span class="dt">prob.al =</span> <span class="fl">0.95</span>,</a>
<a class="sourceLine" id="cb12-15" title="15">                            <span class="dt">subsample =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="st">                </span>as_tibble</a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb12-18" title="18">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb12-20" title="20">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="st">  </span><span class="er">|=</span><span class="st">                                                                     </span><span class="er">|</span><span class="st">   </span><span class="dv">1</span>%</a>
<a class="sourceLine" id="cb12-22" title="22">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="st">  </span><span class="er">|=</span><span class="st">                                                                     </span><span class="er">|</span><span class="st">   </span><span class="dv">2</span>%</a>
<a class="sourceLine" id="cb12-24" title="24">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="st">  </span><span class="er">|==</span><span class="st">                                                                    </span><span class="er">|</span><span class="st">   </span><span class="dv">3</span>%</a>
<a class="sourceLine" id="cb12-26" title="26">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-27" title="27"><span class="st">  </span><span class="er">|===</span><span class="st">                                                                   </span><span class="er">|</span><span class="st">   </span><span class="dv">4</span>%</a>
<a class="sourceLine" id="cb12-28" title="28">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-29" title="29"><span class="st">  </span><span class="er">|===</span><span class="st">                                                                   </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%</a>
<a class="sourceLine" id="cb12-30" title="30">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-31" title="31"><span class="st">  </span><span class="er">|====</span><span class="st">                                                                  </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb12-32" title="32">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-33" title="33"><span class="st">  </span><span class="er">|=====</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">7</span>%</a>
<a class="sourceLine" id="cb12-34" title="34">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-35" title="35"><span class="st">  </span><span class="er">|======</span><span class="st">                                                                </span><span class="er">|</span><span class="st">   </span><span class="dv">8</span>%</a>
<a class="sourceLine" id="cb12-36" title="36">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-37" title="37"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">   </span><span class="dv">9</span>%</a>
<a class="sourceLine" id="cb12-38" title="38">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-39" title="39"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb12-40" title="40">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-41" title="41"><span class="st">  </span><span class="er">|========</span><span class="st">                                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb12-42" title="42">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-43" title="43"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">12</span>%</a>
<a class="sourceLine" id="cb12-44" title="44">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-45" title="45"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">13</span>%</a>
<a class="sourceLine" id="cb12-46" title="46">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-47" title="47"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb12-48" title="48">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-49" title="49"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">15</span>%</a>
<a class="sourceLine" id="cb12-50" title="50">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-51" title="51"><span class="st">  </span><span class="er">|===========</span><span class="st">                                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%</a>
<a class="sourceLine" id="cb12-52" title="52">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-53" title="53"><span class="st">  </span><span class="er">|============</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">17</span>%</a>
<a class="sourceLine" id="cb12-54" title="54">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-55" title="55"><span class="st">  </span><span class="er">|============</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">18</span>%</a>
<a class="sourceLine" id="cb12-56" title="56">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-57" title="57"><span class="st">  </span><span class="er">|=============</span><span class="st">                                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">19</span>%</a>
<a class="sourceLine" id="cb12-58" title="58">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-59" title="59"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb12-60" title="60">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-61" title="61"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%</a>
<a class="sourceLine" id="cb12-62" title="62">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-63" title="63"><span class="st">  </span><span class="er">|===============</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%</a>
<a class="sourceLine" id="cb12-64" title="64">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-65" title="65"><span class="st">  </span><span class="er">|================</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">22</span>%</a>
<a class="sourceLine" id="cb12-66" title="66">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-67" title="67"><span class="st">  </span><span class="er">|================</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">23</span>%</a>
<a class="sourceLine" id="cb12-68" title="68">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-69" title="69"><span class="st">  </span><span class="er">|=================</span><span class="st">                                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">24</span>%</a>
<a class="sourceLine" id="cb12-70" title="70">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-71" title="71"><span class="st">  </span><span class="er">|==================</span><span class="st">                                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">25</span>%</a>
<a class="sourceLine" id="cb12-72" title="72">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-73" title="73"><span class="st">  </span><span class="er">|==================</span><span class="st">                                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb12-74" title="74">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-75" title="75"><span class="st">  </span><span class="er">|===================</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">27</span>%</a>
<a class="sourceLine" id="cb12-76" title="76">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-77" title="77"><span class="st">  </span><span class="er">|====================</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">28</span>%</a>
<a class="sourceLine" id="cb12-78" title="78">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-79" title="79"><span class="st">  </span><span class="er">|====================</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb12-80" title="80">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-81" title="81"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb12-82" title="82">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-83" title="83"><span class="st">  </span><span class="er">|======================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">31</span>%</a>
<a class="sourceLine" id="cb12-84" title="84">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-85" title="85"><span class="st">  </span><span class="er">|======================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb12-86" title="86">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-87" title="87"><span class="st">  </span><span class="er">|=======================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">33</span>%</a>
<a class="sourceLine" id="cb12-88" title="88">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-89" title="89"><span class="st">  </span><span class="er">|========================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">34</span>%</a>
<a class="sourceLine" id="cb12-90" title="90">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-91" title="91"><span class="st">  </span><span class="er">|========================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">35</span>%</a>
<a class="sourceLine" id="cb12-92" title="92">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-93" title="93"><span class="st">  </span><span class="er">|=========================</span><span class="st">                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">36</span>%</a>
<a class="sourceLine" id="cb12-94" title="94">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-95" title="95"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">36</span>%</a>
<a class="sourceLine" id="cb12-96" title="96">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-97" title="97"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%</a>
<a class="sourceLine" id="cb12-98" title="98">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-99" title="99"><span class="st">  </span><span class="er">|===========================</span><span class="st">                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">38</span>%</a>
<a class="sourceLine" id="cb12-100" title="100">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-101" title="101"><span class="st">  </span><span class="er">|===========================</span><span class="st">                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">39</span>%</a>
<a class="sourceLine" id="cb12-102" title="102">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-103" title="103"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb12-104" title="104">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-105" title="105"><span class="st">  </span><span class="er">|=============================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">41</span>%</a>
<a class="sourceLine" id="cb12-106" title="106">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-107" title="107"><span class="st">  </span><span class="er">|=============================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%</a>
<a class="sourceLine" id="cb12-108" title="108">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-109" title="109"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb12-110" title="110">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-111" title="111"><span class="st">  </span><span class="er">|===============================</span><span class="st">                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%</a>
<a class="sourceLine" id="cb12-112" title="112">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-113" title="113"><span class="st">  </span><span class="er">|===============================</span><span class="st">                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">45</span>%</a>
<a class="sourceLine" id="cb12-114" title="114">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-115" title="115"><span class="st">  </span><span class="er">|================================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%</a>
<a class="sourceLine" id="cb12-116" title="116">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-117" title="117"><span class="st">  </span><span class="er">|=================================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">47</span>%</a>
<a class="sourceLine" id="cb12-118" title="118">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-119" title="119"><span class="st">  </span><span class="er">|=================================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">48</span>%</a>
<a class="sourceLine" id="cb12-120" title="120">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-121" title="121"><span class="st">  </span><span class="er">|==================================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">49</span>%</a>
<a class="sourceLine" id="cb12-122" title="122">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-123" title="123"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb12-124" title="124">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-125" title="125"><span class="st">  </span><span class="er">|====================================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">51</span>%</a>
<a class="sourceLine" id="cb12-126" title="126">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-127" title="127"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">52</span>%</a>
<a class="sourceLine" id="cb12-128" title="128">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-129" title="129"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">53</span>%</a>
<a class="sourceLine" id="cb12-130" title="130">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-131" title="131"><span class="st">  </span><span class="er">|======================================</span><span class="st">                                </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%</a>
<a class="sourceLine" id="cb12-132" title="132">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-133" title="133"><span class="st">  </span><span class="er">|=======================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">55</span>%</a>
<a class="sourceLine" id="cb12-134" title="134">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-135" title="135"><span class="st">  </span><span class="er">|=======================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%</a>
<a class="sourceLine" id="cb12-136" title="136">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-137" title="137"><span class="st">  </span><span class="er">|========================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb12-138" title="138">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-139" title="139"><span class="st">  </span><span class="er">|=========================================</span><span class="st">                             </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%</a>
<a class="sourceLine" id="cb12-140" title="140">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-141" title="141"><span class="st">  </span><span class="er">|=========================================</span><span class="st">                             </span><span class="er">|</span><span class="st">  </span><span class="dv">59</span>%</a>
<a class="sourceLine" id="cb12-142" title="142">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-143" title="143"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb12-144" title="144">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-145" title="145"><span class="st">  </span><span class="er">|===========================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">61</span>%</a>
<a class="sourceLine" id="cb12-146" title="146">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-147" title="147"><span class="st">  </span><span class="er">|===========================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">62</span>%</a>
<a class="sourceLine" id="cb12-148" title="148">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-149" title="149"><span class="st">  </span><span class="er">|============================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%</a>
<a class="sourceLine" id="cb12-150" title="150">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-151" title="151"><span class="st">  </span><span class="er">|============================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">64</span>%</a>
<a class="sourceLine" id="cb12-152" title="152">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-153" title="153"><span class="st">  </span><span class="er">|=============================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">64</span>%</a>
<a class="sourceLine" id="cb12-154" title="154">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-155" title="155"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">65</span>%</a>
<a class="sourceLine" id="cb12-156" title="156">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-157" title="157"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">66</span>%</a>
<a class="sourceLine" id="cb12-158" title="158">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-159" title="159"><span class="st">  </span><span class="er">|===============================================</span><span class="st">                       </span><span class="er">|</span><span class="st">  </span><span class="dv">67</span>%</a>
<a class="sourceLine" id="cb12-160" title="160">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-161" title="161"><span class="st">  </span><span class="er">|================================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%</a>
<a class="sourceLine" id="cb12-162" title="162">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-163" title="163"><span class="st">  </span><span class="er">|================================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%</a>
<a class="sourceLine" id="cb12-164" title="164">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-165" title="165"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb12-166" title="166">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-167" title="167"><span class="st">  </span><span class="er">|==================================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%</a>
<a class="sourceLine" id="cb12-168" title="168">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-169" title="169"><span class="st">  </span><span class="er">|==================================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%</a>
<a class="sourceLine" id="cb12-170" title="170">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-171" title="171"><span class="st">  </span><span class="er">|===================================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">73</span>%</a>
<a class="sourceLine" id="cb12-172" title="172">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-173" title="173"><span class="st">  </span><span class="er">|====================================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb12-174" title="174">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-175" title="175"><span class="st">  </span><span class="er">|====================================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">75</span>%</a>
<a class="sourceLine" id="cb12-176" title="176">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-177" title="177"><span class="st">  </span><span class="er">|=====================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">76</span>%</a>
<a class="sourceLine" id="cb12-178" title="178">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-179" title="179"><span class="st">  </span><span class="er">|======================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">77</span>%</a>
<a class="sourceLine" id="cb12-180" title="180">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-181" title="181"><span class="st">  </span><span class="er">|======================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">78</span>%</a>
<a class="sourceLine" id="cb12-182" title="182">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-183" title="183"><span class="st">  </span><span class="er">|=======================================================</span><span class="st">               </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%</a>
<a class="sourceLine" id="cb12-184" title="184">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-185" title="185"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%</a>
<a class="sourceLine" id="cb12-186" title="186">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-187" title="187"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb12-188" title="188">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-189" title="189"><span class="st">  </span><span class="er">|=========================================================</span><span class="st">             </span><span class="er">|</span><span class="st">  </span><span class="dv">81</span>%</a>
<a class="sourceLine" id="cb12-190" title="190">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-191" title="191"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">82</span>%</a>
<a class="sourceLine" id="cb12-192" title="192">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-193" title="193"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">83</span>%</a>
<a class="sourceLine" id="cb12-194" title="194">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-195" title="195"><span class="st">  </span><span class="er">|===========================================================</span><span class="st">           </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%</a>
<a class="sourceLine" id="cb12-196" title="196">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-197" title="197"><span class="st">  </span><span class="er">|============================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">85</span>%</a>
<a class="sourceLine" id="cb12-198" title="198">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-199" title="199"><span class="st">  </span><span class="er">|============================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb12-200" title="200">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-201" title="201"><span class="st">  </span><span class="er">|=============================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">87</span>%</a>
<a class="sourceLine" id="cb12-202" title="202">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-203" title="203"><span class="st">  </span><span class="er">|=============================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">88</span>%</a>
<a class="sourceLine" id="cb12-204" title="204">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-205" title="205"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb12-206" title="206">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-207" title="207"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb12-208" title="208">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-209" title="209"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">91</span>%</a>
<a class="sourceLine" id="cb12-210" title="210">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-211" title="211"><span class="st">  </span><span class="er">|================================================================</span><span class="st">      </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%</a>
<a class="sourceLine" id="cb12-212" title="212">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-213" title="213"><span class="st">  </span><span class="er">|=================================================================</span><span class="st">     </span><span class="er">|</span><span class="st">  </span><span class="dv">93</span>%</a>
<a class="sourceLine" id="cb12-214" title="214">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-215" title="215"><span class="st">  </span><span class="er">|==================================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%</a>
<a class="sourceLine" id="cb12-216" title="216">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-217" title="217"><span class="st">  </span><span class="er">|===================================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb12-218" title="218">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-219" title="219"><span class="st">  </span><span class="er">|===================================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">96</span>%</a>
<a class="sourceLine" id="cb12-220" title="220">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-221" title="221"><span class="st">  </span><span class="er">|====================================================================</span><span class="st">  </span><span class="er">|</span><span class="st">  </span><span class="dv">97</span>%</a>
<a class="sourceLine" id="cb12-222" title="222">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-223" title="223"><span class="st">  </span><span class="er">|=====================================================================</span><span class="st"> </span><span class="er">|</span><span class="st">  </span><span class="dv">98</span>%</a>
<a class="sourceLine" id="cb12-224" title="224">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-225" title="225"><span class="st">  </span><span class="er">|=====================================================================</span><span class="st"> </span><span class="er">|</span><span class="st">  </span><span class="dv">99</span>%</a>
<a class="sourceLine" id="cb12-226" title="226">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-227" title="227"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb12-228" title="228"><span class="kw">dim</span>(caa_all_crev) <span class="co"># 3575 obs et 36 var</span></a>
<a class="sourceLine" id="cb12-229" title="229"><span class="co">## [1] 3575   36</span></a>
<a class="sourceLine" id="cb12-230" title="230"><span class="kw">table</span>(caa_all_crev<span class="op">$</span>option.lengthfreq, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># ok</span></a>
<a class="sourceLine" id="cb12-231" title="231"><span class="co">## </span></a>
<a class="sourceLine" id="cb12-232" title="232"><span class="co">##    1    2    3    4    5    7    8   11 &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb12-233" title="233"><span class="co">##  680  343  369  239 1852   10   46   36    0</span></a>
<a class="sourceLine" id="cb12-234" title="234"><span class="kw">table</span>(caa_all_crev<span class="op">$</span>option.agelength, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># toujours 9, 10 ou 11</span></a>
<a class="sourceLine" id="cb12-235" title="235"><span class="co">## </span></a>
<a class="sourceLine" id="cb12-236" title="236"><span class="co">##    9   10   11 &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb12-237" title="237"><span class="co">##  436  586 2553    0</span></a>
<a class="sourceLine" id="cb12-238" title="238"></a>
<a class="sourceLine" id="cb12-239" title="239"><span class="co"># Autres strates</span></a>
<a class="sourceLine" id="cb12-240" title="240">cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">with</span>(catch_caa, gear <span class="op">==</span><span class="st"> &quot;Shrimp trawl&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gear))); <span class="kw">length</span>(cor) <span class="co"># 4484</span></a>
<a class="sourceLine" id="cb12-241" title="241"><span class="co">## [1] 4484</span></a>
<a class="sourceLine" id="cb12-242" title="242">intrant_catch &lt;-<span class="st"> </span>catch_caa[cor, ] <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a>
<a class="sourceLine" id="cb12-243" title="243">intrant_lf &lt;-<span class="st"> </span>lf_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(source <span class="op">!=</span><span class="st"> &quot;observateur&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>source) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a>
<a class="sourceLine" id="cb12-244" title="244">intrant_bio &lt;-<span class="st"> </span>bio_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(source <span class="op">!=</span><span class="st"> &quot;nGSL&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>source) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a>
<a class="sourceLine" id="cb12-245" title="245"></a>
<a class="sourceLine" id="cb12-246" title="246">caa_all_aut &lt;-<span class="st"> </span><span class="kw">get.samples</span>(<span class="dt">catch =</span> intrant_catch, </a>
<a class="sourceLine" id="cb12-247" title="247">                            <span class="dt">lf =</span> intrant_lf, </a>
<a class="sourceLine" id="cb12-248" title="248">                            <span class="dt">al =</span> intrant_bio, </a>
<a class="sourceLine" id="cb12-249" title="249">                            <span class="dt">min.lf.samples =</span> <span class="dv">2</span>, <span class="co"># min samples for length-frequency</span></a>
<a class="sourceLine" id="cb12-250" title="250">                            <span class="dt">min.al.samples =</span> <span class="dv">2</span>, <span class="co"># min samples for age-length key</span></a>
<a class="sourceLine" id="cb12-251" title="251">                            <span class="dt">min.al.fish =</span> <span class="dv">100</span>, <span class="co"># min number of fish required in alk</span></a>
<a class="sourceLine" id="cb12-252" title="252">                            <span class="dt">period.unit =</span> <span class="st">&quot;month&quot;</span>,</a>
<a class="sourceLine" id="cb12-253" title="253">                            <span class="dt">prob.al =</span> <span class="fl">0.95</span>,</a>
<a class="sourceLine" id="cb12-254" title="254">                            <span class="dt">subsample =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-255" title="255"><span class="st">                </span>as_tibble</a>
<a class="sourceLine" id="cb12-256" title="256"><span class="co">## </span></a>
<a class="sourceLine" id="cb12-257" title="257">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-258" title="258"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb12-259" title="259">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-260" title="260"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">1</span>%</a>
<a class="sourceLine" id="cb12-261" title="261">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-262" title="262"><span class="st">  </span><span class="er">|=</span><span class="st">                                                                     </span><span class="er">|</span><span class="st">   </span><span class="dv">1</span>%</a>
<a class="sourceLine" id="cb12-263" title="263">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-264" title="264"><span class="st">  </span><span class="er">|=</span><span class="st">                                                                     </span><span class="er">|</span><span class="st">   </span><span class="dv">2</span>%</a>
<a class="sourceLine" id="cb12-265" title="265">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-266" title="266"><span class="st">  </span><span class="er">|==</span><span class="st">                                                                    </span><span class="er">|</span><span class="st">   </span><span class="dv">2</span>%</a>
<a class="sourceLine" id="cb12-267" title="267">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-268" title="268"><span class="st">  </span><span class="er">|==</span><span class="st">                                                                    </span><span class="er">|</span><span class="st">   </span><span class="dv">3</span>%</a>
<a class="sourceLine" id="cb12-269" title="269">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-270" title="270"><span class="st">  </span><span class="er">|==</span><span class="st">                                                                    </span><span class="er">|</span><span class="st">   </span><span class="dv">4</span>%</a>
<a class="sourceLine" id="cb12-271" title="271">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-272" title="272"><span class="st">  </span><span class="er">|===</span><span class="st">                                                                   </span><span class="er">|</span><span class="st">   </span><span class="dv">4</span>%</a>
<a class="sourceLine" id="cb12-273" title="273">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-274" title="274"><span class="st">  </span><span class="er">|===</span><span class="st">                                                                   </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%</a>
<a class="sourceLine" id="cb12-275" title="275">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-276" title="276"><span class="st">  </span><span class="er">|====</span><span class="st">                                                                  </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%</a>
<a class="sourceLine" id="cb12-277" title="277">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-278" title="278"><span class="st">  </span><span class="er">|====</span><span class="st">                                                                  </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb12-279" title="279">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-280" title="280"><span class="st">  </span><span class="er">|=====</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb12-281" title="281">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-282" title="282"><span class="st">  </span><span class="er">|=====</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">7</span>%</a>
<a class="sourceLine" id="cb12-283" title="283">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-284" title="284"><span class="st">  </span><span class="er">|=====</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">8</span>%</a>
<a class="sourceLine" id="cb12-285" title="285">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-286" title="286"><span class="st">  </span><span class="er">|======</span><span class="st">                                                                </span><span class="er">|</span><span class="st">   </span><span class="dv">8</span>%</a>
<a class="sourceLine" id="cb12-287" title="287">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-288" title="288"><span class="st">  </span><span class="er">|======</span><span class="st">                                                                </span><span class="er">|</span><span class="st">   </span><span class="dv">9</span>%</a>
<a class="sourceLine" id="cb12-289" title="289">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-290" title="290"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">   </span><span class="dv">9</span>%</a>
<a class="sourceLine" id="cb12-291" title="291">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-292" title="292"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb12-293" title="293">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-294" title="294"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb12-295" title="295">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-296" title="296"><span class="st">  </span><span class="er">|========</span><span class="st">                                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb12-297" title="297">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-298" title="298"><span class="st">  </span><span class="er">|========</span><span class="st">                                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">12</span>%</a>
<a class="sourceLine" id="cb12-299" title="299">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-300" title="300"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">12</span>%</a>
<a class="sourceLine" id="cb12-301" title="301">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-302" title="302"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">13</span>%</a>
<a class="sourceLine" id="cb12-303" title="303">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-304" title="304"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb12-305" title="305">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-306" title="306"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb12-307" title="307">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-308" title="308"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">15</span>%</a>
<a class="sourceLine" id="cb12-309" title="309">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-310" title="310"><span class="st">  </span><span class="er">|===========</span><span class="st">                                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">15</span>%</a>
<a class="sourceLine" id="cb12-311" title="311">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-312" title="312"><span class="st">  </span><span class="er">|===========</span><span class="st">                                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%</a>
<a class="sourceLine" id="cb12-313" title="313">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-314" title="314"><span class="st">  </span><span class="er">|============</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%</a>
<a class="sourceLine" id="cb12-315" title="315">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-316" title="316"><span class="st">  </span><span class="er">|============</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">17</span>%</a>
<a class="sourceLine" id="cb12-317" title="317">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-318" title="318"><span class="st">  </span><span class="er">|============</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">18</span>%</a>
<a class="sourceLine" id="cb12-319" title="319">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-320" title="320"><span class="st">  </span><span class="er">|=============</span><span class="st">                                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">18</span>%</a>
<a class="sourceLine" id="cb12-321" title="321">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-322" title="322"><span class="st">  </span><span class="er">|=============</span><span class="st">                                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">19</span>%</a>
<a class="sourceLine" id="cb12-323" title="323">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-324" title="324"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">19</span>%</a>
<a class="sourceLine" id="cb12-325" title="325">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-326" title="326"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb12-327" title="327">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-328" title="328"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%</a>
<a class="sourceLine" id="cb12-329" title="329">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-330" title="330"><span class="st">  </span><span class="er">|===============</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%</a>
<a class="sourceLine" id="cb12-331" title="331">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-332" title="332"><span class="st">  </span><span class="er">|===============</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">22</span>%</a>
<a class="sourceLine" id="cb12-333" title="333">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-334" title="334"><span class="st">  </span><span class="er">|================</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">22</span>%</a>
<a class="sourceLine" id="cb12-335" title="335">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-336" title="336"><span class="st">  </span><span class="er">|================</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">23</span>%</a>
<a class="sourceLine" id="cb12-337" title="337">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-338" title="338"><span class="st">  </span><span class="er">|================</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">24</span>%</a>
<a class="sourceLine" id="cb12-339" title="339">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-340" title="340"><span class="st">  </span><span class="er">|=================</span><span class="st">                                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">24</span>%</a>
<a class="sourceLine" id="cb12-341" title="341">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-342" title="342"><span class="st">  </span><span class="er">|=================</span><span class="st">                                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">25</span>%</a>
<a class="sourceLine" id="cb12-343" title="343">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-344" title="344"><span class="st">  </span><span class="er">|==================</span><span class="st">                                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">25</span>%</a>
<a class="sourceLine" id="cb12-345" title="345">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-346" title="346"><span class="st">  </span><span class="er">|==================</span><span class="st">                                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb12-347" title="347">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-348" title="348"><span class="st">  </span><span class="er">|===================</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb12-349" title="349">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-350" title="350"><span class="st">  </span><span class="er">|===================</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">27</span>%</a>
<a class="sourceLine" id="cb12-351" title="351">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-352" title="352"><span class="st">  </span><span class="er">|===================</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">28</span>%</a>
<a class="sourceLine" id="cb12-353" title="353">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-354" title="354"><span class="st">  </span><span class="er">|====================</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">28</span>%</a>
<a class="sourceLine" id="cb12-355" title="355">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-356" title="356"><span class="st">  </span><span class="er">|====================</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb12-357" title="357">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-358" title="358"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb12-359" title="359">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-360" title="360"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb12-361" title="361">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-362" title="362"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">31</span>%</a>
<a class="sourceLine" id="cb12-363" title="363">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-364" title="364"><span class="st">  </span><span class="er">|======================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">31</span>%</a>
<a class="sourceLine" id="cb12-365" title="365">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-366" title="366"><span class="st">  </span><span class="er">|======================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb12-367" title="367">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-368" title="368"><span class="st">  </span><span class="er">|=======================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb12-369" title="369">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-370" title="370"><span class="st">  </span><span class="er">|=======================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">33</span>%</a>
<a class="sourceLine" id="cb12-371" title="371">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-372" title="372"><span class="st">  </span><span class="er">|=======================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">34</span>%</a>
<a class="sourceLine" id="cb12-373" title="373">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-374" title="374"><span class="st">  </span><span class="er">|========================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">34</span>%</a>
<a class="sourceLine" id="cb12-375" title="375">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-376" title="376"><span class="st">  </span><span class="er">|========================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">35</span>%</a>
<a class="sourceLine" id="cb12-377" title="377">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-378" title="378"><span class="st">  </span><span class="er">|=========================</span><span class="st">                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">35</span>%</a>
<a class="sourceLine" id="cb12-379" title="379">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-380" title="380"><span class="st">  </span><span class="er">|=========================</span><span class="st">                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">36</span>%</a>
<a class="sourceLine" id="cb12-381" title="381">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-382" title="382"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">36</span>%</a>
<a class="sourceLine" id="cb12-383" title="383">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-384" title="384"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%</a>
<a class="sourceLine" id="cb12-385" title="385">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-386" title="386"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">38</span>%</a>
<a class="sourceLine" id="cb12-387" title="387">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-388" title="388"><span class="st">  </span><span class="er">|===========================</span><span class="st">                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">38</span>%</a>
<a class="sourceLine" id="cb12-389" title="389">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-390" title="390"><span class="st">  </span><span class="er">|===========================</span><span class="st">                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">39</span>%</a>
<a class="sourceLine" id="cb12-391" title="391">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-392" title="392"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">39</span>%</a>
<a class="sourceLine" id="cb12-393" title="393">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-394" title="394"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb12-395" title="395">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-396" title="396"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">41</span>%</a>
<a class="sourceLine" id="cb12-397" title="397">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-398" title="398"><span class="st">  </span><span class="er">|=============================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">41</span>%</a>
<a class="sourceLine" id="cb12-399" title="399">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-400" title="400"><span class="st">  </span><span class="er">|=============================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%</a>
<a class="sourceLine" id="cb12-401" title="401">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-402" title="402"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%</a>
<a class="sourceLine" id="cb12-403" title="403">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-404" title="404"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb12-405" title="405">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-406" title="406"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%</a>
<a class="sourceLine" id="cb12-407" title="407">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-408" title="408"><span class="st">  </span><span class="er">|===============================</span><span class="st">                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%</a>
<a class="sourceLine" id="cb12-409" title="409">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-410" title="410"><span class="st">  </span><span class="er">|===============================</span><span class="st">                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">45</span>%</a>
<a class="sourceLine" id="cb12-411" title="411">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-412" title="412"><span class="st">  </span><span class="er">|================================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">45</span>%</a>
<a class="sourceLine" id="cb12-413" title="413">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-414" title="414"><span class="st">  </span><span class="er">|================================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%</a>
<a class="sourceLine" id="cb12-415" title="415">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-416" title="416"><span class="st">  </span><span class="er">|=================================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%</a>
<a class="sourceLine" id="cb12-417" title="417">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-418" title="418"><span class="st">  </span><span class="er">|=================================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">47</span>%</a>
<a class="sourceLine" id="cb12-419" title="419">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-420" title="420"><span class="st">  </span><span class="er">|=================================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">48</span>%</a>
<a class="sourceLine" id="cb12-421" title="421">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-422" title="422"><span class="st">  </span><span class="er">|==================================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">48</span>%</a>
<a class="sourceLine" id="cb12-423" title="423">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-424" title="424"><span class="st">  </span><span class="er">|==================================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">49</span>%</a>
<a class="sourceLine" id="cb12-425" title="425">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-426" title="426"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">49</span>%</a>
<a class="sourceLine" id="cb12-427" title="427">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-428" title="428"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb12-429" title="429">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-430" title="430"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">51</span>%</a>
<a class="sourceLine" id="cb12-431" title="431">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-432" title="432"><span class="st">  </span><span class="er">|====================================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">51</span>%</a>
<a class="sourceLine" id="cb12-433" title="433">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-434" title="434"><span class="st">  </span><span class="er">|====================================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">52</span>%</a>
<a class="sourceLine" id="cb12-435" title="435">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-436" title="436"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">52</span>%</a>
<a class="sourceLine" id="cb12-437" title="437">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-438" title="438"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">53</span>%</a>
<a class="sourceLine" id="cb12-439" title="439">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-440" title="440"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%</a>
<a class="sourceLine" id="cb12-441" title="441">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-442" title="442"><span class="st">  </span><span class="er">|======================================</span><span class="st">                                </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%</a>
<a class="sourceLine" id="cb12-443" title="443">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-444" title="444"><span class="st">  </span><span class="er">|======================================</span><span class="st">                                </span><span class="er">|</span><span class="st">  </span><span class="dv">55</span>%</a>
<a class="sourceLine" id="cb12-445" title="445">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-446" title="446"><span class="st">  </span><span class="er">|=======================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">55</span>%</a>
<a class="sourceLine" id="cb12-447" title="447">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-448" title="448"><span class="st">  </span><span class="er">|=======================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%</a>
<a class="sourceLine" id="cb12-449" title="449">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-450" title="450"><span class="st">  </span><span class="er">|========================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%</a>
<a class="sourceLine" id="cb12-451" title="451">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-452" title="452"><span class="st">  </span><span class="er">|========================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb12-453" title="453">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-454" title="454"><span class="st">  </span><span class="er">|========================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%</a>
<a class="sourceLine" id="cb12-455" title="455">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-456" title="456"><span class="st">  </span><span class="er">|=========================================</span><span class="st">                             </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%</a>
<a class="sourceLine" id="cb12-457" title="457">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-458" title="458"><span class="st">  </span><span class="er">|=========================================</span><span class="st">                             </span><span class="er">|</span><span class="st">  </span><span class="dv">59</span>%</a>
<a class="sourceLine" id="cb12-459" title="459">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-460" title="460"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">59</span>%</a>
<a class="sourceLine" id="cb12-461" title="461">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-462" title="462"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb12-463" title="463">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-464" title="464"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">61</span>%</a>
<a class="sourceLine" id="cb12-465" title="465">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-466" title="466"><span class="st">  </span><span class="er">|===========================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">61</span>%</a>
<a class="sourceLine" id="cb12-467" title="467">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-468" title="468"><span class="st">  </span><span class="er">|===========================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">62</span>%</a>
<a class="sourceLine" id="cb12-469" title="469">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-470" title="470"><span class="st">  </span><span class="er">|============================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">62</span>%</a>
<a class="sourceLine" id="cb12-471" title="471">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-472" title="472"><span class="st">  </span><span class="er">|============================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%</a>
<a class="sourceLine" id="cb12-473" title="473">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-474" title="474"><span class="st">  </span><span class="er">|============================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">64</span>%</a>
<a class="sourceLine" id="cb12-475" title="475">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-476" title="476"><span class="st">  </span><span class="er">|=============================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">64</span>%</a>
<a class="sourceLine" id="cb12-477" title="477">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-478" title="478"><span class="st">  </span><span class="er">|=============================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">65</span>%</a>
<a class="sourceLine" id="cb12-479" title="479">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-480" title="480"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">65</span>%</a>
<a class="sourceLine" id="cb12-481" title="481">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-482" title="482"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">66</span>%</a>
<a class="sourceLine" id="cb12-483" title="483">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-484" title="484"><span class="st">  </span><span class="er">|===============================================</span><span class="st">                       </span><span class="er">|</span><span class="st">  </span><span class="dv">66</span>%</a>
<a class="sourceLine" id="cb12-485" title="485">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-486" title="486"><span class="st">  </span><span class="er">|===============================================</span><span class="st">                       </span><span class="er">|</span><span class="st">  </span><span class="dv">67</span>%</a>
<a class="sourceLine" id="cb12-487" title="487">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-488" title="488"><span class="st">  </span><span class="er">|===============================================</span><span class="st">                       </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%</a>
<a class="sourceLine" id="cb12-489" title="489">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-490" title="490"><span class="st">  </span><span class="er">|================================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%</a>
<a class="sourceLine" id="cb12-491" title="491">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-492" title="492"><span class="st">  </span><span class="er">|================================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%</a>
<a class="sourceLine" id="cb12-493" title="493">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-494" title="494"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%</a>
<a class="sourceLine" id="cb12-495" title="495">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-496" title="496"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb12-497" title="497">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-498" title="498"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%</a>
<a class="sourceLine" id="cb12-499" title="499">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-500" title="500"><span class="st">  </span><span class="er">|==================================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%</a>
<a class="sourceLine" id="cb12-501" title="501">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-502" title="502"><span class="st">  </span><span class="er">|==================================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%</a>
<a class="sourceLine" id="cb12-503" title="503">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-504" title="504"><span class="st">  </span><span class="er">|===================================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%</a>
<a class="sourceLine" id="cb12-505" title="505">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-506" title="506"><span class="st">  </span><span class="er">|===================================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">73</span>%</a>
<a class="sourceLine" id="cb12-507" title="507">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-508" title="508"><span class="st">  </span><span class="er">|===================================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb12-509" title="509">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-510" title="510"><span class="st">  </span><span class="er">|====================================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb12-511" title="511">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-512" title="512"><span class="st">  </span><span class="er">|====================================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">75</span>%</a>
<a class="sourceLine" id="cb12-513" title="513">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-514" title="514"><span class="st">  </span><span class="er">|=====================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">75</span>%</a>
<a class="sourceLine" id="cb12-515" title="515">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-516" title="516"><span class="st">  </span><span class="er">|=====================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">76</span>%</a>
<a class="sourceLine" id="cb12-517" title="517">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-518" title="518"><span class="st">  </span><span class="er">|======================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">76</span>%</a>
<a class="sourceLine" id="cb12-519" title="519">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-520" title="520"><span class="st">  </span><span class="er">|======================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">77</span>%</a>
<a class="sourceLine" id="cb12-521" title="521">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-522" title="522"><span class="st">  </span><span class="er">|======================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">78</span>%</a>
<a class="sourceLine" id="cb12-523" title="523">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-524" title="524"><span class="st">  </span><span class="er">|=======================================================</span><span class="st">               </span><span class="er">|</span><span class="st">  </span><span class="dv">78</span>%</a>
<a class="sourceLine" id="cb12-525" title="525">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-526" title="526"><span class="st">  </span><span class="er">|=======================================================</span><span class="st">               </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%</a>
<a class="sourceLine" id="cb12-527" title="527">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-528" title="528"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%</a>
<a class="sourceLine" id="cb12-529" title="529">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-530" title="530"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb12-531" title="531">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-532" title="532"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">81</span>%</a>
<a class="sourceLine" id="cb12-533" title="533">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-534" title="534"><span class="st">  </span><span class="er">|=========================================================</span><span class="st">             </span><span class="er">|</span><span class="st">  </span><span class="dv">81</span>%</a>
<a class="sourceLine" id="cb12-535" title="535">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-536" title="536"><span class="st">  </span><span class="er">|=========================================================</span><span class="st">             </span><span class="er">|</span><span class="st">  </span><span class="dv">82</span>%</a>
<a class="sourceLine" id="cb12-537" title="537">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-538" title="538"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">82</span>%</a>
<a class="sourceLine" id="cb12-539" title="539">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-540" title="540"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">83</span>%</a>
<a class="sourceLine" id="cb12-541" title="541">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-542" title="542"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%</a>
<a class="sourceLine" id="cb12-543" title="543">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-544" title="544"><span class="st">  </span><span class="er">|===========================================================</span><span class="st">           </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%</a>
<a class="sourceLine" id="cb12-545" title="545">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-546" title="546"><span class="st">  </span><span class="er">|===========================================================</span><span class="st">           </span><span class="er">|</span><span class="st">  </span><span class="dv">85</span>%</a>
<a class="sourceLine" id="cb12-547" title="547">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-548" title="548"><span class="st">  </span><span class="er">|============================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">85</span>%</a>
<a class="sourceLine" id="cb12-549" title="549">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-550" title="550"><span class="st">  </span><span class="er">|============================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb12-551" title="551">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-552" title="552"><span class="st">  </span><span class="er">|=============================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb12-553" title="553">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-554" title="554"><span class="st">  </span><span class="er">|=============================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">87</span>%</a>
<a class="sourceLine" id="cb12-555" title="555">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-556" title="556"><span class="st">  </span><span class="er">|=============================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">88</span>%</a>
<a class="sourceLine" id="cb12-557" title="557">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-558" title="558"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">88</span>%</a>
<a class="sourceLine" id="cb12-559" title="559">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-560" title="560"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb12-561" title="561">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-562" title="562"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb12-563" title="563">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-564" title="564"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb12-565" title="565">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-566" title="566"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">91</span>%</a>
<a class="sourceLine" id="cb12-567" title="567">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-568" title="568"><span class="st">  </span><span class="er">|================================================================</span><span class="st">      </span><span class="er">|</span><span class="st">  </span><span class="dv">91</span>%</a>
<a class="sourceLine" id="cb12-569" title="569">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-570" title="570"><span class="st">  </span><span class="er">|================================================================</span><span class="st">      </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%</a>
<a class="sourceLine" id="cb12-571" title="571">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-572" title="572"><span class="st">  </span><span class="er">|=================================================================</span><span class="st">     </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%</a>
<a class="sourceLine" id="cb12-573" title="573">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-574" title="574"><span class="st">  </span><span class="er">|=================================================================</span><span class="st">     </span><span class="er">|</span><span class="st">  </span><span class="dv">93</span>%</a>
<a class="sourceLine" id="cb12-575" title="575">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-576" title="576"><span class="st">  </span><span class="er">|=================================================================</span><span class="st">     </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%</a>
<a class="sourceLine" id="cb12-577" title="577">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-578" title="578"><span class="st">  </span><span class="er">|==================================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%</a>
<a class="sourceLine" id="cb12-579" title="579">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-580" title="580"><span class="st">  </span><span class="er">|==================================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb12-581" title="581">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-582" title="582"><span class="st">  </span><span class="er">|===================================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb12-583" title="583">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-584" title="584"><span class="st">  </span><span class="er">|===================================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">96</span>%</a>
<a class="sourceLine" id="cb12-585" title="585">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-586" title="586"><span class="st">  </span><span class="er">|====================================================================</span><span class="st">  </span><span class="er">|</span><span class="st">  </span><span class="dv">96</span>%</a>
<a class="sourceLine" id="cb12-587" title="587">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-588" title="588"><span class="st">  </span><span class="er">|====================================================================</span><span class="st">  </span><span class="er">|</span><span class="st">  </span><span class="dv">97</span>%</a>
<a class="sourceLine" id="cb12-589" title="589">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-590" title="590"><span class="st">  </span><span class="er">|====================================================================</span><span class="st">  </span><span class="er">|</span><span class="st">  </span><span class="dv">98</span>%</a>
<a class="sourceLine" id="cb12-591" title="591">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-592" title="592"><span class="st">  </span><span class="er">|=====================================================================</span><span class="st"> </span><span class="er">|</span><span class="st">  </span><span class="dv">98</span>%</a>
<a class="sourceLine" id="cb12-593" title="593">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-594" title="594"><span class="st">  </span><span class="er">|=====================================================================</span><span class="st"> </span><span class="er">|</span><span class="st">  </span><span class="dv">99</span>%</a>
<a class="sourceLine" id="cb12-595" title="595">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-596" title="596"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st">  </span><span class="dv">99</span>%</a>
<a class="sourceLine" id="cb12-597" title="597">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb12-598" title="598"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb12-599" title="599"></a>
<a class="sourceLine" id="cb12-600" title="600"><span class="kw">dim</span>(caa_all_aut) <span class="co"># 226241 obs et 36 var</span></a>
<a class="sourceLine" id="cb12-601" title="601"><span class="co">## [1] 226241     36</span></a>
<a class="sourceLine" id="cb12-602" title="602"><span class="kw">table</span>(caa_all_aut<span class="op">$</span>option.lengthfreq, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># ok</span></a>
<a class="sourceLine" id="cb12-603" title="603"><span class="co">## </span></a>
<a class="sourceLine" id="cb12-604" title="604"><span class="co">##     1     2     3     4     5     6  &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb12-605" title="605"><span class="co">## 11173 13499 56540 40520 39714 64795     0</span></a>
<a class="sourceLine" id="cb12-606" title="606"><span class="kw">table</span>(caa_all_aut<span class="op">$</span>option.agelength, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># ok</span></a>
<a class="sourceLine" id="cb12-607" title="607"><span class="co">## </span></a>
<a class="sourceLine" id="cb12-608" title="608"><span class="co">##     1     2     3     4     5     6     7     8     9    10    11    12  &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb12-609" title="609"><span class="co">##  3117  8200 35527 55153 49235 69290   235   653  1588  1128   752  1363     0</span></a>
<a class="sourceLine" id="cb12-610" title="610"></a>
<a class="sourceLine" id="cb12-611" title="611"><span class="co"># Combinaison</span></a>
<a class="sourceLine" id="cb12-612" title="612">val_max &lt;-<span class="st"> </span><span class="kw">max</span>(caa_all_aut<span class="op">$</span>id); val_max</a>
<a class="sourceLine" id="cb12-613" title="613"><span class="co">## [1] 4484</span></a>
<a class="sourceLine" id="cb12-614" title="614">caa_all_crev &lt;-<span class="st"> </span>caa_all_crev <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">id =</span> id <span class="op">+</span><span class="st"> </span>val_max) <span class="co"># pour ne pas avoir de doublons d&#39;ids</span></a>
<a class="sourceLine" id="cb12-615" title="615"></a>
<a class="sourceLine" id="cb12-616" title="616">caa_all &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(caa_all_aut, caa_all_crev)</a>
<a class="sourceLine" id="cb12-617" title="617"><span class="kw">dim</span>(caa_all) <span class="co"># 229816 obs et 38 var</span></a>
<a class="sourceLine" id="cb12-618" title="618"><span class="co">## [1] 229816     38</span></a>
<a class="sourceLine" id="cb12-619" title="619"><span class="kw">n_distinct</span>(caa_all<span class="op">$</span>id) <span class="op">==</span><span class="st"> </span><span class="kw">nrow</span>(catch_caa) <span class="co"># vrai</span></a>
<a class="sourceLine" id="cb12-620" title="620"><span class="co">## [1] TRUE</span></a>
<a class="sourceLine" id="cb12-621" title="621">ids &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;age.&quot;</span>, <span class="kw">names</span>(caa_all)); ids</a>
<a class="sourceLine" id="cb12-622" title="622"><span class="co">##  [1] 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 34 36 37 38</span></a>
<a class="sourceLine" id="cb12-623" title="623">caa_all &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-624" title="624"><span class="st">           </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> ids, <span class="dt">.funs =</span> <span class="cf">function</span>(x) <span class="kw">ifelse</span>(<span class="kw">is.na</span>(x), <span class="dv">0</span>, x)) <span class="co"># à cause du bind_rows</span></a>
<a class="sourceLine" id="cb12-625" title="625"><span class="kw">save</span>(caa_all, <span class="dt">file =</span> dat_caa_raw)</a>
<a class="sourceLine" id="cb12-626" title="626"><span class="kw">rm</span>(caa_all_aut, caa_all_crev, ids)</a></code></pre></div>
</div>
<div id="calculs-à-lâge-1" class="section level2">
<h2><span class="header-section-number">5.2</span> Calculs à l’âge</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># 1) Calculs à l&#39;âge avec le groupe+ (pour caan seulement)</span></a>
<a class="sourceLine" id="cb13-2" title="2">caa &lt;-<span class="st"> </span><span class="kw">get.caa</span>(<span class="dt">x =</span> caa_all, <span class="dt">plus =</span> <span class="dv">13</span>) <span class="op">%&gt;%</span><span class="st"> </span>as_tibble <span class="co"># on utilise un groupe d&#39;âge 13+</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">dim</span>(caa) <span class="co"># 392 obs et 8 var</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">## [1] 392   8</span></a>
<a class="sourceLine" id="cb13-5" title="5">cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">with</span>(caa, age <span class="op">==</span><span class="st"> </span><span class="dv">13</span>)); <span class="kw">length</span>(cor) <span class="co"># 28 lignes</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">## [1] 28</span></a>
<a class="sourceLine" id="cb13-7" title="7">caa<span class="op">$</span>age[cor] &lt;-<span class="st"> &quot;13+&quot;</span></a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co"># 2) Calculs à l&#39;âge sans le groupe+ (pour les autres mesures)</span></a>
<a class="sourceLine" id="cb13-10" title="10">caa2 &lt;-<span class="st"> </span><span class="kw">get.caa</span>(<span class="dt">x =</span> caa_all) <span class="op">%&gt;%</span><span class="st"> </span>as_tibble</a>
<a class="sourceLine" id="cb13-11" title="11"><span class="kw">dim</span>(caa2) <span class="co"># 532 obs et 8 var</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">## [1] 532   8</span></a>
<a class="sourceLine" id="cb13-13" title="13"></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co"># 3) Combinaison</span></a>
<a class="sourceLine" id="cb13-15" title="15">caa &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;avec_plus&quot;</span> =<span class="st"> </span>caa, <span class="st">&quot;sans_plus&quot;</span> =<span class="st"> </span>caa2) <span class="co"># dans une liste pour éviter la confusion</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="kw">save</span>(caa, <span class="dt">file =</span>  dat_caa_processed)</a>
<a class="sourceLine" id="cb13-17" title="17"><span class="kw">rm</span>(caa2, bio, catch, engins_deb, engins_obs, lf, intrant_catch, intrant_lf, intrant_bio)</a></code></pre></div>
</div>
</div>
<div id="exemple-pour-le-resdoc" class="section level1">
<h1><span class="header-section-number">6</span> Exemple pour le resdoc</h1>
<p>J’y vais avec la strate: <em>2005–June–4Rb–Gillnet</em>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">catch &lt;-<span class="st"> </span>catch_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2005</span>, period <span class="op">==</span><span class="st"> </span><span class="dv">6</span>, region <span class="op">==</span><span class="st"> &quot;4Rb&quot;</span>, gear <span class="op">==</span><span class="st"> &quot;Gillnets&quot;</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3">C &lt;-<span class="st"> </span>catch<span class="op">$</span>catch; C</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">## [1] 1393</span></a>
<a class="sourceLine" id="cb14-5" title="5">y &lt;-<span class="st"> </span>catch<span class="op">$</span>year; y</a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">## [1] 2005</span></a>
<a class="sourceLine" id="cb14-7" title="7">p &lt;-<span class="st"> </span>catch<span class="op">$</span>period; p</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">## [1] 6</span></a>
<a class="sourceLine" id="cb14-9" title="9">r &lt;-<span class="st"> </span>catch<span class="op">$</span>region; r</a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">## [1] &quot;4Rb&quot;</span></a>
<a class="sourceLine" id="cb14-11" title="11">g &lt;-<span class="st"> </span>catch<span class="op">$</span>gear; g</a>
<a class="sourceLine" id="cb14-12" title="12"><span class="co">## [1] &quot;Gillnets&quot;</span></a>
<a class="sourceLine" id="cb14-13" title="13"></a>
<a class="sourceLine" id="cb14-14" title="14">find.samples &lt;-<span class="st"> </span><span class="cf">function</span>(df,o,y,p,r,g,period.unit){</a>
<a class="sourceLine" id="cb14-15" title="15">  df<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">with</span>(df, <span class="kw">ymd</span>(<span class="kw">paste</span>(year, period, <span class="st">&#39;01&#39;</span>)))</a>
<a class="sourceLine" id="cb14-16" title="16">  </a>
<a class="sourceLine" id="cb14-17" title="17">  d  &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="kw">paste</span>(y, p, <span class="st">&#39;01&#39;</span>)) <span class="co"># date (for semesters this will be month 1 to 4, but that doesn&#39;t matter)</span></a>
<a class="sourceLine" id="cb14-18" title="18">  dn &lt;-<span class="st"> </span>d <span class="co"># neigbouring dates. If no period data, all periods of the same year are allowed  (so option 1 and 2 are the same)</span></a>
<a class="sourceLine" id="cb14-19" title="19">  <span class="cf">if</span> (<span class="kw">length</span>(p) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){            <span class="co"># If period data; normal way</span></a>
<a class="sourceLine" id="cb14-20" title="20">    dn &lt;-<span class="st"> </span>d <span class="op">%m+%</span><span class="st"> </span><span class="kw">months</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="co"># neigbouring dates</span></a>
<a class="sourceLine" id="cb14-21" title="21">    <span class="cf">if</span> (period.unit <span class="op">==</span><span class="st"> &#39;quarter&#39;</span>){    <span class="co"># cheat and replace december with last quarter</span></a>
<a class="sourceLine" id="cb14-22" title="22">      <span class="kw">month</span>(dn[<span class="kw">which</span>(<span class="kw">month</span>(dn) <span class="op">==</span><span class="st"> </span><span class="dv">12</span>)]) &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb14-23" title="23">    }       </a>
<a class="sourceLine" id="cb14-24" title="24">  }</a>
<a class="sourceLine" id="cb14-25" title="25">  pn &lt;-<span class="st"> </span><span class="kw">month</span>(dn)       <span class="co"># neigbouring periods</span></a>
<a class="sourceLine" id="cb14-26" title="26">  yn &lt;-<span class="st"> </span>y <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># neigbouring years</span></a>
<a class="sourceLine" id="cb14-27" title="27">  </a>
<a class="sourceLine" id="cb14-28" title="28">  <span class="cf">switch</span>(<span class="kw">as.character</span>(o), </a>
<a class="sourceLine" id="cb14-29" title="29">         <span class="st">&#39;1&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, date <span class="op">%in%</span><span class="st"> </span>d  <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g <span class="op">&amp;</span><span class="st"> </span>region <span class="op">%in%</span><span class="st"> </span>r)},</a>
<a class="sourceLine" id="cb14-30" title="30">         <span class="st">&#39;2&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, date <span class="op">%in%</span><span class="st"> </span>dn <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g <span class="op">&amp;</span><span class="st"> </span>region <span class="op">%in%</span><span class="st"> </span>r)},</a>
<a class="sourceLine" id="cb14-31" title="31">         <span class="st">&#39;3&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, date <span class="op">%in%</span><span class="st"> </span>d  <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g)},                 </a>
<a class="sourceLine" id="cb14-32" title="32">         <span class="st">&#39;4&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, date <span class="op">%in%</span><span class="st"> </span>dn <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g)}, </a>
<a class="sourceLine" id="cb14-33" title="33">         <span class="st">&#39;5&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, year <span class="op">%in%</span><span class="st"> </span>y <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g)}, </a>
<a class="sourceLine" id="cb14-34" title="34">         <span class="st">&#39;6&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, year <span class="op">%in%</span><span class="st"> </span>y)}, </a>
<a class="sourceLine" id="cb14-35" title="35">         <span class="st">&#39;7&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, year <span class="op">%in%</span><span class="st"> </span>yn <span class="op">&amp;</span><span class="st"> </span>period <span class="op">%in%</span><span class="st"> </span>p  <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g <span class="op">&amp;</span><span class="st"> </span>region <span class="op">%in%</span><span class="st"> </span>r)}, </a>
<a class="sourceLine" id="cb14-36" title="36">         <span class="st">&#39;8&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, year <span class="op">%in%</span><span class="st"> </span>yn <span class="op">&amp;</span><span class="st"> </span>period <span class="op">%in%</span><span class="st"> </span>pn <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g <span class="op">&amp;</span><span class="st"> </span>region <span class="op">%in%</span><span class="st"> </span>r)}, </a>
<a class="sourceLine" id="cb14-37" title="37">         <span class="st">&#39;9&#39;</span>  =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, year <span class="op">%in%</span><span class="st"> </span>yn <span class="op">&amp;</span><span class="st"> </span>period <span class="op">%in%</span><span class="st"> </span>p  <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g)},</a>
<a class="sourceLine" id="cb14-38" title="38">         <span class="st">&#39;10&#39;</span> =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, year <span class="op">%in%</span><span class="st"> </span>yn <span class="op">&amp;</span><span class="st"> </span>period <span class="op">%in%</span><span class="st"> </span>pn <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g)},</a>
<a class="sourceLine" id="cb14-39" title="39">         <span class="st">&#39;11&#39;</span> =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, year <span class="op">%in%</span><span class="st"> </span>yn <span class="op">&amp;</span><span class="st"> </span>gear <span class="op">%in%</span><span class="st"> </span>g)},</a>
<a class="sourceLine" id="cb14-40" title="40">         <span class="st">&#39;12&#39;</span> =<span class="st"> </span>{id &lt;-<span class="st"> </span><span class="kw">with</span>(df, year <span class="op">%in%</span><span class="st"> </span>yn)})</a>
<a class="sourceLine" id="cb14-41" title="41">  <span class="kw">return</span>(id)</a>
<a class="sourceLine" id="cb14-42" title="42">}</a>
<a class="sourceLine" id="cb14-43" title="43"></a>
<a class="sourceLine" id="cb14-44" title="44">lf &lt;-<span class="st"> </span>lf_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(source <span class="op">==</span><span class="st"> &quot;quai&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>source)</a>
<a class="sourceLine" id="cb14-45" title="45">al &lt;-<span class="st"> </span>bio_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(source <span class="op">==</span><span class="st"> &quot;quai&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>source)</a>
<a class="sourceLine" id="cb14-46" title="46">period.unit &lt;-<span class="st"> &quot;month&quot;</span></a>
<a class="sourceLine" id="cb14-47" title="47"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb14-48" title="48">cacol &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;year&#39;</span>, <span class="st">&#39;period&#39;</span>, <span class="st">&#39;region&#39;</span>, <span class="st">&#39;gear&#39;</span>, <span class="st">&#39;catch&#39;</span>) <span class="co"># required columns in catch</span></a>
<a class="sourceLine" id="cb14-49" title="49">lfcol &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;year&#39;</span>, <span class="st">&#39;period&#39;</span>, <span class="st">&#39;region&#39;</span>, <span class="st">&#39;gear&#39;</span>, <span class="st">&#39;sample.id&#39;</span>, <span class="st">&#39;length&#39;</span>, <span class="st">&#39;weight.unit&#39;</span>, <span class="st">&#39;n&#39;</span>) <span class="co"># required columns in lf</span></a>
<a class="sourceLine" id="cb14-50" title="50">alcol &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;year&#39;</span>, <span class="st">&#39;period&#39;</span>, <span class="st">&#39;region&#39;</span>, <span class="st">&#39;gear&#39;</span>, <span class="st">&#39;sample.id&#39;</span>, <span class="st">&#39;length&#39;</span>, <span class="st">&#39;age&#39;</span>) <span class="co"># required columns in al</span></a>
<a class="sourceLine" id="cb14-51" title="51"></a>
<a class="sourceLine" id="cb14-52" title="52"><span class="co"># Recherche LF</span></a>
<a class="sourceLine" id="cb14-53" title="53"><span class="co"># Niveau 1</span></a>
<a class="sourceLine" id="cb14-54" title="54">o.lf &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb14-55" title="55">id &lt;-<span class="st"> </span><span class="kw">find.samples</span>(lf,o.lf,y,p,r,g,period.unit) <span class="co"># find samples according to step o</span></a>
<a class="sourceLine" id="cb14-56" title="56">this.lf &lt;-<span class="st"> </span>lf[id, ] <span class="co"># select them</span></a>
<a class="sourceLine" id="cb14-57" title="57">n.lf &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">unique</span>(this.lf[,lfcol[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]])); n.lf <span class="co"># count unique samples </span></a>
<a class="sourceLine" id="cb14-58" title="58"><span class="co">## [1] 1</span></a>
<a class="sourceLine" id="cb14-59" title="59"><span class="co"># Pas assez d&#39;échantillon, vais au niveau 2</span></a>
<a class="sourceLine" id="cb14-60" title="60"></a>
<a class="sourceLine" id="cb14-61" title="61"><span class="co"># Niveau 2</span></a>
<a class="sourceLine" id="cb14-62" title="62">o.lf &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb14-63" title="63">id &lt;-<span class="st"> </span><span class="kw">find.samples</span>(lf,o.lf,y,p,r,g,period.unit) <span class="co"># find samples according to step o</span></a>
<a class="sourceLine" id="cb14-64" title="64">this.lf &lt;-<span class="st"> </span>lf[id, ] <span class="co"># select them</span></a>
<a class="sourceLine" id="cb14-65" title="65">n.lf &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">unique</span>(this.lf[,lfcol[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]])); n.lf <span class="co"># count unique samples </span></a>
<a class="sourceLine" id="cb14-66" title="66"><span class="co">## [1] 15</span></a>
<a class="sourceLine" id="cb14-67" title="67"><span class="co"># 15 échantillons. Reste au niveau 2.</span></a>
<a class="sourceLine" id="cb14-68" title="68"><span class="kw">sum</span>(this.lf<span class="op">$</span>n) <span class="co"># 2306 poissons mesurés pour la FL</span></a>
<a class="sourceLine" id="cb14-69" title="69"><span class="co">## [1] 2306</span></a>
<a class="sourceLine" id="cb14-70" title="70"></a>
<a class="sourceLine" id="cb14-71" title="71"><span class="co"># Création de la clé âge-longueur globale</span></a>
<a class="sourceLine" id="cb14-72" title="72">alg &lt;-<span class="st"> </span><span class="kw">table</span>(al<span class="op">$</span>length,al<span class="op">$</span>age)</a>
<a class="sourceLine" id="cb14-73" title="73">alg &lt;-<span class="st"> </span><span class="kw">prop.table</span>(alg,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-74" title="74">alg &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">length=</span><span class="kw">as.numeric</span>(<span class="kw">rownames</span>(alg)),<span class="kw">data.frame</span>(<span class="kw">rbind</span>(alg)))</a>
<a class="sourceLine" id="cb14-75" title="75"></a>
<a class="sourceLine" id="cb14-76" title="76">le &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">length =</span> <span class="kw">seq</span>(<span class="kw">min</span>(<span class="kw">c</span>(alg<span class="op">$</span>length, lf<span class="op">$</span>length)), <span class="kw">max</span>(<span class="kw">c</span>(alg<span class="op">$</span>length, lf<span class="op">$</span>length)), <span class="kw">min</span>(<span class="kw">diff</span>(alg<span class="op">$</span>length))))</a>
<a class="sourceLine" id="cb14-77" title="77">alg &lt;-<span class="st"> </span><span class="kw">merge</span>(le,alg)</a>
<a class="sourceLine" id="cb14-78" title="78"></a>
<a class="sourceLine" id="cb14-79" title="79"><span class="kw">library</span>(nnet)</a>
<a class="sourceLine" id="cb14-80" title="80">fill.multinom &lt;-<span class="st"> </span><span class="cf">function</span>(df, acol, lcol, <span class="dt">id=</span><span class="ot">NULL</span>, <span class="dt">smooth=</span><span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb14-81" title="81">    alen &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(df[,acol,<span class="dt">drop=</span><span class="ot">FALSE</span>])</a>
<a class="sourceLine" id="cb14-82" title="82">    len  &lt;-<span class="st"> </span>df[,lcol]</a>
<a class="sourceLine" id="cb14-83" title="83">    <span class="cf">if</span>(<span class="kw">ncol</span>(alen) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){ <span class="co"># if there is only one age class than the likelihood is always 1??</span></a>
<a class="sourceLine" id="cb14-84" title="84">        new &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(alen))</a>
<a class="sourceLine" id="cb14-85" title="85">        <span class="kw">warning</span>(<span class="kw">paste0</span>(<span class="st">&#39;** for catch stratum &#39;</span>, id, <span class="st">&#39; only one age class was found **&#39;</span>))</a>
<a class="sourceLine" id="cb14-86" title="86">    }<span class="cf">else</span>{ <span class="co"># model if there are multiple age classes</span></a>
<a class="sourceLine" id="cb14-87" title="87">        m &lt;-<span class="st"> </span><span class="kw">multinom</span>(alen<span class="op">~</span>len, <span class="dt">trace =</span> F, <span class="dt">maxit =</span> <span class="dv">1500</span>)</a>
<a class="sourceLine" id="cb14-88" title="88">        <span class="cf">if</span> (m<span class="op">$</span>convergence <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">warning</span>(<span class="kw">paste</span>(<span class="st">&#39;** Non-convergence when filling gaps for id&#39;</span>, id))</a>
<a class="sourceLine" id="cb14-89" title="89">        new &lt;-<span class="st"> </span><span class="kw">predict</span>(m, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">len =</span> df<span class="op">$</span>length), <span class="dt">type =</span> <span class="st">&quot;probs&quot;</span>) <span class="co"># predictions for all lengths found in df</span></a>
<a class="sourceLine" id="cb14-90" title="90">        new &lt;-<span class="st"> </span><span class="kw">round</span>(new, <span class="dv">3</span>) <span class="co"># acceptable precision level (to avoid 0.0000001 % chances of absurd age-length combos)</span></a>
<a class="sourceLine" id="cb14-91" title="91">    }</a>
<a class="sourceLine" id="cb14-92" title="92">    </a>
<a class="sourceLine" id="cb14-93" title="93">    <span class="co"># replace onle NAs or everything by predictions</span></a>
<a class="sourceLine" id="cb14-94" title="94">    <span class="cf">if</span>(smooth){</a>
<a class="sourceLine" id="cb14-95" title="95">        df[, acol] &lt;-<span class="st"> </span>new</a>
<a class="sourceLine" id="cb14-96" title="96">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb14-97" title="97">        df[, acol][<span class="kw">is.na</span>(df[, acol])] &lt;-<span class="st"> </span>new[<span class="kw">is.na</span>(df[, acol])]</a>
<a class="sourceLine" id="cb14-98" title="98">    }</a>
<a class="sourceLine" id="cb14-99" title="99">    </a>
<a class="sourceLine" id="cb14-100" title="100">    <span class="kw">return</span>(df)</a>
<a class="sourceLine" id="cb14-101" title="101">}</a>
<a class="sourceLine" id="cb14-102" title="102"></a>
<a class="sourceLine" id="cb14-103" title="103">alg &lt;-<span class="st"> </span><span class="kw">fill.multinom</span>(<span class="dt">df =</span> alg, <span class="dt">acol =</span> <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(alg), <span class="dt">lcol =</span> <span class="dv">1</span>, <span class="dt">id=</span><span class="st">&#39;global&#39;</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-104" title="104"></a>
<a class="sourceLine" id="cb14-105" title="105"><span class="co"># Recherche Age</span></a>
<a class="sourceLine" id="cb14-106" title="106"><span class="co"># Niveau 1</span></a>
<a class="sourceLine" id="cb14-107" title="107">o.al &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb14-108" title="108">id &lt;-<span class="st"> </span><span class="kw">find.samples</span>(al,o.al,y,p,r,g,period.unit)</a>
<a class="sourceLine" id="cb14-109" title="109">this.al &lt;-<span class="st"> </span>al[id,] <span class="co"># select them</span></a>
<a class="sourceLine" id="cb14-110" title="110">n.al &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">unique</span>(this.al[,alcol[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]])); n.al <span class="co"># count unique samples</span></a>
<a class="sourceLine" id="cb14-111" title="111"><span class="co">## [1] 0</span></a>
<a class="sourceLine" id="cb14-112" title="112"><span class="co"># Pas assez d&#39;échantillon, vais au niveau 2</span></a>
<a class="sourceLine" id="cb14-113" title="113"></a>
<a class="sourceLine" id="cb14-114" title="114"><span class="co"># Niveau 2</span></a>
<a class="sourceLine" id="cb14-115" title="115">o.al &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb14-116" title="116">id &lt;-<span class="st"> </span><span class="kw">find.samples</span>(al,o.al,y,p,r,g,period.unit)</a>
<a class="sourceLine" id="cb14-117" title="117">this.al &lt;-<span class="st"> </span>al[id,] <span class="co"># select them</span></a>
<a class="sourceLine" id="cb14-118" title="118">n.al &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">unique</span>(this.al[,alcol[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]])); n.al <span class="co"># 12 échantillons = critère 1 ok</span></a>
<a class="sourceLine" id="cb14-119" title="119"><span class="co">## [1] 12</span></a>
<a class="sourceLine" id="cb14-120" title="120">f.al &lt;-<span class="st"> </span><span class="kw">nrow</span>(this.al); f.al <span class="co"># 227 poissons, critère 2 ok</span></a>
<a class="sourceLine" id="cb14-121" title="121"><span class="co">## [1] 227</span></a>
<a class="sourceLine" id="cb14-122" title="122"></a>
<a class="sourceLine" id="cb14-123" title="123"><span class="co"># Tableau pour le resdoc</span></a>
<a class="sourceLine" id="cb14-124" title="124">temp &lt;-<span class="st"> </span>this.lf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-125" title="125"><span class="st">        </span><span class="kw">group_by</span>(length) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-126" title="126"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">n_fl =</span> <span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-127" title="127"><span class="st">        </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-128" title="128"><span class="st">        </span><span class="kw">left_join</span>(., this.al <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-129" title="129"><span class="st">                     </span><span class="kw">group_by</span>(length) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-130" title="130"><span class="st">                     </span><span class="kw">summarise</span>(<span class="dt">n_al =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-131" title="131"><span class="st">                     </span>ungroup, <span class="dt">by =</span> <span class="st">&quot;length&quot;</span>) </a>
<a class="sourceLine" id="cb14-132" title="132"></a>
<a class="sourceLine" id="cb14-133" title="133"><span class="co"># Longueurs ne nécessitant pas alg</span></a>
<a class="sourceLine" id="cb14-134" title="134">avec &lt;-<span class="st"> </span>temp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(n_al)); avec</a>
<a class="sourceLine" id="cb14-135" title="135"><span class="co">## # A tibble: 49 x 3</span></a>
<a class="sourceLine" id="cb14-136" title="136"><span class="co">##    length  n_fl  n_al</span></a>
<a class="sourceLine" id="cb14-137" title="137"><span class="co">##     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb14-138" title="138"><span class="co">##  1     49     1     1</span></a>
<a class="sourceLine" id="cb14-139" title="139"><span class="co">##  2     50     4     3</span></a>
<a class="sourceLine" id="cb14-140" title="140"><span class="co">##  3     51    17     8</span></a>
<a class="sourceLine" id="cb14-141" title="141"><span class="co">##  4     52    17     6</span></a>
<a class="sourceLine" id="cb14-142" title="142"><span class="co">##  5     53    30     5</span></a>
<a class="sourceLine" id="cb14-143" title="143"><span class="co">##  6     54    42     1</span></a>
<a class="sourceLine" id="cb14-144" title="144"><span class="co">##  7     55    70     9</span></a>
<a class="sourceLine" id="cb14-145" title="145"><span class="co">##  8     56    96     8</span></a>
<a class="sourceLine" id="cb14-146" title="146"><span class="co">##  9     57    98     6</span></a>
<a class="sourceLine" id="cb14-147" title="147"><span class="co">## 10     58   136     3</span></a>
<a class="sourceLine" id="cb14-148" title="148"><span class="co">## # ... with 39 more rows</span></a>
<a class="sourceLine" id="cb14-149" title="149">alk &lt;-<span class="st"> </span>this.al <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-150" title="150"><span class="st">       </span><span class="kw">group_by</span>(length, age) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-151" title="151"><span class="st">       </span>count <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-152" title="152"><span class="st">       </span><span class="kw">group_by</span>(length) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-153" title="153"><span class="st">       </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-154" title="154"><span class="st">       </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-155" title="155"><span class="st">       </span><span class="kw">pivot_wider</span>(<span class="dt">id_cols =</span> <span class="st">&quot;length&quot;</span>, <span class="dt">names_from =</span> <span class="st">&quot;age&quot;</span>, <span class="dt">names_prefix =</span> <span class="st">&quot;X&quot;</span>, <span class="dt">values_from =</span> prop)</a>
<a class="sourceLine" id="cb14-156" title="156">alk</a>
<a class="sourceLine" id="cb14-157" title="157"><span class="co">## # A tibble: 49 x 12</span></a>
<a class="sourceLine" id="cb14-158" title="158"><span class="co">##    length     X5     X4     X6     X7     X8     X9    X11   X10   X14   X12</span></a>
<a class="sourceLine" id="cb14-159" title="159"><span class="co">##     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-160" title="160"><span class="co">##  1     49  1     NA     NA     NA     NA     NA     NA        NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-161" title="161"><span class="co">##  2     50  0.667  0.333 NA     NA     NA     NA     NA        NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-162" title="162"><span class="co">##  3     51  0.25   0.125  0.375  0.25  NA     NA     NA        NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-163" title="163"><span class="co">##  4     52  0.333 NA      0.167  0.333  0.167 NA     NA        NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-164" title="164"><span class="co">##  5     53 NA     NA     NA      0.6    0.2    0.2   NA        NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-165" title="165"><span class="co">##  6     54 NA     NA     NA      1     NA     NA     NA        NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-166" title="166"><span class="co">##  7     55  0.111 NA      0.111  0.333 NA      0.444 NA        NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-167" title="167"><span class="co">##  8     56 NA     NA      0.125  0.625  0.125 NA      0.125    NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-168" title="168"><span class="co">##  9     57 NA     NA     NA      0.833  0.167 NA     NA        NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-169" title="169"><span class="co">## 10     58 NA     NA     NA      0.667 NA     NA      0.333    NA    NA    NA</span></a>
<a class="sourceLine" id="cb14-170" title="170"><span class="co">## # ... with 39 more rows, and 1 more variable: X13 &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-171" title="171">avec &lt;-<span class="st"> </span><span class="kw">left_join</span>(avec, alk, <span class="dt">by =</span> <span class="st">&quot;length&quot;</span>)</a>
<a class="sourceLine" id="cb14-172" title="172"></a>
<a class="sourceLine" id="cb14-173" title="173"><span class="co"># Longueurs nécessitant alg</span></a>
<a class="sourceLine" id="cb14-174" title="174">manque &lt;-<span class="st"> </span>temp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">is.na</span>(n_al)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">n_al =</span> <span class="dv">0</span>); manque</a>
<a class="sourceLine" id="cb14-175" title="175"><span class="co">## # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb14-176" title="176"><span class="co">##   length  n_fl  n_al</span></a>
<a class="sourceLine" id="cb14-177" title="177"><span class="co">##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-178" title="178"><span class="co">## 1     27     8     0</span></a>
<a class="sourceLine" id="cb14-179" title="179">manque &lt;-<span class="st"> </span><span class="kw">left_join</span>(manque, alg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(length <span class="op">==</span><span class="st"> </span><span class="dv">27</span>), <span class="dt">by =</span> <span class="st">&quot;length&quot;</span>)</a>
<a class="sourceLine" id="cb14-180" title="180"></a>
<a class="sourceLine" id="cb14-181" title="181">table1 &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(manque <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">length =</span> <span class="kw">as.character</span>(length)), </a>
<a class="sourceLine" id="cb14-182" title="182">                    avec[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">length =</span> <span class="kw">as.character</span>(length)), </a>
<a class="sourceLine" id="cb14-183" title="183">                    <span class="kw">tibble</span>(<span class="dt">length =</span> <span class="st">&quot;...&quot;</span>), </a>
<a class="sourceLine" id="cb14-184" title="184">                    avec[<span class="kw">nrow</span>(avec), ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">length =</span> <span class="kw">as.character</span>(length))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-185" title="185"><span class="st">          </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">.funs =</span> <span class="cf">function</span>(x) <span class="kw">ifelse</span>(<span class="kw">is.na</span>(x), <span class="st">&quot;&quot;</span>, x)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-186" title="186"><span class="st">          </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="dv">4</span><span class="op">:</span><span class="kw">ncol</span>(.), </a>
<a class="sourceLine" id="cb14-187" title="187">                    <span class="dt">.funs =</span> <span class="cf">function</span>(x) <span class="kw">ifelse</span>(<span class="kw">is.na</span>(x)<span class="op">|</span>x <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;&quot;</span>, <span class="kw">format</span>(x, <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">nsmall =</span> <span class="dv">3</span>, <span class="dt">decimal.mark =</span> dm)))</a>
<a class="sourceLine" id="cb14-188" title="188"></a>
<a class="sourceLine" id="cb14-189" title="189">ages_alk &lt;-<span class="st"> </span>this.al <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(age) <span class="op">%&gt;%</span><span class="st"> </span>sort <span class="op">%&gt;%</span><span class="st"> </span>unique; ages_alk <span class="co"># âges déjà dans la clé âge-longueur</span></a>
<a class="sourceLine" id="cb14-190" title="190"><span class="co">##  [1]  4  5  6  7  8  9 10 11 12 13 14</span></a>
<a class="sourceLine" id="cb14-191" title="191">ages_alg &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="kw">names</span>(alg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;&quot;</span>, .) <span class="op">%&gt;%</span><span class="st"> </span>.[<span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(.)], ages_alk); ages_alg <span class="co"># âges dans alg</span></a>
<a class="sourceLine" id="cb14-192" title="192"><span class="co">## [1] &quot;2&quot;  &quot;3&quot;  &quot;15&quot; &quot;16&quot; &quot;17&quot; &quot;18&quot;</span></a>
<a class="sourceLine" id="cb14-193" title="193">ages_manque &lt;-<span class="st"> </span><span class="kw">setdiff</span>(ages_alg, ages_alk); ages_manque</a>
<a class="sourceLine" id="cb14-194" title="194"><span class="co">## [1] &quot;2&quot;  &quot;3&quot;  &quot;15&quot; &quot;16&quot; &quot;17&quot; &quot;18&quot;</span></a>
<a class="sourceLine" id="cb14-195" title="195">ages_dispo &lt;-<span class="st"> </span>bio_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(y<span class="dv">-1</span>, y, y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(age) <span class="op">%&gt;%</span><span class="st"> </span>sort <span class="op">%&gt;%</span><span class="st"> </span>unique</a>
<a class="sourceLine" id="cb14-196" title="196">ages_dispo &lt;-<span class="st"> </span><span class="kw">setdiff</span>(ages_dispo, ages_alk)</a>
<a class="sourceLine" id="cb14-197" title="197">ages_manque &lt;-<span class="st"> </span><span class="kw">setdiff</span>(ages_manque, ages_dispo)</a>
<a class="sourceLine" id="cb14-198" title="198"></a>
<a class="sourceLine" id="cb14-199" title="199"><span class="co"># https://stackoverflow.com/questions/53188034/change-background-colour-of-knitrkable-headers</span></a>
<a class="sourceLine" id="cb14-200" title="200"></a>
<a class="sourceLine" id="cb14-201" title="201"><span class="kw">names</span>(table1) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">names</span>(table1))</a>
<a class="sourceLine" id="cb14-202" title="202">cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">names</span>(table1) <span class="op">%in%</span><span class="st"> </span>ages_alk)</a>
<a class="sourceLine" id="cb14-203" title="203"><span class="kw">names</span>(table1)[cor] &lt;-<span class="st"> </span><span class="kw">cell_spec</span>(<span class="kw">names</span>(table1)[cor], <span class="dt">background =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;latex&quot;</span>)</a>
<a class="sourceLine" id="cb14-204" title="204"></a>
<a class="sourceLine" id="cb14-205" title="205">cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">names</span>(table1) <span class="op">%in%</span><span class="st"> </span>ages_manque)</a>
<a class="sourceLine" id="cb14-206" title="206"><span class="kw">names</span>(table1)[cor] &lt;-<span class="st"> </span><span class="kw">cell_spec</span>(<span class="kw">names</span>(table1)[cor], <span class="dt">background =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;latex&quot;</span>)</a>
<a class="sourceLine" id="cb14-207" title="207"></a>
<a class="sourceLine" id="cb14-208" title="208">cor &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">names</span>(table1) <span class="op">%in%</span><span class="st"> </span>ages_dispo)</a>
<a class="sourceLine" id="cb14-209" title="209"><span class="kw">names</span>(table1)[cor] &lt;-<span class="st"> </span><span class="kw">cell_spec</span>(<span class="kw">names</span>(table1)[cor], <span class="dt">background =</span> <span class="st">&quot;yellow&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;latex&quot;</span>)</a>
<a class="sourceLine" id="cb14-210" title="210"></a>
<a class="sourceLine" id="cb14-211" title="211"><span class="kw">rm</span>(lf, al, C, y, p, r, g, period.unit, cacol, alcol, lfcol, o.lf, n.al, n.lf, le,</a>
<a class="sourceLine" id="cb14-212" title="212">   o.al, this.al, temp, this.lf, alg, avec, alk, manque, ages_alk, ages_manque, cor)</a></code></pre></div>
</div>
<div id="calculs-pour-le-resdoc" class="section level1">
<h1><span class="header-section-number">7</span> Calculs pour le resdoc</h1>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">nrow</span>(catch_caa) <span class="co"># 4591 strates année-mois-OPANO-engin utilisées</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co">## [1] 4591</span></a>
<a class="sourceLine" id="cb15-3" title="3"></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co"># FL</span></a>
<a class="sourceLine" id="cb15-5" title="5">caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">option_fl =</span> <span class="kw">unique</span>(option.lengthfreq)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="st">  </span><span class="kw">group_by</span>(option_fl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb15-12" title="12">         <span class="dt">perc_cum =</span> <span class="kw">cumsum</span>(perc))</a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">## # A tibble: 9 x 4</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">##   option_fl     n    perc perc_cum</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">##       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">## 1         1   310  6.75       6.75</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">## 2         2   343  7.47      14.2 </span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">## 3         3  1237 26.9       41.2 </span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">## 4         4   873 19.0       60.2 </span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">## 5         5   823 17.9       78.1 </span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">## 6         6  1001 21.8       99.9 </span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co">## 7         7     1  0.0218    99.9 </span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">## 8         8     2  0.0436   100.  </span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">## 9        11     1  0.0218   100</span></a>
<a class="sourceLine" id="cb15-25" title="25"></a>
<a class="sourceLine" id="cb15-26" title="26">caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-27" title="27"><span class="st">  </span><span class="kw">filter</span>(gear <span class="op">==</span><span class="st"> &quot;Shrimp trawl&quot;</span>, option.lengthfreq <span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="st">  </span><span class="kw">distinct</span>(id, year, period, region, gear, option.lengthfreq)</a>
<a class="sourceLine" id="cb15-29" title="29"><span class="co">## # A tibble: 4 x 6</span></a>
<a class="sourceLine" id="cb15-30" title="30"><span class="co">##      id  year period region gear         option.lengthfreq</span></a>
<a class="sourceLine" id="cb15-31" title="31"><span class="co">##   &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;                    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb15-32" title="32"><span class="co">## 1  4543  1995      6 4Rb    Shrimp trawl                11</span></a>
<a class="sourceLine" id="cb15-33" title="33"><span class="co">## 2  4544  1995      4 4Si    Shrimp trawl                 7</span></a>
<a class="sourceLine" id="cb15-34" title="34"><span class="co">## 3  4545  1995      5 4Si    Shrimp trawl                 8</span></a>
<a class="sourceLine" id="cb15-35" title="35"><span class="co">## 4  4546  1995      5 4Ss    Shrimp trawl                 8</span></a>
<a class="sourceLine" id="cb15-36" title="36"><span class="co"># La majorité des strates atteignaient le niveau requis d&#39;échantillon &lt;= niveau 4. Les niveaux 7 à 12 n&#39;ont été utilisé que pour</span></a>
<a class="sourceLine" id="cb15-37" title="37"><span class="co"># 4 strates, toutes de 1995 et avec le chalut à crevettes</span></a>
<a class="sourceLine" id="cb15-38" title="38"></a>
<a class="sourceLine" id="cb15-39" title="39"><span class="co"># ALK</span></a>
<a class="sourceLine" id="cb15-40" title="40">caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-41" title="41"><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-42" title="42"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">option_age =</span> <span class="kw">unique</span>(option.agelength)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-43" title="43"><span class="st">  </span><span class="kw">group_by</span>(option_age) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-44" title="44"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-45" title="45"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-46" title="46"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb15-47" title="47">         <span class="dt">perc_cum =</span> <span class="kw">cumsum</span>(perc))</a>
<a class="sourceLine" id="cb15-48" title="48"><span class="co">## # A tibble: 12 x 4</span></a>
<a class="sourceLine" id="cb15-49" title="49"><span class="co">##    option_age     n   perc perc_cum</span></a>
<a class="sourceLine" id="cb15-50" title="50"><span class="co">##         &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb15-51" title="51"><span class="co">##  1          1    64  1.39      1.39</span></a>
<a class="sourceLine" id="cb15-52" title="52"><span class="co">##  2          2   178  3.88      5.27</span></a>
<a class="sourceLine" id="cb15-53" title="53"><span class="co">##  3          3   743 16.2      21.5 </span></a>
<a class="sourceLine" id="cb15-54" title="54"><span class="co">##  4          4  1208 26.3      47.8 </span></a>
<a class="sourceLine" id="cb15-55" title="55"><span class="co">##  5          5   986 21.5      69.2 </span></a>
<a class="sourceLine" id="cb15-56" title="56"><span class="co">##  6          6  1183 25.8      95.0 </span></a>
<a class="sourceLine" id="cb15-57" title="57"><span class="co">##  7          7     5  0.109    95.1 </span></a>
<a class="sourceLine" id="cb15-58" title="58"><span class="co">##  8          8    14  0.305    95.4 </span></a>
<a class="sourceLine" id="cb15-59" title="59"><span class="co">##  9          9    43  0.937    96.4 </span></a>
<a class="sourceLine" id="cb15-60" title="60"><span class="co">## 10         10    45  0.980    97.3 </span></a>
<a class="sourceLine" id="cb15-61" title="61"><span class="co">## 11         11    93  2.03     99.4 </span></a>
<a class="sourceLine" id="cb15-62" title="62"><span class="co">## 12         12    29  0.632   100</span></a>
<a class="sourceLine" id="cb15-63" title="63"></a>
<a class="sourceLine" id="cb15-64" title="64">caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-65" title="65"><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-66" title="66"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">option_age =</span> <span class="kw">unique</span>(option.agelength)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-67" title="67"><span class="st">  </span><span class="kw">group_by</span>(option_age) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-68" title="68"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-69" title="69"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-70" title="70"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-71" title="71"><span class="st">  </span><span class="kw">filter</span>(option_age <span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-72" title="72"><span class="st">  </span><span class="kw">pull</span>(perc) <span class="op">%&gt;%</span><span class="st"> </span>sum</a>
<a class="sourceLine" id="cb15-73" title="73"><span class="co">## [1] 4.98802</span></a>
<a class="sourceLine" id="cb15-74" title="74"></a>
<a class="sourceLine" id="cb15-75" title="75">caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-76" title="76"><span class="st">  </span><span class="kw">filter</span>(option.agelength <span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-77" title="77"><span class="st">  </span><span class="kw">distinct</span>(id, year, gear) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-78" title="78"><span class="st">  </span><span class="kw">group_by</span>(gear) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-79" title="79"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb15-80" title="80">            <span class="dt">year =</span> <span class="kw">paste</span>(<span class="kw">as.character</span>(<span class="kw">sort</span>(<span class="kw">unique</span>(year))), <span class="dt">collapse =</span> <span class="st">&quot;, &quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-81" title="81"><span class="st">  </span>ungroup</a>
<a class="sourceLine" id="cb15-82" title="82"><span class="co">## # A tibble: 7 x 3</span></a>
<a class="sourceLine" id="cb15-83" title="83"><span class="co">##   gear            n year                                                        </span></a>
<a class="sourceLine" id="cb15-84" title="84"><span class="co">##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;                                                       </span></a>
<a class="sourceLine" id="cb15-85" title="85"><span class="co">## 1 Gillnets       46 2003                                                        </span></a>
<a class="sourceLine" id="cb15-86" title="86"><span class="co">## 2 Hand gear       2 2003                                                        </span></a>
<a class="sourceLine" id="cb15-87" title="87"><span class="co">## 3 Longlines      47 2003                                                        </span></a>
<a class="sourceLine" id="cb15-88" title="88"><span class="co">## 4 Other traw~    17 2003                                                        </span></a>
<a class="sourceLine" id="cb15-89" title="89"><span class="co">## 5 Seines          7 2003                                                        </span></a>
<a class="sourceLine" id="cb15-90" title="90"><span class="co">## 6 Shrimp tra~   107 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,~</span></a>
<a class="sourceLine" id="cb15-91" title="91"><span class="co">## 7 Traps           3 2003</span></a>
<a class="sourceLine" id="cb15-92" title="92"><span class="co"># La presque majorité des strates atteignaient le niveau requis d&#39;échantillons &lt;= niveau 4.</span></a>
<a class="sourceLine" id="cb15-93" title="93"><span class="co"># Moins de 5 % des strates utilisent les niveaux 7-12. Pour les engins autres que le chalut à crevettes, </span></a>
<a class="sourceLine" id="cb15-94" title="94"><span class="co"># on parle toujours de l&#39;année 2003.</span></a>
<a class="sourceLine" id="cb15-95" title="95"></a>
<a class="sourceLine" id="cb15-96" title="96">caa_all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">unique</span>(nsample.lengthfreq)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span>summary </a>
<a class="sourceLine" id="cb15-97" title="97"><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb15-98" title="98"><span class="co">##    2.00    3.00    6.00   18.48   17.00  778.00</span></a>
<a class="sourceLine" id="cb15-99" title="99"><span class="co"># Les strates avaient en moyenne 18.48 échantillons pour faire leur FL (med = 6, min = 2, max = 778)</span></a>
<a class="sourceLine" id="cb15-100" title="100"></a>
<a class="sourceLine" id="cb15-101" title="101">caa_all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">sum</span>(n.lf)) <span class="op">%&gt;%</span><span class="st"> </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span>summary</a>
<a class="sourceLine" id="cb15-102" title="102"><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb15-103" title="103"><span class="co">##     2.0   479.5   880.0  1881.3  2151.0 26468.0</span></a>
<a class="sourceLine" id="cb15-104" title="104"><span class="co"># Les strates avaient en moyenne 1881.3 morues pour faire leur FL (med = 880, min = 2, max = 26468)</span></a>
<a class="sourceLine" id="cb15-105" title="105"></a>
<a class="sourceLine" id="cb15-106" title="106">caa_all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">unique</span>(nsample.agelength)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span>summary </a>
<a class="sourceLine" id="cb15-107" title="107"><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb15-108" title="108"><span class="co">##    2.00    5.00   10.00   22.97   22.00  522.00</span></a>
<a class="sourceLine" id="cb15-109" title="109"><span class="co"># Les strates avaient en moyenne 22.97 échantillons pour faire leur clé âge-longueur (med = 10, min = 2, max = 522)</span></a>
<a class="sourceLine" id="cb15-110" title="110"></a>
<a class="sourceLine" id="cb15-111" title="111">caa_all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">unique</span>(n.altot)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span>summary </a>
<a class="sourceLine" id="cb15-112" title="112"><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb15-113" title="113"><span class="co">##     3.0   161.0   260.0   431.8   585.0  2887.0</span></a>
<a class="sourceLine" id="cb15-114" title="114"><span class="co"># Les strates avaient en moyenne 431.8 morues pour faire leur clé âge-longueur (med = 260, min = 3, max = 2887)</span></a>
<a class="sourceLine" id="cb15-115" title="115"></a>
<a class="sourceLine" id="cb15-116" title="116">caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-117" title="117"><span class="st">  </span><span class="kw">filter</span>(gear <span class="op">==</span><span class="st"> &quot;Shrimp trawl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-118" title="118"><span class="st">  </span><span class="kw">group_by</span>(option.agelength) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-119" title="119"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n_distinct</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-120" title="120"><span class="st">  </span>ungroup</a>
<a class="sourceLine" id="cb15-121" title="121"><span class="co">## # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb15-122" title="122"><span class="co">##   option.agelength     n</span></a>
<a class="sourceLine" id="cb15-123" title="123"><span class="co">##              &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb15-124" title="124"><span class="co">## 1                9     9</span></a>
<a class="sourceLine" id="cb15-125" title="125"><span class="co">## 2               10    21</span></a>
<a class="sourceLine" id="cb15-126" title="126"><span class="co">## 3               11    77</span></a></code></pre></div>
<p>Est-ce que j’avais au moins 1 échantillon de FL/âge par strate <span class="math inline">\(k\)</span> avant de faire ma recherche pour des échantillons?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># Échantillons de fréquences de longueur</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">n_distinct</span>(lf_caa<span class="op">$</span>sample.id) <span class="co"># 3969 échantillons de FL pour la série 1993-2020</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">## [1] 3969</span></a>
<a class="sourceLine" id="cb16-4" title="4">ajout &lt;-<span class="st"> </span>lf_caa <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="st">         </span><span class="kw">group_by</span>(year, period, region, gear) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="st">         </span><span class="kw">summarise</span>(<span class="dt">nb_samples =</span> <span class="kw">n_distinct</span>(sample.id)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="st">         </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">gear =</span> <span class="kw">as.character</span>(gear))</a>
<a class="sourceLine" id="cb16-9" title="9"></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="kw">left_join</span>(catch_caa, ajout, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;period&quot;</span>, <span class="st">&quot;region&quot;</span>, <span class="st">&quot;gear&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(nb_samples)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="st">  </span><span class="kw">nrow</span>() <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(catch_caa) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">## [1] 11.58789</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co"># 11.58 % des strates contenaient &gt;= 1 échantillon au départ.</span></a>
<a class="sourceLine" id="cb16-15" title="15"></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co"># Par année, ça ressemble à quoi?</span></a>
<a class="sourceLine" id="cb16-17" title="17">temp &lt;-<span class="st"> </span><span class="kw">left_join</span>(catch_caa, ajout, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;period&quot;</span>, <span class="st">&quot;region&quot;</span>, <span class="st">&quot;gear&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="st">        </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">n_tot =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb16-20" title="20">                  <span class="dt">n_strates =</span> <span class="kw">NROW</span>(year[<span class="op">!</span><span class="kw">is.na</span>(nb_samples)]),</a>
<a class="sourceLine" id="cb16-21" title="21">                  <span class="dt">perc =</span> n_strates <span class="op">/</span><span class="st"> </span>n_tot <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-22" title="22"><span class="st">        </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-23" title="23"><span class="st">        </span><span class="kw">arrange</span>(perc)</a>
<a class="sourceLine" id="cb16-24" title="24">temp <span class="co"># 2003 est la pire année avec 1.61 %</span></a>
<a class="sourceLine" id="cb16-25" title="25"><span class="co">## # A tibble: 28 x 4</span></a>
<a class="sourceLine" id="cb16-26" title="26"><span class="co">##     year n_tot n_strates  perc</span></a>
<a class="sourceLine" id="cb16-27" title="27"><span class="co">##    &lt;dbl&gt; &lt;int&gt;     &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb16-28" title="28"><span class="co">##  1  2003   124         2  1.61</span></a>
<a class="sourceLine" id="cb16-29" title="29"><span class="co">##  2  2020   130         4  3.08</span></a>
<a class="sourceLine" id="cb16-30" title="30"><span class="co">##  3  1994   165         7  4.24</span></a>
<a class="sourceLine" id="cb16-31" title="31"><span class="co">##  4  2019   156         9  5.77</span></a>
<a class="sourceLine" id="cb16-32" title="32"><span class="co">##  5  2011   161        11  6.83</span></a>
<a class="sourceLine" id="cb16-33" title="33"><span class="co">##  6  2016   155        11  7.10</span></a>
<a class="sourceLine" id="cb16-34" title="34"><span class="co">##  7  1998   171        13  7.60</span></a>
<a class="sourceLine" id="cb16-35" title="35"><span class="co">##  8  2002   179        14  7.82</span></a>
<a class="sourceLine" id="cb16-36" title="36"><span class="co">##  9  2009   178        15  8.43</span></a>
<a class="sourceLine" id="cb16-37" title="37"><span class="co">## 10  2006   153        13  8.50</span></a>
<a class="sourceLine" id="cb16-38" title="38"><span class="co">## # ... with 18 more rows</span></a>
<a class="sourceLine" id="cb16-39" title="39"><span class="kw">tail</span>(temp) <span class="co"># 1997 est la meilleure année avec 37.8</span></a>
<a class="sourceLine" id="cb16-40" title="40"><span class="co">## # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb16-41" title="41"><span class="co">##    year n_tot n_strates  perc</span></a>
<a class="sourceLine" id="cb16-42" title="42"><span class="co">##   &lt;dbl&gt; &lt;int&gt;     &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb16-43" title="43"><span class="co">## 1  2007   146        18  12.3</span></a>
<a class="sourceLine" id="cb16-44" title="44"><span class="co">## 2  2017   151        20  13.2</span></a>
<a class="sourceLine" id="cb16-45" title="45"><span class="co">## 3  1993   333        63  18.9</span></a>
<a class="sourceLine" id="cb16-46" title="46"><span class="co">## 4  1995    84        24  28.6</span></a>
<a class="sourceLine" id="cb16-47" title="47"><span class="co">## 5  1996   131        45  34.4</span></a>
<a class="sourceLine" id="cb16-48" title="48"><span class="co">## 6  1997   180        68  37.8</span></a>
<a class="sourceLine" id="cb16-49" title="49"><span class="kw">summary</span>(temp<span class="op">$</span>perc) <span class="co"># moyenne de 11.554</span></a>
<a class="sourceLine" id="cb16-50" title="50"><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb16-51" title="51"><span class="co">##   1.613   7.767   9.026  11.554  11.728  37.778</span></a>
<a class="sourceLine" id="cb16-52" title="52"></a>
<a class="sourceLine" id="cb16-53" title="53"><span class="co"># Échantillons de lectures d&#39;otolithes</span></a>
<a class="sourceLine" id="cb16-54" title="54"><span class="kw">n_distinct</span>(bio_caa<span class="op">$</span>sample.id) <span class="co"># 1669 échantillons d&#39;âge pour la série 1993-2020</span></a>
<a class="sourceLine" id="cb16-55" title="55"><span class="co">## [1] 1669</span></a>
<a class="sourceLine" id="cb16-56" title="56">ajout &lt;-<span class="st"> </span>bio_caa <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-57" title="57"><span class="st">         </span><span class="kw">group_by</span>(year, period, region, gear) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-58" title="58"><span class="st">         </span><span class="kw">summarise</span>(<span class="dt">nb_samples =</span> <span class="kw">n_distinct</span>(sample.id)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-59" title="59"><span class="st">         </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-60" title="60"><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">gear =</span> <span class="kw">as.character</span>(gear))</a>
<a class="sourceLine" id="cb16-61" title="61"></a>
<a class="sourceLine" id="cb16-62" title="62"><span class="kw">left_join</span>(catch_caa, ajout, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;period&quot;</span>, <span class="st">&quot;region&quot;</span>, <span class="st">&quot;gear&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-63" title="63"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(nb_samples)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-64" title="64"><span class="st">  </span><span class="kw">nrow</span>() <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(catch_caa) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb16-65" title="65"><span class="co">## [1] 9.10477</span></a>
<a class="sourceLine" id="cb16-66" title="66"><span class="co"># 9.1 % des strates contenaient &gt;= 1 échantillon au départ.</span></a>
<a class="sourceLine" id="cb16-67" title="67"></a>
<a class="sourceLine" id="cb16-68" title="68"><span class="co"># Par année, ça ressemble à quoi?</span></a>
<a class="sourceLine" id="cb16-69" title="69">temp &lt;-<span class="st"> </span><span class="kw">left_join</span>(catch_caa, ajout, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;period&quot;</span>, <span class="st">&quot;region&quot;</span>, <span class="st">&quot;gear&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-70" title="70"><span class="st">        </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-71" title="71"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">n_tot =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb16-72" title="72">                  <span class="dt">n_strates =</span> <span class="kw">NROW</span>(year[<span class="op">!</span><span class="kw">is.na</span>(nb_samples)]),</a>
<a class="sourceLine" id="cb16-73" title="73">                  <span class="dt">perc =</span> n_strates <span class="op">/</span><span class="st"> </span>n_tot <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-74" title="74"><span class="st">        </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-75" title="75"><span class="st">        </span><span class="kw">arrange</span>(perc)</a>
<a class="sourceLine" id="cb16-76" title="76">temp <span class="co"># 2003 est la pire année avec 0 %</span></a>
<a class="sourceLine" id="cb16-77" title="77"><span class="co">## # A tibble: 28 x 4</span></a>
<a class="sourceLine" id="cb16-78" title="78"><span class="co">##     year n_tot n_strates  perc</span></a>
<a class="sourceLine" id="cb16-79" title="79"><span class="co">##    &lt;dbl&gt; &lt;int&gt;     &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb16-80" title="80"><span class="co">##  1  2003   124         0  0   </span></a>
<a class="sourceLine" id="cb16-81" title="81"><span class="co">##  2  1994   165         5  3.03</span></a>
<a class="sourceLine" id="cb16-82" title="82"><span class="co">##  3  2020   130         4  3.08</span></a>
<a class="sourceLine" id="cb16-83" title="83"><span class="co">##  4  2019   156         8  5.13</span></a>
<a class="sourceLine" id="cb16-84" title="84"><span class="co">##  5  2016   155         8  5.16</span></a>
<a class="sourceLine" id="cb16-85" title="85"><span class="co">##  6  2011   161         9  5.59</span></a>
<a class="sourceLine" id="cb16-86" title="86"><span class="co">##  7  2012   153         9  5.88</span></a>
<a class="sourceLine" id="cb16-87" title="87"><span class="co">##  8  2013   158        10  6.33</span></a>
<a class="sourceLine" id="cb16-88" title="88"><span class="co">##  9  2009   178        12  6.74</span></a>
<a class="sourceLine" id="cb16-89" title="89"><span class="co">## 10  2010   172        12  6.98</span></a>
<a class="sourceLine" id="cb16-90" title="90"><span class="co">## # ... with 18 more rows</span></a>
<a class="sourceLine" id="cb16-91" title="91"><span class="kw">tail</span>(temp) <span class="co"># 2007 est la meilleure année avec 11</span></a>
<a class="sourceLine" id="cb16-92" title="92"><span class="co">## # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb16-93" title="93"><span class="co">##    year n_tot n_strates  perc</span></a>
<a class="sourceLine" id="cb16-94" title="94"><span class="co">##   &lt;dbl&gt; &lt;int&gt;     &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb16-95" title="95"><span class="co">## 1  2007   146        16  11.0</span></a>
<a class="sourceLine" id="cb16-96" title="96"><span class="co">## 2  1993   333        43  12.9</span></a>
<a class="sourceLine" id="cb16-97" title="97"><span class="co">## 3  2017   151        20  13.2</span></a>
<a class="sourceLine" id="cb16-98" title="98"><span class="co">## 4  1996   131        31  23.7</span></a>
<a class="sourceLine" id="cb16-99" title="99"><span class="co">## 5  1995    84        21  25  </span></a>
<a class="sourceLine" id="cb16-100" title="100"><span class="co">## 6  1997   180        45  25</span></a>
<a class="sourceLine" id="cb16-101" title="101"><span class="kw">summary</span>(temp<span class="op">$</span>perc) <span class="co"># moyenne de 9.164</span></a>
<a class="sourceLine" id="cb16-102" title="102"><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb16-103" title="103"><span class="co">##   0.000   6.217   7.621   9.164   9.444  25.000</span></a></code></pre></div>
</div>
<div id="figures" class="section level1">
<h1><span class="header-section-number">8</span> Figures</h1>
<div id="titres-des-axes" class="section level2">
<h2><span class="header-section-number">8.1</span> Titres des axes</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="cf">if</span> (langue <span class="op">==</span><span class="st"> &quot;fr&quot;</span>){</a>
<a class="sourceLine" id="cb17-2" title="2">  lab1 &lt;-<span class="st"> &quot;Niveau d&#39;aggrégation pour FL&quot;</span></a>
<a class="sourceLine" id="cb17-3" title="3">  lab2 &lt;-<span class="st"> &quot;Niveau d&#39;aggrégation&quot;</span></a>
<a class="sourceLine" id="cb17-4" title="4">  lab3 &lt;-<span class="st"> &quot;Nbre d&#39;échantillons de FL&quot;</span></a>
<a class="sourceLine" id="cb17-5" title="5">  lab4 &lt;-<span class="st"> &quot;Nombre d&#39;échantillons&quot;</span></a>
<a class="sourceLine" id="cb17-6" title="6">  lab5 &lt;-<span class="st"> &quot;Nbre de morues pour les FL&quot;</span></a>
<a class="sourceLine" id="cb17-7" title="7">  lab6 &lt;-<span class="st"> </span><span class="kw">expression</span>(Nbre<span class="op">~</span>de<span class="op">~</span>morues<span class="op">~</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb17-8" title="8">  lab7 &lt;-<span class="st"> &quot;Niveau d&#39;aggrégation pour l&#39;âge&quot;</span></a>
<a class="sourceLine" id="cb17-9" title="9">  lab8 &lt;-<span class="st"> &quot;Nbre d&#39;échantillons d&#39;âge&quot;</span></a>
<a class="sourceLine" id="cb17-10" title="10">  lab9 &lt;-<span class="st"> &quot;Nbre de morues âgées&quot;</span></a>
<a class="sourceLine" id="cb17-11" title="11">  lab10 &lt;-<span class="st"> &quot;Nombre de morues&quot;</span></a>
<a class="sourceLine" id="cb17-12" title="12">  lab11 &lt;-<span class="st"> &quot;Nbre de strates année-mois-région-engin&quot;</span></a>
<a class="sourceLine" id="cb17-13" title="13">  lab12 &lt;-<span class="st"> &quot;Année&quot;</span></a>
<a class="sourceLine" id="cb17-14" title="14">  lab13 &lt;-<span class="st"> </span><span class="kw">expression</span>(Débarquements<span class="op">~</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">3</span><span class="op">~</span>t))</a>
<a class="sourceLine" id="cb17-15" title="15">  lab14 &lt;-<span class="st"> &quot;Âge&quot;</span></a>
<a class="sourceLine" id="cb17-16" title="16">  lab15 &lt;-<span class="st"> &quot;Masse moyenne à l&#39;âge (kg)&quot;</span></a>
<a class="sourceLine" id="cb17-17" title="17">  lab16 &lt;-<span class="st"> &quot;Longueur moyenne à l&#39;âge (cm)&quot;</span></a>
<a class="sourceLine" id="cb17-18" title="18">  lab17 &lt;-<span class="st"> &quot;% des débarquements annuels&quot;</span></a>
<a class="sourceLine" id="cb17-19" title="19">  lab18 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Échantillons d&#39;âge&quot;</span>, <span class="st">&quot;Échantillons de FL&quot;</span>)</a>
<a class="sourceLine" id="cb17-20" title="20">} <span class="cf">else</span> <span class="cf">if</span> (langue <span class="op">==</span><span class="st"> &quot;en&quot;</span>){</a>
<a class="sourceLine" id="cb17-21" title="21">  lab1 &lt;-<span class="st"> &quot;LF aggregation level&quot;</span></a>
<a class="sourceLine" id="cb17-22" title="22">  lab2 &lt;-<span class="st"> &quot;Aggregation level&quot;</span></a>
<a class="sourceLine" id="cb17-23" title="23">  lab3 &lt;-<span class="st"> &quot;Nb of LF samples&quot;</span></a>
<a class="sourceLine" id="cb17-24" title="24">  lab4 &lt;-<span class="st"> &quot;Nb of samples&quot;</span></a>
<a class="sourceLine" id="cb17-25" title="25">  lab5 &lt;-<span class="st"> &quot;Nb of cod for LF&quot;</span></a>
<a class="sourceLine" id="cb17-26" title="26">  lab6 &lt;-<span class="st"> </span><span class="kw">expression</span>(Nb<span class="op">~</span>of<span class="op">~</span>cod<span class="op">~</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb17-27" title="27">  lab7 &lt;-<span class="st"> &quot;Age aggregation level&quot;</span></a>
<a class="sourceLine" id="cb17-28" title="28">  lab8 &lt;-<span class="st"> &quot;Nb of age samples&quot;</span></a>
<a class="sourceLine" id="cb17-29" title="29">  lab9 &lt;-<span class="st"> &quot;Nb of aged cod&quot;</span></a>
<a class="sourceLine" id="cb17-30" title="30">  lab10 &lt;-<span class="st"> &quot;Nb of cod&quot;</span></a>
<a class="sourceLine" id="cb17-31" title="31">  lab11 &lt;-<span class="st"> &quot;Nb of year-month-region-gear strata&quot;</span></a>
<a class="sourceLine" id="cb17-32" title="32">  lab12 &lt;-<span class="st"> &quot;Year&quot;</span></a>
<a class="sourceLine" id="cb17-33" title="33">  lab13 &lt;-<span class="st"> </span><span class="kw">expression</span>(Landings<span class="op">~</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">3</span><span class="op">~</span>t))</a>
<a class="sourceLine" id="cb17-34" title="34">  lab14 &lt;-<span class="st"> &quot;Age&quot;</span></a>
<a class="sourceLine" id="cb17-35" title="35">  lab15 &lt;-<span class="st"> &quot;Mean weight at age (kg)&quot;</span></a>
<a class="sourceLine" id="cb17-36" title="36">  lab16 &lt;-<span class="st"> &quot;Mean length at age (cm)&quot;</span></a>
<a class="sourceLine" id="cb17-37" title="37">  lab17 &lt;-<span class="st"> &quot;% of annual landings&quot;</span></a>
<a class="sourceLine" id="cb17-38" title="38">  lab18 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Age samples&quot;</span>, <span class="st">&quot;LF samples&quot;</span>)</a>
<a class="sourceLine" id="cb17-39" title="39">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb17-40" title="40">  lab1 &lt;-<span class="st"> &quot;Niveau d&#39;aggrégation pour FL /</span><span class="ch">\n</span><span class="st">LF aggregation level&quot;</span></a>
<a class="sourceLine" id="cb17-41" title="41">  lab2 &lt;-<span class="st"> &quot;Niveau d&#39;aggrégation / Aggregation level&quot;</span></a>
<a class="sourceLine" id="cb17-42" title="42">  lab3 &lt;-<span class="st"> &quot;Nbre d&#39;échantillons de FL /</span><span class="ch">\n</span><span class="st">Nb of LF samples&quot;</span></a>
<a class="sourceLine" id="cb17-43" title="43">  lab4 &lt;-<span class="st"> &quot;Nombre d&#39;échantillons / Nb of samples&quot;</span></a>
<a class="sourceLine" id="cb17-44" title="44">  lab5 &lt;-<span class="st"> &quot;Nbre de morues pour les FL /</span><span class="ch">\n</span><span class="st">Nb of cod for LF&quot;</span></a>
<a class="sourceLine" id="cb17-45" title="45">  lab6 &lt;-<span class="st"> </span><span class="kw">expression</span>(Nbre<span class="op">~</span>de<span class="op">~</span>morues<span class="op">~</span><span class="st">&quot;/&quot;</span><span class="op">~</span>Nb<span class="op">~</span>of<span class="op">~</span>cod<span class="op">~</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb17-46" title="46">  lab7 &lt;-<span class="st"> &quot;Niveau d&#39;aggrégation pour l&#39;âge /</span><span class="ch">\n</span><span class="st">Age aggregation level&quot;</span></a>
<a class="sourceLine" id="cb17-47" title="47">  lab8 &lt;-<span class="st"> &quot;Nbre d&#39;échantillons d&#39;âge / Nb of age samples&quot;</span></a>
<a class="sourceLine" id="cb17-48" title="48">  lab9 &lt;-<span class="st"> &quot;Nbre de morues âgées / Nb of aged cod&quot;</span></a>
<a class="sourceLine" id="cb17-49" title="49">  lab10 &lt;-<span class="st"> &quot;Nombre de morues / Nb of cod&quot;</span></a>
<a class="sourceLine" id="cb17-50" title="50">  lab11 &lt;-<span class="st"> &quot;Nbre de strates année-mois-région-engin /</span><span class="ch">\n</span><span class="st">Nb of year-month-region-gear strata&quot;</span></a>
<a class="sourceLine" id="cb17-51" title="51">  lab12 &lt;-<span class="st"> &quot;Année / Year&quot;</span></a>
<a class="sourceLine" id="cb17-52" title="52">  lab13 &lt;-<span class="st"> </span><span class="kw">expression</span>(Débarquements<span class="op">~</span><span class="st">&quot;/&quot;</span><span class="op">~</span>Landings<span class="op">~</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">3</span><span class="op">~</span>t))</a>
<a class="sourceLine" id="cb17-53" title="53">  lab14 &lt;-<span class="st"> &quot;Âge / Age&quot;</span></a>
<a class="sourceLine" id="cb17-54" title="54">  lab15 &lt;-<span class="st"> &quot;Masse moyenne à l&#39;âge / Mean weight at age (kg)&quot;</span></a>
<a class="sourceLine" id="cb17-55" title="55">  lab16 &lt;-<span class="st"> &quot;Longueur moyenne à l&#39;âge / Mean length at age (cm)&quot;</span></a>
<a class="sourceLine" id="cb17-56" title="56">  lab17 &lt;-<span class="st"> &quot;% des débarquements annuels / % of annual landings&quot;</span></a>
<a class="sourceLine" id="cb17-57" title="57">  lab18 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Échantillons d&#39;âge / Age samples&quot;</span>, <span class="st">&quot;Échantillons de FL / LF samples&quot;</span>)</a>
<a class="sourceLine" id="cb17-58" title="58"></a>
<a class="sourceLine" id="cb17-59" title="59">}</a></code></pre></div>
</div>
<div id="graph1-résumé-de-caa_all" class="section level2">
<h2><span class="header-section-number">8.2</span> <code>graph1</code> : résumé de <code>caa_all</code></h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># graph1: niveau d&#39;aggrégation LF</span></a>
<a class="sourceLine" id="cb18-2" title="2">dat1 &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">        </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">niveau =</span> <span class="kw">unique</span>(option.lengthfreq)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="st">        </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="st">        </span><span class="kw">group_by</span>(niveau) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="st">        </span>count <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="st">        </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="st">        </span><span class="kw">full_join</span>(., <span class="kw">tibble</span>(<span class="dt">niveau =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">by =</span> <span class="st">&quot;niveau&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(n), <span class="dv">0</span>, n),</a>
<a class="sourceLine" id="cb18-11" title="11">               <span class="dt">lab =</span> lab1,</a>
<a class="sourceLine" id="cb18-12" title="12">               <span class="dt">niveau =</span> <span class="kw">factor</span>(niveau, <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">ordered =</span> T),</a>
<a class="sourceLine" id="cb18-13" title="13">               <span class="dt">n_lab =</span> <span class="kw">format</span>(n, <span class="dt">big.mark =</span> bm) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, .))</a>
<a class="sourceLine" id="cb18-14" title="14"></a>
<a class="sourceLine" id="cb18-15" title="15">grapha &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat1, <span class="kw">aes</span>(<span class="dt">x =</span> niveau, <span class="dt">y =</span> n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="st">          </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>lab) <span class="op">+</span><span class="st"> </span><span class="co"># pour rajouter un titre</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab2, <span class="dt">y =</span> lab11) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(dat1<span class="op">$</span>n) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="st">          </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> n, <span class="dt">label =</span> n_lab, <span class="dt">vjust =</span> <span class="fl">-0.3</span>), <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>)     </a>
<a class="sourceLine" id="cb18-21" title="21"></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="co"># graph2: nbre d&#39;échantillons pour LF</span></a>
<a class="sourceLine" id="cb18-23" title="23">dat2 &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-24" title="24"><span class="st">        </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">unique</span>(nsample.lengthfreq),</a>
<a class="sourceLine" id="cb18-26" title="26">                  <span class="dt">lab =</span> lab3) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="st">        </span>ungroup</a>
<a class="sourceLine" id="cb18-28" title="28"></a>
<a class="sourceLine" id="cb18-29" title="29">dat2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-30" title="30"><span class="st">  </span><span class="kw">group_by</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-31" title="31"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_strata =</span> <span class="kw">n_distinct</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-32" title="32"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-33" title="33"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> n_strata <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(dat2) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb18-34" title="34">         <span class="dt">perccum =</span> <span class="kw">cumsum</span>(perc)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-35" title="35"><span class="st">  </span><span class="kw">filter</span>(perccum <span class="op">&lt;=</span><span class="st"> </span><span class="dv">95</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-36" title="36"><span class="st">  </span><span class="kw">pull</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-37" title="37"><span class="st">  </span>max</a>
<a class="sourceLine" id="cb18-38" title="38"><span class="co">## [1] 42</span></a>
<a class="sourceLine" id="cb18-39" title="39"><span class="co"># 42 Je vais mettre ma cassure de l&#39;axe des x à 50</span></a>
<a class="sourceLine" id="cb18-40" title="40">max_x &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb18-41" title="41"></a>
<a class="sourceLine" id="cb18-42" title="42">brks_x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, max_x, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb18-43" title="43">labs_x &lt;-<span class="st"> </span>brks_x</a>
<a class="sourceLine" id="cb18-44" title="44">labs_x[labs_x <span class="op">%%</span><span class="st"> </span><span class="dv">10</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb18-45" title="45"></a>
<a class="sourceLine" id="cb18-46" title="46">graphb &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(nb <span class="op">&lt;=</span><span class="st"> </span>max_x), <span class="kw">aes</span>(<span class="dt">x =</span> nb)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-47" title="47"><span class="st">          </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-48" title="48"><span class="st">          </span><span class="co"># bins de 1 échantillon, centrées</span></a>
<a class="sourceLine" id="cb18-49" title="49"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>lab) <span class="op">+</span><span class="st"> </span><span class="co"># pour rajouter un titre</span></a>
<a class="sourceLine" id="cb18-50" title="50"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab4, <span class="dt">y =</span> lab11) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-51" title="51"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> brks_x, <span class="dt">labels =</span> labs_x, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, max_x))</a>
<a class="sourceLine" id="cb18-52" title="52"></a>
<a class="sourceLine" id="cb18-53" title="53"><span class="co"># graph3: nbre de morues pour LF</span></a>
<a class="sourceLine" id="cb18-54" title="54">dat3 &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-55" title="55"><span class="st">        </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-56" title="56"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">sum</span>(n.lf) <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>, <span class="co"># en milliers</span></a>
<a class="sourceLine" id="cb18-57" title="57">                  <span class="dt">lab =</span> lab5) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-58" title="58"><span class="st">        </span>ungroup</a>
<a class="sourceLine" id="cb18-59" title="59"></a>
<a class="sourceLine" id="cb18-60" title="60">dat3 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-61" title="61"><span class="st">  </span><span class="kw">group_by</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-62" title="62"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_strata =</span> <span class="kw">n_distinct</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-63" title="63"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-64" title="64"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> n_strata <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(dat2) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb18-65" title="65">         <span class="dt">perccum =</span> <span class="kw">cumsum</span>(perc)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-66" title="66"><span class="st">  </span><span class="kw">filter</span>(perccum <span class="op">&lt;=</span><span class="st"> </span><span class="dv">95</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-67" title="67"><span class="st">  </span><span class="kw">pull</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-68" title="68"><span class="st">  </span>max</a>
<a class="sourceLine" id="cb18-69" title="69"><span class="co">## [1] 6.132</span></a>
<a class="sourceLine" id="cb18-70" title="70"><span class="co"># 6.132 </span></a>
<a class="sourceLine" id="cb18-71" title="71">max_x &lt;-<span class="st"> </span><span class="fl">6.5</span></a>
<a class="sourceLine" id="cb18-72" title="72"></a>
<a class="sourceLine" id="cb18-73" title="73">brks_x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, max_x, <span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb18-74" title="74">labs_x &lt;-<span class="st"> </span>brks_x</a>
<a class="sourceLine" id="cb18-75" title="75">labs_x[labs_x <span class="op">%%</span><span class="st"> </span><span class="dv">1</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb18-76" title="76"></a>
<a class="sourceLine" id="cb18-77" title="77">graphc &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat3 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(nb <span class="op">&lt;=</span><span class="st"> </span>max_x), <span class="kw">aes</span>(<span class="dt">x =</span> nb)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-78" title="78"><span class="st">          </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.250</span>, <span class="dt">center =</span> <span class="fl">0.125</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-79" title="79"><span class="st">          </span><span class="co"># bins de 250 morues, centrées</span></a>
<a class="sourceLine" id="cb18-80" title="80"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>lab) <span class="op">+</span><span class="st"> </span><span class="co"># pour rajouter un titre</span></a>
<a class="sourceLine" id="cb18-81" title="81"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab6, <span class="dt">y =</span> lab11) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-82" title="82"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> brks_x, <span class="dt">labels =</span> labs_x, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, max_x))</a>
<a class="sourceLine" id="cb18-83" title="83"></a>
<a class="sourceLine" id="cb18-84" title="84"><span class="co"># graph4: niveau d&#39;aggrégation âge</span></a>
<a class="sourceLine" id="cb18-85" title="85">dat4 &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-86" title="86"><span class="st">        </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-87" title="87"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">niveau =</span> <span class="kw">unique</span>(option.agelength)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-88" title="88"><span class="st">        </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-89" title="89"><span class="st">        </span><span class="kw">group_by</span>(niveau) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-90" title="90"><span class="st">        </span>count <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-91" title="91"><span class="st">        </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-92" title="92"><span class="st">        </span><span class="kw">full_join</span>(., <span class="kw">tibble</span>(<span class="dt">niveau =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">by =</span> <span class="st">&quot;niveau&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-93" title="93"><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(n), <span class="dv">0</span>, n),</a>
<a class="sourceLine" id="cb18-94" title="94">               <span class="dt">lab =</span> lab7,</a>
<a class="sourceLine" id="cb18-95" title="95">               <span class="dt">niveau =</span> <span class="kw">factor</span>(niveau, <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">ordered =</span> T),</a>
<a class="sourceLine" id="cb18-96" title="96">               <span class="dt">n_lab =</span> <span class="kw">format</span>(n, <span class="dt">big.mark =</span> bm) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, .))</a>
<a class="sourceLine" id="cb18-97" title="97"></a>
<a class="sourceLine" id="cb18-98" title="98"></a>
<a class="sourceLine" id="cb18-99" title="99">graphd &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat4, <span class="kw">aes</span>(<span class="dt">x =</span> niveau, <span class="dt">y =</span> n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-100" title="100"><span class="st">          </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-101" title="101"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>lab) <span class="op">+</span><span class="st"> </span><span class="co"># pour rajouter un titre</span></a>
<a class="sourceLine" id="cb18-102" title="102"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab2, <span class="dt">y =</span> lab11) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-103" title="103"><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(dat4<span class="op">$</span>n) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-104" title="104"><span class="st">          </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> n, <span class="dt">label =</span> n_lab, <span class="dt">vjust =</span> <span class="fl">-0.3</span>), <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>)     </a>
<a class="sourceLine" id="cb18-105" title="105"></a>
<a class="sourceLine" id="cb18-106" title="106"><span class="co"># graph5: nbre d&#39;échantillons pour l&#39;âge</span></a>
<a class="sourceLine" id="cb18-107" title="107">dat5 &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-108" title="108"><span class="st">        </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-109" title="109"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">unique</span>(nsample.agelength),</a>
<a class="sourceLine" id="cb18-110" title="110">                  <span class="dt">lab =</span> lab8) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-111" title="111"><span class="st">        </span>ungroup</a>
<a class="sourceLine" id="cb18-112" title="112"></a>
<a class="sourceLine" id="cb18-113" title="113">dat5 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-114" title="114"><span class="st">  </span><span class="kw">group_by</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-115" title="115"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_strata =</span> <span class="kw">n_distinct</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-116" title="116"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-117" title="117"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> n_strata <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(dat2) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb18-118" title="118">         <span class="dt">perccum =</span> <span class="kw">cumsum</span>(perc)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-119" title="119"><span class="st">  </span><span class="kw">filter</span>(perccum <span class="op">&lt;=</span><span class="st"> </span><span class="dv">95</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-120" title="120"><span class="st">  </span><span class="kw">pull</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-121" title="121"><span class="st">  </span>max</a>
<a class="sourceLine" id="cb18-122" title="122"><span class="co">## [1] 76</span></a>
<a class="sourceLine" id="cb18-123" title="123"><span class="co"># 76 Je vais mettre ma cassure de l&#39;axe des x à 80</span></a>
<a class="sourceLine" id="cb18-124" title="124">max_x &lt;-<span class="st"> </span><span class="dv">80</span></a>
<a class="sourceLine" id="cb18-125" title="125"></a>
<a class="sourceLine" id="cb18-126" title="126">brks_x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, max_x, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb18-127" title="127">labs_x &lt;-<span class="st"> </span>brks_x</a>
<a class="sourceLine" id="cb18-128" title="128">labs_x[labs_x <span class="op">%%</span><span class="st"> </span><span class="dv">10</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb18-129" title="129"></a>
<a class="sourceLine" id="cb18-130" title="130">graphe &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat5 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(nb <span class="op">&lt;=</span><span class="st"> </span>max_x), <span class="kw">aes</span>(<span class="dt">x =</span> nb)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-131" title="131"><span class="st">          </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">center =</span> <span class="fl">2.5</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-132" title="132"><span class="st">          </span><span class="co"># bins de 1 échantillon, centrées</span></a>
<a class="sourceLine" id="cb18-133" title="133"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>lab) <span class="op">+</span><span class="st"> </span><span class="co"># pour rajouter un titre</span></a>
<a class="sourceLine" id="cb18-134" title="134"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab4, <span class="dt">y =</span> lab11) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-135" title="135"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> brks_x, <span class="dt">labels =</span> labs_x, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, max_x))</a>
<a class="sourceLine" id="cb18-136" title="136"></a>
<a class="sourceLine" id="cb18-137" title="137"><span class="co"># graph6: nbre de morues pour l&#39;âge</span></a>
<a class="sourceLine" id="cb18-138" title="138">dat6 &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-139" title="139"><span class="st">        </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-140" title="140"><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">unique</span>(n.altot),</a>
<a class="sourceLine" id="cb18-141" title="141">                  <span class="dt">lab =</span> lab9) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-142" title="142"><span class="st">        </span>ungroup</a>
<a class="sourceLine" id="cb18-143" title="143"></a>
<a class="sourceLine" id="cb18-144" title="144">dat6 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-145" title="145"><span class="st">  </span><span class="kw">group_by</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-146" title="146"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_strata =</span> <span class="kw">n_distinct</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-147" title="147"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-148" title="148"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> n_strata <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(dat2) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb18-149" title="149">         <span class="dt">perccum =</span> <span class="kw">cumsum</span>(perc)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-150" title="150"><span class="st">  </span><span class="kw">filter</span>(perccum <span class="op">&lt;=</span><span class="st"> </span><span class="dv">95</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-151" title="151"><span class="st">  </span><span class="kw">pull</span>(nb) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-152" title="152"><span class="st">  </span>max</a>
<a class="sourceLine" id="cb18-153" title="153"><span class="co">## [1] 1119</span></a>
<a class="sourceLine" id="cb18-154" title="154"><span class="co"># 1119 </span></a>
<a class="sourceLine" id="cb18-155" title="155">max_x &lt;-<span class="st"> </span><span class="dv">1200</span></a>
<a class="sourceLine" id="cb18-156" title="156"></a>
<a class="sourceLine" id="cb18-157" title="157">brks_x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, max_x, <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb18-158" title="158">labs_x &lt;-<span class="st"> </span>brks_x</a>
<a class="sourceLine" id="cb18-159" title="159">labs_x[labs_x <span class="op">%%</span><span class="st"> </span><span class="dv">1</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb18-160" title="160"></a>
<a class="sourceLine" id="cb18-161" title="161">graphf &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat6 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(nb <span class="op">&lt;=</span><span class="st"> </span>max_x), <span class="kw">aes</span>(<span class="dt">x =</span> nb)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-162" title="162"><span class="st">          </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">100</span>, <span class="dt">center =</span> <span class="dv">50</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-163" title="163"><span class="st">          </span><span class="co"># bins de 200 morues, centrées</span></a>
<a class="sourceLine" id="cb18-164" title="164"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>lab) <span class="op">+</span><span class="st"> </span><span class="co"># pour rajouter un titre</span></a>
<a class="sourceLine" id="cb18-165" title="165"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab10, <span class="dt">y =</span> lab11) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-166" title="166"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> brks_x, <span class="dt">labels =</span> labs_x, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, max_x))</a>
<a class="sourceLine" id="cb18-167" title="167"></a>
<a class="sourceLine" id="cb18-168" title="168"><span class="kw">save</span>(grapha, graphb, graphc, graphd, graphe, graphf, <span class="dt">file =</span> <span class="kw">paste0</span>(result, <span class="st">&quot;03_graphs_catchR_presentation_&quot;</span>, langue, <span class="st">&quot;.Rda&quot;</span>))</a>
<a class="sourceLine" id="cb18-169" title="169"></a>
<a class="sourceLine" id="cb18-170" title="170">combi &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(grapha <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="ot">NULL</span>), </a>
<a class="sourceLine" id="cb18-171" title="171">                   graphb <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="ot">NULL</span>), </a>
<a class="sourceLine" id="cb18-172" title="172">                   graphc <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="ot">NULL</span>), </a>
<a class="sourceLine" id="cb18-173" title="173">                   graphd <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="ot">NULL</span>), </a>
<a class="sourceLine" id="cb18-174" title="174">                   graphe <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="ot">NULL</span>), </a>
<a class="sourceLine" id="cb18-175" title="175">                   graphf <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="ot">NULL</span>), </a>
<a class="sourceLine" id="cb18-176" title="176">                   <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> F, <span class="dt">labels =</span> <span class="st">&quot;AUTO&quot;</span>)</a>
<a class="sourceLine" id="cb18-177" title="177">y_title &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">draw_label</span>(<span class="dt">label =</span> lab11, <span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">angle =</span> <span class="dv">90</span>)</a>
<a class="sourceLine" id="cb18-178" title="178"></a>
<a class="sourceLine" id="cb18-179" title="179"><span class="co"># https://stackoverflow.com/questions/37052059/how-to-add-a-title-for-a-grid-layout-figure-in-ggplot2</span></a>
<a class="sourceLine" id="cb18-180" title="180">graph1 &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(y_title, combi, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="dv">1</span>)) <span class="co"># rel_heights values control title margins</span></a>
<a class="sourceLine" id="cb18-181" title="181">graph1</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-18-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">rm</span>(dat1, dat2, dat3, dat4, dat5, dat6, grapha, graphb, graphc, graphd, graphe, graphf, combi, y_title)</a></code></pre></div>
</div>
<div id="graph2-aggrégation-fl" class="section level2">
<h2><span class="header-section-number">8.3</span> <code>graph2</code>: aggrégation FL</h2>
<p>Je le fais pour montrer 6 années d’intérêt:</p>
<ul>
<li>1993: une année avec beaucoup d’échantillonnage</li>
<li>1995: moratoire</li>
<li>2003: moratoire</li>
<li>2018-2010: les 3 dernières années</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">ans &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1993</span>, <span class="dv">1995</span>, <span class="dv">2003</span>, <span class="dv">2018</span><span class="op">:</span><span class="dv">2020</span>)</a>
<a class="sourceLine" id="cb20-2" title="2">dat &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="st">       </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span>ans) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="st">       </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="st">       </span><span class="kw">summarise</span>(<span class="dt">niveau =</span> <span class="kw">unique</span>(option.lengthfreq),</a>
<a class="sourceLine" id="cb20-6" title="6">                 <span class="dt">annee =</span> <span class="kw">unique</span>(year)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="st">       </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="st">       </span><span class="kw">group_by</span>(annee, niveau) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="st">       </span>count <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="st">       </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="st">       </span><span class="kw">full_join</span>(., <span class="kw">expand.grid</span>(<span class="dt">annee =</span> ans, <span class="dt">niveau =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;niveau&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="st">       </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(n), <span class="dv">0</span>, n),</a>
<a class="sourceLine" id="cb20-13" title="13">              <span class="dt">niveau =</span> <span class="kw">factor</span>(niveau, <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">ordered =</span> T),</a>
<a class="sourceLine" id="cb20-14" title="14">              <span class="dt">n_lab =</span> <span class="kw">format</span>(n, <span class="dt">big.mark =</span> bm) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, .))</a>
<a class="sourceLine" id="cb20-15" title="15"></a>
<a class="sourceLine" id="cb20-16" title="16"></a>
<a class="sourceLine" id="cb20-17" title="17">graph2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> niveau, <span class="dt">y =</span> n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-18" title="18"><span class="st">          </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-19" title="19"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>annee) <span class="op">+</span><span class="st"> </span><span class="co"># pour rajouter un titre</span></a>
<a class="sourceLine" id="cb20-20" title="20"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab2, <span class="dt">y =</span> lab11) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-21" title="21"><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.spacing =</span> <span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&quot;lines&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-22" title="22"><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(dat<span class="op">$</span>n) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-23" title="23"><span class="st">          </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> n, <span class="dt">label =</span> n_lab, <span class="dt">vjust =</span> <span class="fl">-0.3</span>), <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>)     </a>
<a class="sourceLine" id="cb20-24" title="24"></a>
<a class="sourceLine" id="cb20-25" title="25">graph2</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-19-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">rm</span>(dat)</a></code></pre></div>
</div>
<div id="graph3-aggrégation-âge" class="section level2">
<h2><span class="header-section-number">8.4</span> <code>graph3</code>: aggrégation âge</h2>
<p>Je le fais seulement pour les 6 années d’intérêt</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">dat &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="st">       </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span>ans) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="st">       </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="st">       </span><span class="kw">summarise</span>(<span class="dt">niveau =</span> <span class="kw">unique</span>(option.agelength),</a>
<a class="sourceLine" id="cb22-5" title="5">                 <span class="dt">annee =</span> <span class="kw">unique</span>(year)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="st">       </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="st">       </span><span class="kw">group_by</span>(annee, niveau) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="st">       </span>count <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="st">       </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="st">       </span><span class="kw">full_join</span>(., <span class="kw">expand.grid</span>(<span class="dt">annee =</span> ans, <span class="dt">niveau =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;niveau&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="st">       </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(n), <span class="dv">0</span>, n),</a>
<a class="sourceLine" id="cb22-12" title="12">              <span class="dt">niveau =</span> <span class="kw">factor</span>(niveau, <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">ordered =</span> T),</a>
<a class="sourceLine" id="cb22-13" title="13">              <span class="dt">n_lab =</span> <span class="kw">format</span>(n, <span class="dt">big.mark =</span> bm) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, .))</a>
<a class="sourceLine" id="cb22-14" title="14"></a>
<a class="sourceLine" id="cb22-15" title="15">graph3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat, <span class="kw">aes</span>(<span class="dt">x =</span> niveau, <span class="dt">y =</span> n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-16" title="16"><span class="st">          </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-17" title="17"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>annee) <span class="op">+</span><span class="st"> </span><span class="co"># pour rajouter un titre</span></a>
<a class="sourceLine" id="cb22-18" title="18"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab2, <span class="dt">y =</span> lab11) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-19" title="19"><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.spacing =</span> <span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&quot;lines&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-20" title="20"><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(dat<span class="op">$</span>n) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-21" title="21"><span class="st">          </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> n, <span class="dt">label =</span> n_lab, <span class="dt">vjust =</span> <span class="fl">-0.3</span>), <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>)     </a>
<a class="sourceLine" id="cb22-22" title="22"></a>
<a class="sourceLine" id="cb22-23" title="23">graph3</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-20-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">rm</span>(dat)</a></code></pre></div>
</div>
<div id="graph5-concordance-avec-déb." class="section level2">
<h2><span class="header-section-number">8.5</span> <code>graph5</code>: concordance avec déb.</h2>
<p>Je vérifie que la somme des captures à l’âge annuelles totalisent bien les débarquements totaux calculés d’après <code>catch_caa</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">tot &lt;-<span class="st"> </span>catch_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">catch =</span> <span class="kw">sum</span>(catch)) <span class="op">%&gt;%</span><span class="st"> </span>ungroup</a>
<a class="sourceLine" id="cb24-2" title="2"></a>
<a class="sourceLine" id="cb24-3" title="3">ages &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(caa<span class="op">$</span>avec_plus<span class="op">$</span>age)); ages </a>
<a class="sourceLine" id="cb24-4" title="4"><span class="co">##  [1] &quot;0&quot;   &quot;1&quot;   &quot;10&quot;  &quot;11&quot;  &quot;12&quot;  &quot;13+&quot; &quot;2&quot;   &quot;3&quot;   &quot;4&quot;   &quot;5&quot;   &quot;6&quot;   &quot;7&quot;  </span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="co">## [13] &quot;8&quot;   &quot;9&quot;</span></a>
<a class="sourceLine" id="cb24-6" title="6">caa<span class="op">$</span>avec_plus<span class="op">$</span>age &lt;-<span class="st"> </span><span class="kw">factor</span>(caa<span class="op">$</span>avec_plus<span class="op">$</span>age, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">12</span>, <span class="st">&quot;13+&quot;</span>), <span class="dt">ordered =</span> T)</a>
<a class="sourceLine" id="cb24-7" title="7"></a>
<a class="sourceLine" id="cb24-8" title="8">brks_x &lt;-<span class="st"> </span>(<span class="kw">min</span>(my_year)<span class="op">-</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">max</span>(my_year) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-9" title="9">labs_x &lt;-<span class="st"> </span>brks_x</a>
<a class="sourceLine" id="cb24-10" title="10">labs_x[labs_x <span class="op">%%</span><span class="st"> </span><span class="dv">5</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb24-11" title="11"></a>
<a class="sourceLine" id="cb24-12" title="12">qual_col_pals &lt;-<span class="st"> </span>brewer.pal.info <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(category <span class="op">==</span><span class="st"> &quot;qual&quot;</span>, colorblind <span class="op">==</span><span class="st"> </span>T)</a>
<a class="sourceLine" id="cb24-13" title="13">col_vector &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">mapply</span>(brewer.pal, qual_col_pals<span class="op">$</span>maxcolors, <span class="kw">rownames</span>(qual_col_pals)))</a>
<a class="sourceLine" id="cb24-14" title="14">cols &lt;-<span class="st"> </span>col_vector[<span class="dv">1</span><span class="op">:</span><span class="kw">n_distinct</span>(caa<span class="op">$</span>avec_plus<span class="op">$</span>age)]; cols</a>
<a class="sourceLine" id="cb24-15" title="15"><span class="co">##  [1] &quot;#1B9E77&quot; &quot;#D95F02&quot; &quot;#7570B3&quot; &quot;#E7298A&quot; &quot;#66A61E&quot; &quot;#E6AB02&quot; &quot;#A6761D&quot;</span></a>
<a class="sourceLine" id="cb24-16" title="16"><span class="co">##  [8] &quot;#666666&quot; &quot;#A6CEE3&quot; &quot;#1F78B4&quot; &quot;#B2DF8A&quot; &quot;#33A02C&quot; &quot;#FB9A99&quot; &quot;#E31A1C&quot;</span></a>
<a class="sourceLine" id="cb24-17" title="17"><span class="kw">max</span>(tot<span class="op">$</span>catch) <span class="op">/</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span> <span class="co"># je vais mettre la limite supérieure à 20</span></a>
<a class="sourceLine" id="cb24-18" title="18"><span class="co">## [1] 18.45181</span></a>
<a class="sourceLine" id="cb24-19" title="19"></a>
<a class="sourceLine" id="cb24-20" title="20">graph4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-21" title="21"><span class="st">          </span><span class="kw">geom_bar</span>(<span class="dt">data =</span> caa<span class="op">$</span>avec_plus, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> caaw <span class="op">/</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, <span class="dt">fill =</span> age), <span class="co"># déb. en milliers de tonnes</span></a>
<a class="sourceLine" id="cb24-22" title="22">                   <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-23" title="23"><span class="st">          </span><span class="kw">geom_point</span>(<span class="dt">data =</span> tot, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> catch <span class="op">/</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)) <span class="op">+</span><span class="st">  </span><span class="co"># débarquement en milliers de tonnes</span></a>
<a class="sourceLine" id="cb24-24" title="24"><span class="st">          </span><span class="kw">geom_line</span>(<span class="dt">data =</span> tot, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> catch<span class="op">/</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># débarquement en milliers de tonnes</span></a>
<a class="sourceLine" id="cb24-25" title="25"><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-26" title="26"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> brks_x, <span class="dt">labels =</span> labs_x, <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-27" title="27"><span class="st">          </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> cols) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-28" title="28"><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb24-29" title="29">                <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-30" title="30"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab12, <span class="dt">y =</span> lab13, <span class="dt">fill =</span> lab14)</a>
<a class="sourceLine" id="cb24-31" title="31"></a>
<a class="sourceLine" id="cb24-32" title="32">graph4</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-21-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"></a>
<a class="sourceLine" id="cb25-2" title="2">caa<span class="op">$</span>avec_plus <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">caaw =</span> <span class="kw">sum</span>(caaw)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="st">  </span><span class="kw">left_join</span>(., tot, <span class="dt">by =</span> <span class="st">&quot;year&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff =</span> <span class="kw">abs</span>(caaw <span class="op">-</span><span class="st"> </span>catch) <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="st">  </span><span class="kw">pull</span>(diff) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co">##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="co">## 3.551e-05 1.021e-03 4.226e-03 8.909e-03 9.567e-03 8.791e-02</span></a></code></pre></div>
<p>Il existe des différences minimes (moy = 0.01, min = &lt; 0.001, max = 0.1 t) entre les valeurs reportées dans les données ZIFF et ce que je calcule avec <code>catchR</code>.</p>
</div>
<div id="graph5-overlinepds-à-lâge" class="section level2">
<h2><span class="header-section-number">8.6</span> <code>graph5</code>: <span class="math inline">\(\overline{pds}\)</span> à l’âge</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">unique</span>(caa<span class="op">$</span>sans_plus<span class="op">$</span>age) <span class="co"># seulement les âges 3 à 13 sont montrées dans les figures suivantes.</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co">##  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co"># caa$sans_plus %&gt;% filter(age %in% 0:2)</span></a>
<a class="sourceLine" id="cb26-4" title="4"></a>
<a class="sourceLine" id="cb26-5" title="5">dat_graph &lt;-<span class="st"> </span>caa<span class="op">$</span>sans_plus <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(age <span class="op">%in%</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">13</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">age =</span> <span class="kw">factor</span>(age, <span class="dt">levels =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">13</span>)) </a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co"># je ne montre que certaines longueurs</span></a>
<a class="sourceLine" id="cb26-7" title="7"></a>
<a class="sourceLine" id="cb26-8" title="8">graph5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_graph, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> waa, <span class="dt">group =</span> age, <span class="dt">color =</span> age)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="st">          </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="st">          </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="st">          </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> cols) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab12, <span class="dt">y =</span> lab15, <span class="dt">color =</span> lab14) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> brks_x, <span class="dt">labels =</span> labs_x, <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb26-14" title="14">graph5</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-22-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="graph6-overlinelongueur-à-lâge" class="section level2">
<h2><span class="header-section-number">8.7</span> <code>graph6</code>: <span class="math inline">\(\overline{longueur}\)</span> à l’âge</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">graph6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dat_graph, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> laa, <span class="dt">group =</span> age, <span class="dt">color =</span> age)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">          </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">          </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">          </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> cols) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab12, <span class="dt">y =</span> lab16, <span class="dt">color =</span> lab14) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> brks_x, <span class="dt">labels =</span> labs_x, <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb27-7" title="7">graph6</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-23-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="graph7-sum-des-débarquements-sim-niveau-daggrégation" class="section level2">
<h2><span class="header-section-number">8.8</span> <code>graph7</code>: <span class="math inline">\(\sum\)</span> des débarquements <span class="math inline">\(\sim\)</span> niveau d’aggrégation</h2>
<p>Cette figure est une suggestion d’Hugo Bourdages.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">a &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="st">     </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">     </span><span class="kw">summarise_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;catch&quot;</span>, <span class="st">&quot;option.agelength&quot;</span>), <span class="dt">.funs =</span> unique) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="st">     </span><span class="kw">group_by</span>(year, option.agelength) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="st">     </span><span class="kw">summarise</span>(<span class="dt">catch =</span> <span class="kw">sum</span>(catch, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="st">     </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="st">     </span><span class="kw">mutate</span>(<span class="dt">perc =</span> (catch <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(catch)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb28-8" title="8">            <span class="dt">option =</span> option.agelength,</a>
<a class="sourceLine" id="cb28-9" title="9">            <span class="dt">type =</span> lab18[<span class="dv">1</span>]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="st">     </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="st">     </span><span class="kw">select</span>(year, option, perc, type)</a>
<a class="sourceLine" id="cb28-12" title="12"></a>
<a class="sourceLine" id="cb28-13" title="13">b &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="st">     </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-15" title="15"><span class="st">     </span><span class="kw">summarise_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;catch&quot;</span>, <span class="st">&quot;option.lengthfreq&quot;</span>), <span class="dt">.funs =</span> unique) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="st">     </span><span class="kw">group_by</span>(year, option.lengthfreq) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-17" title="17"><span class="st">     </span><span class="kw">summarise</span>(<span class="dt">catch =</span> <span class="kw">sum</span>(catch, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-18" title="18"><span class="st">     </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-19" title="19"><span class="st">     </span><span class="kw">mutate</span>(<span class="dt">perc =</span> (catch <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(catch)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb28-20" title="20">            <span class="dt">option =</span> option.lengthfreq,</a>
<a class="sourceLine" id="cb28-21" title="21">            <span class="dt">type =</span> lab18[<span class="dv">2</span>]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-22" title="22"><span class="st">     </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-23" title="23"><span class="st">     </span><span class="co">#filter(year == 1994)</span></a>
<a class="sourceLine" id="cb28-24" title="24"><span class="st">     </span><span class="kw">select</span>(year, option, perc, type)</a>
<a class="sourceLine" id="cb28-25" title="25"></a>
<a class="sourceLine" id="cb28-26" title="26">dat_graph &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(a,b) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">option =</span> <span class="kw">factor</span>(option, <span class="dt">levels =</span> <span class="dv">12</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">ordered =</span> T))</a>
<a class="sourceLine" id="cb28-27" title="27"><span class="kw">rm</span>(a,b)</a>
<a class="sourceLine" id="cb28-28" title="28"></a>
<a class="sourceLine" id="cb28-29" title="29">brks_x &lt;-<span class="st"> </span><span class="dv">1993</span><span class="op">:</span><span class="dv">2020</span></a>
<a class="sourceLine" id="cb28-30" title="30">labs_x &lt;-<span class="st"> </span>brks_x</a>
<a class="sourceLine" id="cb28-31" title="31">labs_x[labs_x <span class="op">%%</span><span class="st"> </span><span class="dv">5</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb28-32" title="32"></a>
<a class="sourceLine" id="cb28-33" title="33">graph7 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_graph, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> perc, <span class="dt">fill =</span> option)) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-34" title="34"><span class="st">          </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-35" title="35"><span class="st">          </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>type, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-36" title="36"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> brks_x, <span class="dt">labels =</span> labs_x, <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-37" title="37"><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-38" title="38"><span class="st">          </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Paired&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-39" title="39"><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.spacing =</span> <span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&quot;lines&quot;</span>),</a>
<a class="sourceLine" id="cb28-40" title="40">                <span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb28-41" title="41">                <span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-42" title="42"><span class="st">          </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">reverse =</span> T)) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-43" title="43"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab12, <span class="dt">y =</span> lab17, <span class="dt">fill =</span> lab2)</a>
<a class="sourceLine" id="cb28-44" title="44">graph7              </a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-24-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="graph8-vue-des-données-de-fl-et-dâge-disponibles" class="section level2">
<h2><span class="header-section-number">8.9</span> <code>graph8</code>: vue des données de FL et d’âge disponibles</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># grapha</span></a>
<a class="sourceLine" id="cb29-2" title="2"></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="cf">if</span> (langue <span class="op">==</span><span class="st"> &quot;fr&quot;</span>){</a>
<a class="sourceLine" id="cb29-4" title="4">  lab1 &lt;-<span class="st"> &quot;Année&quot;</span></a>
<a class="sourceLine" id="cb29-5" title="5">  lab2 &lt;-<span class="st"> &quot;Longueur (cm)&quot;</span></a>
<a class="sourceLine" id="cb29-6" title="6">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb29-7" title="7">  lab1 &lt;-<span class="st"> &quot;Year&quot;</span></a>
<a class="sourceLine" id="cb29-8" title="8">  lab2 &lt;-<span class="st"> &quot;Length (cm)&quot;</span></a>
<a class="sourceLine" id="cb29-9" title="9">}</a>
<a class="sourceLine" id="cb29-10" title="10"></a>
<a class="sourceLine" id="cb29-11" title="11">lf_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(source <span class="op">==</span><span class="st"> &quot;quai&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(length) <span class="op">%&gt;%</span><span class="st"> </span>range</a>
<a class="sourceLine" id="cb29-12" title="12"><span class="co">## [1]  11 148</span></a>
<a class="sourceLine" id="cb29-13" title="13">brks_y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">150</span>, <span class="dt">by =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb29-14" title="14">labs_y &lt;-<span class="st"> </span>brks_y</a>
<a class="sourceLine" id="cb29-15" title="15">labs_y[labs_y <span class="op">%%</span><span class="st"> </span><span class="dv">25</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb29-16" title="16"></a>
<a class="sourceLine" id="cb29-17" title="17"><span class="co"># Nbre de morues âgées</span></a>
<a class="sourceLine" id="cb29-18" title="18">nb &lt;-<span class="st"> </span>lf_caa <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-19" title="19"><span class="st">      </span><span class="kw">filter</span>(source <span class="op">==</span><span class="st"> &quot;quai&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># les données des observateurs ne sont pas montrées</span></a>
<a class="sourceLine" id="cb29-20" title="20"><span class="st">      </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-21" title="21"><span class="st">      </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-22" title="22"><span class="st">      </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-23" title="23"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">lab =</span> <span class="kw">format</span>(n, <span class="dt">big.mark =</span> bm, <span class="dt">trim =</span> T),</a>
<a class="sourceLine" id="cb29-24" title="24">             <span class="dt">vjust =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.8</span>, <span class="fl">-1.8</span>), <span class="kw">length</span>(<span class="dv">1993</span><span class="op">:</span><span class="dv">2020</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb29-25" title="25"></a>
<a class="sourceLine" id="cb29-26" title="26">grapha &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> lf_caa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(source <span class="op">==</span><span class="st"> &quot;quai&quot;</span>), <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> length, <span class="dt">group =</span> year)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-27" title="27"><span class="st">          </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb29-28" title="28"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab1, <span class="dt">y =</span> lab2) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-29" title="29"><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">150</span>), <span class="dt">breaks =</span> brks_y, <span class="dt">labels =</span> labs_y, <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-30" title="30"><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1992</span>, <span class="dv">2021</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">breaks =</span> <span class="dv">1993</span><span class="op">:</span><span class="dv">2020</span>, <span class="dt">labels =</span> <span class="dv">1993</span><span class="op">:</span><span class="dv">2020</span>,</a>
<a class="sourceLine" id="cb29-31" title="31">                             <span class="dt">guide =</span> <span class="kw">guide_axis</span>(<span class="dt">n.dodge =</span> <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-32" title="32"><span class="st">          </span><span class="kw">geom_text</span>(<span class="dt">data =</span> nb, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">label =</span> lab, <span class="dt">vjust =</span> vjust), <span class="dt">size =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-33" title="33">grapha</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-25-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co"># graphb</span></a>
<a class="sourceLine" id="cb30-3" title="3"></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="cf">if</span> (langue <span class="op">==</span><span class="st"> &quot;fr&quot;</span>){</a>
<a class="sourceLine" id="cb30-5" title="5">  type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Oui&quot;</span>, <span class="st">&quot;Non&quot;</span>)</a>
<a class="sourceLine" id="cb30-6" title="6">  lab1 &lt;-<span class="st"> &quot;Année&quot;</span></a>
<a class="sourceLine" id="cb30-7" title="7">  lab2 &lt;-<span class="st"> &quot;Âge&quot;</span></a>
<a class="sourceLine" id="cb30-8" title="8">  lab3 &lt;-<span class="st"> &quot;Occurence&quot;</span></a>
<a class="sourceLine" id="cb30-9" title="9">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb30-10" title="10">  type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)</a>
<a class="sourceLine" id="cb30-11" title="11">  lab1 &lt;-<span class="st"> &quot;Year&quot;</span></a>
<a class="sourceLine" id="cb30-12" title="12">  lab2 &lt;-<span class="st"> &quot;Age&quot;</span></a>
<a class="sourceLine" id="cb30-13" title="13">  lab3 &lt;-<span class="st"> &quot;Occurence&quot;</span></a>
<a class="sourceLine" id="cb30-14" title="14">}</a>
<a class="sourceLine" id="cb30-15" title="15"></a>
<a class="sourceLine" id="cb30-16" title="16">cols &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">12</span>, <span class="dt">name =</span> <span class="st">&quot;Paired&quot;</span>)</a>
<a class="sourceLine" id="cb30-17" title="17">cols &lt;-<span class="st"> </span><span class="kw">c</span>(cols[<span class="dv">6</span>], cols[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb30-18" title="18"></a>
<a class="sourceLine" id="cb30-19" title="19">dat_graph &lt;-<span class="st"> </span>bio_caa <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-20" title="20"><span class="st">             </span><span class="kw">filter</span>(source <span class="op">==</span><span class="st"> &quot;quai&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># les données du relevé nGSL ne sont pas montrées</span></a>
<a class="sourceLine" id="cb30-21" title="21"><span class="st">             </span><span class="kw">group_by</span>(year, age) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-22" title="22"><span class="st">             </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-23" title="23"><span class="st">             </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-24" title="24"><span class="st">             </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="st">&quot;age&quot;</span>, <span class="dt">names_prefix =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">values_from =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">values_fill =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-25" title="25"><span class="st">             </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&quot;a&quot;</span>), <span class="dt">names_to =</span> <span class="st">&quot;age&quot;</span>, <span class="dt">names_prefix =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;n&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-26" title="26"><span class="st">             </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">ifelse</span>(n <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;&quot;</span>, <span class="kw">format</span>(n, <span class="dt">big.mark =</span> bm, <span class="dt">trim =</span> T)),</a>
<a class="sourceLine" id="cb30-27" title="27">                    <span class="dt">age =</span> <span class="kw">factor</span>(age, <span class="dt">levels =</span> <span class="kw">min</span>(bio_caa<span class="op">$</span>age)<span class="op">:</span><span class="kw">max</span>(bio_caa<span class="op">$</span>age), <span class="dt">ordered =</span> T),</a>
<a class="sourceLine" id="cb30-28" title="28">                    <span class="dt">year =</span> <span class="kw">factor</span>(year, <span class="dt">levels =</span> <span class="dv">1993</span><span class="op">:</span><span class="dv">2020</span>, <span class="dt">ordered =</span> T),</a>
<a class="sourceLine" id="cb30-29" title="29">                    <span class="dt">occ =</span> <span class="kw">ifelse</span>(n <span class="op">==</span><span class="st"> &quot;&quot;</span>, type[<span class="dv">2</span>], type[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb30-30" title="30"></a>
<a class="sourceLine" id="cb30-31" title="31"></a>
<a class="sourceLine" id="cb30-32" title="32">graphb &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_graph, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-33" title="33"><span class="st">          </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> occ), <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-34" title="34"><span class="st">          </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> n), <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-35" title="35"><span class="st">          </span><span class="kw">scale_x_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_axis</span>(<span class="dt">n.dodge =</span> <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-36" title="36"><span class="st">          </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-37" title="37"><span class="st">          </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> cols) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-38" title="38"><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> lab1, <span class="dt">y =</span> lab2, <span class="dt">fill =</span> lab3) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-39" title="39"><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>)</a>
<a class="sourceLine" id="cb30-40" title="40">graphb</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-25-2.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co"># combinaison</span></a>
<a class="sourceLine" id="cb31-3" title="3"></a>
<a class="sourceLine" id="cb31-4" title="4">graph8 &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(grapha <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>()), </a>
<a class="sourceLine" id="cb31-5" title="5">                    graphb, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="st">&quot;AUTO&quot;</span>)</a>
<a class="sourceLine" id="cb31-6" title="6">graph8</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-25-3.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="kw">rm</span>(grapha, graphb, dat_graph)</a></code></pre></div>
</div>
<div id="graph9-appariements-lf-vs-alk" class="section level2">
<h2><span class="header-section-number">8.10</span> <code>graph9</code>: appariements LF vs ALK</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="cf">if</span> (langue <span class="op">==</span><span class="st"> &quot;fr&quot;</span>){</a>
<a class="sourceLine" id="cb33-2" title="2">  lab1 &lt;-<span class="st"> &quot;Type d&#39;échantillon&quot;</span></a>
<a class="sourceLine" id="cb33-3" title="3">  lab2 &lt;-<span class="st"> &quot;Niveau d&#39;agrégation&quot;</span></a>
<a class="sourceLine" id="cb33-4" title="4">  lab3 &lt;-<span class="st"> &quot;% des strates&quot;</span></a>
<a class="sourceLine" id="cb33-5" title="5">  types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;FL&quot;</span>, <span class="st">&quot;Âge&quot;</span>)</a>
<a class="sourceLine" id="cb33-6" title="6">  lab4 &lt;-<span class="st"> &quot; strates)&quot;</span></a>
<a class="sourceLine" id="cb33-7" title="7">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb33-8" title="8">  lab1 &lt;-<span class="st"> &quot;Sample type&quot;</span></a>
<a class="sourceLine" id="cb33-9" title="9">  lab2 &lt;-<span class="st"> &quot;Aggregation level&quot;</span></a>
<a class="sourceLine" id="cb33-10" title="10">  lab3 &lt;-<span class="st"> &quot;% of strata&quot;</span></a>
<a class="sourceLine" id="cb33-11" title="11">  types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;LF&quot;</span>, <span class="st">&quot;Age&quot;</span>)</a>
<a class="sourceLine" id="cb33-12" title="12">  lab4 &lt;-<span class="st"> &quot; strata)&quot;</span></a>
<a class="sourceLine" id="cb33-13" title="13">}</a>
<a class="sourceLine" id="cb33-14" title="14"></a>
<a class="sourceLine" id="cb33-15" title="15">dat_graph &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-16" title="16"><span class="st">             </span><span class="kw">distinct</span>(id, year, option.lengthfreq, option.agelength) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="st">             </span><span class="kw">group_by</span>(year, option.lengthfreq, option.agelength) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="st">             </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-19" title="19"><span class="st">             </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-20" title="20"><span class="st">             </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(.),</a>
<a class="sourceLine" id="cb33-21" title="21">                    <span class="dt">x =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb33-22" title="22">                    <span class="dt">xend =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb33-23" title="23">                    <span class="dt">y =</span> option.lengthfreq,</a>
<a class="sourceLine" id="cb33-24" title="24">                    <span class="dt">yend =</span> option.agelength) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-25" title="25"><span class="st">             </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-26" title="26"><span class="st">             </span><span class="kw">mutate</span>(<span class="dt">perc =</span> (n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-27" title="27"><span class="st">             </span><span class="kw">select</span>(id, year, x, xend, y, yend, n, perc)</a>
<a class="sourceLine" id="cb33-28" title="28"></a>
<a class="sourceLine" id="cb33-29" title="29">caa_all <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-30" title="30"><span class="st">  </span><span class="kw">distinct</span>(id, option.lengthfreq, option.agelength) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-31" title="31"><span class="st">  </span><span class="kw">group_by</span>(option.lengthfreq, option.agelength) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-32" title="32"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-33" title="33"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-34" title="34"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> (n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-35" title="35"><span class="st">  </span><span class="kw">pull</span>(perc) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-36" title="36"><span class="st">  </span>summary</a>
<a class="sourceLine" id="cb33-37" title="37"><span class="co">##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></a>
<a class="sourceLine" id="cb33-38" title="38"><span class="co">##  0.02178  0.06535  0.30494  1.96078  1.24156 20.16990</span></a>
<a class="sourceLine" id="cb33-39" title="39"></a>
<a class="sourceLine" id="cb33-40" title="40"><span class="co"># Je vais faire mes bins en conséquences</span></a>
<a class="sourceLine" id="cb33-41" title="41">bins &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb33-42" title="42"></a>
<a class="sourceLine" id="cb33-43" title="43"><span class="co"># Graphiques pour différentes périodes</span></a>
<a class="sourceLine" id="cb33-44" title="44">pers &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1993:1998&quot;</span>, <span class="st">&quot;1999:2004&quot;</span>, <span class="st">&quot;2005:2010&quot;</span>, <span class="st">&quot;2011:2016&quot;</span>, <span class="st">&quot;2017:2020&quot;</span>)</a>
<a class="sourceLine" id="cb33-45" title="45"></a>
<a class="sourceLine" id="cb33-46" title="46">table_n &lt;-<span class="st"> </span>caa_all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">n_strata =</span> <span class="kw">n_distinct</span>(id)) <span class="op">%&gt;%</span><span class="st"> </span>ungroup</a>
<a class="sourceLine" id="cb33-47" title="47">dat_graph &lt;-<span class="st"> </span><span class="kw">left_join</span>(dat_graph, table_n, <span class="dt">by =</span> <span class="st">&quot;year&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-48" title="48"><span class="st">             </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">paste0</span>(year, <span class="st">&quot; (&quot;</span>, n_strata, lab4))</a>
<a class="sourceLine" id="cb33-49" title="49"></a>
<a class="sourceLine" id="cb33-50" title="50"></a>
<a class="sourceLine" id="cb33-51" title="51"><span class="co"># https://stackoverflow.com/questions/61915427/ggplot-integer-breaks-on-facets</span></a>
<a class="sourceLine" id="cb33-52" title="52">my_breaks &lt;-<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb33-53" title="53">  y &lt;-<span class="st"> </span><span class="kw">max</span>(x)</a>
<a class="sourceLine" id="cb33-54" title="54"> <span class="cf">if</span> (y <span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>){</a>
<a class="sourceLine" id="cb33-55" title="55">   <span class="dv">1</span><span class="op">:</span><span class="dv">12</span></a>
<a class="sourceLine" id="cb33-56" title="56"> } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb33-57" title="57">   <span class="dv">1</span><span class="op">:</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb33-58" title="58"> }</a>
<a class="sourceLine" id="cb33-59" title="59">} </a>
<a class="sourceLine" id="cb33-60" title="60"></a>
<a class="sourceLine" id="cb33-61" title="61">my_limits &lt;-<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb33-62" title="62">  z &lt;-<span class="st"> </span><span class="kw">max</span>(x)</a>
<a class="sourceLine" id="cb33-63" title="63"> <span class="cf">if</span> (z <span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>){</a>
<a class="sourceLine" id="cb33-64" title="64">   <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb33-65" title="65"> } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb33-66" title="66">   <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb33-67" title="67"> }</a>
<a class="sourceLine" id="cb33-68" title="68">}</a>
<a class="sourceLine" id="cb33-69" title="69"></a>
<a class="sourceLine" id="cb33-70" title="70"></a>
<a class="sourceLine" id="cb33-71" title="71"><span class="cf">for</span> (ii <span class="cf">in</span> pers){</a>
<a class="sourceLine" id="cb33-72" title="72">  graph &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dat_graph <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="kw">paste0</span>(<span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> ii)), <span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>), year)), </a>
<a class="sourceLine" id="cb33-73" title="73">                  <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend, <span class="dt">size =</span> perc, <span class="dt">alpha =</span> perc)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-74" title="74"><span class="st">           </span><span class="kw">geom_segment</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-75" title="75"><span class="st">           </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">2.25</span>), <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">labels =</span> types) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-76" title="76"><span class="st">           </span><span class="kw">scale_size_binned</span>(<span class="dt">breaks =</span> bins, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">guide =</span> <span class="kw">guide_bins</span>(<span class="dt">show.limits =</span> T)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-77" title="77"><span class="st">           </span><span class="kw">scale_alpha_binned</span>(<span class="dt">breaks =</span> bins, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">guide =</span> <span class="kw">guide_bins</span>(<span class="dt">show.limits =</span> T)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-78" title="78"><span class="st">           </span><span class="kw">labs</span>(<span class="dt">x =</span> lab1, <span class="dt">y =</span> lab2, <span class="dt">size =</span> lab3, <span class="dt">alpha =</span> lab3) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-79" title="79"><span class="st">           </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>year, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, ) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-80" title="80"><span class="st">           </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> my_breaks, <span class="dt">limits =</span> my_limits)</a>
<a class="sourceLine" id="cb33-81" title="81">  <span class="kw">print</span>(graph)</a>
<a class="sourceLine" id="cb33-82" title="82">  </a>
<a class="sourceLine" id="cb33-83" title="83">  <span class="kw">assign</span>(<span class="dt">x =</span> <span class="kw">paste0</span>(<span class="st">&quot;graph9_&quot;</span>, <span class="kw">gsub</span>(<span class="st">&quot;:&quot;</span>, <span class="st">&quot;_&quot;</span>, ii)), <span class="dt">value =</span> graph)</a>
<a class="sourceLine" id="cb33-84" title="84">  <span class="kw">rm</span>(graph)</a>
<a class="sourceLine" id="cb33-85" title="85">}</a></code></pre></div>
<p><img src="03_calculs_files/figure-html/unnamed-chunk-26-1.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-26-2.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-26-3.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-26-4.png" width="864" style="display: block; margin: auto;" /><img src="03_calculs_files/figure-html/unnamed-chunk-26-5.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw">rm</span>(dat_graph, bins, pers, table_n, my_breaks, my_limits)</a></code></pre></div>
</div>
</div>
<div id="travail-sur-lw" class="section level1">
<h1><span class="header-section-number">9</span> Travail sur <code>lw</code></h1>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">dim</span>(lw) <span class="co"># 336 obs et 9 var</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">## [1] 336   9</span></a>
<a class="sourceLine" id="cb35-3" title="3">lw &lt;-<span class="st"> </span>lw <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># pour le resdoc</span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="st">      </span><span class="kw">group_by</span>(annee, n_brute, n_net, intercept, slope, r_squared, source) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="st">      </span><span class="kw">summarise</span>(<span class="dt">mois =</span> <span class="kw">paste</span>(<span class="kw">as.character</span>(<span class="kw">sort</span>(<span class="kw">unique</span>(mois), <span class="dt">na.last =</span> F)), <span class="dt">collapse =</span> <span class="st">&quot;,&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="st">      </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">mois =</span> <span class="kw">ifelse</span>(mois <span class="op">==</span><span class="st"> </span><span class="kw">paste</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">collapse =</span> <span class="st">&quot;,&quot;</span>), <span class="st">&quot;1-12&quot;</span>,</a>
<a class="sourceLine" id="cb35-8" title="8">                           <span class="kw">ifelse</span>(mois <span class="op">==</span><span class="st"> </span><span class="kw">paste</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">collapse =</span> <span class="st">&quot;,&quot;</span>), <span class="st">&quot;1-3, 10-12&quot;</span>,</a>
<a class="sourceLine" id="cb35-9" title="9">                                  <span class="kw">ifelse</span>(mois <span class="op">==</span><span class="st"> </span><span class="kw">paste</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">collapse =</span> <span class="st">&quot;,&quot;</span>), <span class="st">&quot;4-9&quot;</span>, <span class="ot">NA</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="st">      </span><span class="kw">select</span>(annee, mois, n_brute, n_net, intercept, slope, r_squared, source) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="st">      </span><span class="kw">arrange</span>(annee, mois)</a>
<a class="sourceLine" id="cb35-12" title="12"><span class="kw">dim</span>(lw) <span class="co"># 30 obs et 8 var</span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="co">## [1] 30  8</span></a></code></pre></div>
</div>
<div id="sauvegarde" class="section level1">
<h1><span class="header-section-number">10</span> Sauvegarde</h1>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">save</span>(table1, <span class="dt">file =</span> <span class="kw">paste0</span>(result, <span class="st">&quot;03_tables_&quot;</span>, langue, <span class="st">&quot;.Rda&quot;</span>))</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="kw">save</span>(lw, <span class="dt">file =</span> <span class="kw">paste0</span>(result, <span class="st">&quot;03_relations_masse-longueur_aggrege.Rda&quot;</span>))</a>
<a class="sourceLine" id="cb36-3" title="3"><span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">ls</span>(<span class="dt">pattern =</span> <span class="st">&quot;graph[0-9]+&quot;</span>), <span class="dt">file =</span> <span class="kw">paste0</span>(result, <span class="st">&quot;03_graphs_&quot;</span>, langue, <span class="st">&quot;.Rda&quot;</span>))</a></code></pre></div>
</div>
<div id="références-citées" class="section level1 unnumbered">
<h1>Références citées</h1>
<div id="refs" class="references">
<div id="ref-Bourdages2011_fr">
<p>Bourdages, H., et Ouellet, J.-F. 2011. Répartition géographique et indices d’abondance des poissons marins du nord du golfe du Saint-Laurent (1990–2009). Rapp. tech. can. sci. halieut. aquat. 2963: vi + 171 p.</p>
</div>
<div id="ref-Frechet1992_fr">
<p>Fréchet, A., et Schwab, P. 1992. Évaluation du stock de morue du nord du Golfe du Saint-Laurent (3Pn, 4RS) en 1991. CSCPCA Doc. de Rech. 92/77: 50 p.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
