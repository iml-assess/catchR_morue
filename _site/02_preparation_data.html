<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jordan Ouellette-Plante" />

<meta name="date" content="2021-11-18" />

<title>Préparation des intrants du programme</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Morue</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="01_preparation_programme.html">1. Préparation initiale</a>
</li>
<li>
  <a href="02_preparation_data.html">2. Préparation des intrants</a>
</li>
<li>
  <a href="03_calculs.html">3. Calculs</a>
</li>
<li>
  <a href="04_comparaisons_valeurs_historiques.html">4. Comparaisons avec valeurs historiques</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Préparation des intrants du programme</h1>
<h4 class="author">Jordan Ouellette-Plante</h4>
<h4 class="date">2021-11-18</h4>

</div>


<div id="objectif" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Objectif</h1>
<p>Préparer ou du moins copier localement les intrants requis pour les analyses.</p>
</div>
<div id="initialisation" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Initialisation</h1>
<div id="répertoires-et-infos-utiles" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Répertoires et infos utiles</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.R&quot;</span>) <span class="co"># https://gist.github.com/noamross/a549ee50e8a4fd68b8b1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">purl</span>(<span class="at">input =</span> <span class="st">&quot;01_preparation_programme.Rmd&quot;</span>, <span class="at">output =</span> temp, <span class="at">quiet =</span> T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;C:\\Users\\OUELLE~1\\AppData\\Local\\Temp\\1\\RtmpAJAGPv\\file146c2e444f57.R&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(temp)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(temp)</span></code></pre></div>
</div>
<div id="packages-requis" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> packages requis</h2>
<p>Des packages supplémentaires sont requis.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
</div>
</div>
<div id="débarquements" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Débarquements</h1>
<div id="données-ziff" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Données ZIFF</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(dat_ziff)){ <span class="co"># si le fichier n&#39;existe pas, je le crée</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">load</span>(intrant_ziff)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dim</span>(ziff) <span class="co"># 3799554 obs et 66 var</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(ziff<span class="sc">$</span>cod_esp) <span class="co"># juste des débarquements de morue</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(ziff<span class="sc">$</span>div) <span class="co"># plusieurs OPANO</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    ziff <span class="ot">&lt;-</span> ziff <span class="sc">%&gt;%</span> <span class="fu">filter</span>(div <span class="sc">%in%</span> opanos)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dim</span>(ziff) <span class="co"># 583305 obs et 66 var</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(ziff, <span class="at">file =</span> dat_ziff)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">load</span>(dat_ziff)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ziff) <span class="co"># 583305 obs et 66 var</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 583305     66</span></span></code></pre></div>
</div>
<div id="données-opano" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Données OPANO</h2>
<div id="format-nafo-21a" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Format NAFO 21A</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(dat_nafoa)){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">load</span>(intrant_nafoa)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dim</span>(nafoA) <span class="co"># 616 obs et 5 var</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(nafoA, <span class="at">file =</span> dat_nafoa)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">load</span>(dat_nafoa)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(nafoA) <span class="co"># 616 obs et 5 var</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 616   5</span></span></code></pre></div>
</div>
<div id="format-nafo-21b" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Format NAFO 21B</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(dat_nafob)){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">load</span>(intrant_nafob)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dim</span>(nafoB) <span class="co"># 164393 obs et 25 var</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(nafoB<span class="sc">$</span>nafo) <span class="co"># plusieurs OPANO</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(nafoB<span class="sc">$</span>code) <span class="co"># 101 = code OPANO pour la morue franche</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    nafoB <span class="ot">&lt;-</span> nafoB <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(nafo <span class="sc">%in%</span> <span class="fu">toupper</span>(opanos)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">select</span>(year, month, country, nafo, gear, gear, gear.code, gear.cat, prov, catch)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(nafoB) <span class="ot">&lt;-</span> <span class="fu">recode</span>(<span class="fu">names</span>(nafoB), <span class="st">&quot;year&quot;</span> <span class="ot">=</span> <span class="st">&quot;annee&quot;</span>, <span class="st">&quot;month&quot;</span> <span class="ot">=</span> <span class="st">&quot;mois&quot;</span>, <span class="st">&quot;country&quot;</span> <span class="ot">=</span> <span class="st">&quot;pays&quot;</span>, <span class="st">&quot;nafo&quot;</span> <span class="ot">=</span> <span class="st">&quot;opano&quot;</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;gear&quot;</span> <span class="ot">=</span> <span class="st">&quot;engin_en&quot;</span>, <span class="st">&quot;gear.code&quot;</span> <span class="ot">=</span> <span class="st">&quot;engin&quot;</span>, <span class="st">&quot;gear.cat&quot;</span> <span class="ot">=</span> <span class="st">&quot;engin_cat&quot;</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(nafoB<span class="sc">$</span>opano) <span class="co"># je vais standardiser 3Pn</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    nafoB[nafoB<span class="sc">$</span>opano <span class="sc">==</span> <span class="st">&quot;3PN&quot;</span>, <span class="st">&quot;opano&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;3Pn&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dim</span>(nafoB) <span class="co"># 19059 obs et 9 var</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(nafoB, <span class="at">file =</span> dat_nafob)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">load</span>(dat_nafob)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(nafoB) <span class="co"># 19059 obs et 9 var</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 19059     9</span></span></code></pre></div>
</div>
</div>
<div id="comparaison-des-débarquements" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Comparaison des débarquements</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dat_a <span class="ot">&lt;-</span> nafoA <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&quot;NAFO 21A&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>dat_b <span class="ot">&lt;-</span> nafoB <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&quot;NAFO 21B&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>dat_c <span class="ot">&lt;-</span> ziff <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(pds_vift, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>         ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&quot;ZIFF&quot;</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dat_a, dat_b, dat_c) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">&gt;=</span> <span class="dv">1985</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>brks_x <span class="ot">&lt;-</span> <span class="dv">1985</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>labs_x <span class="ot">&lt;-</span> brks_x</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>labs_x[labs_x <span class="sc">%%</span> <span class="dv">5</span> <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> annee, <span class="at">y =</span> catch <span class="sc">/</span> <span class="dv">1000</span>, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> brks_x, <span class="at">labels =</span> labs_x) <span class="sc">+</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Année&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Débarquements (milliers de tonnes)&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Source des données&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-7-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dat_a, dat_b, dat_c, dat)</span></code></pre></div>
<p>Les données de l’OPANO donnent des résultats équivalents jusqu’à ~ 2009. Les données NAFO 21B sont disponibles jusqu’à 2016, mais on voit qu’elles ne sont pas à jour avec les données ZIFF.</p>
<p>Les données ZIFF ne comportent pas les débarquements des flottilles étrangères et c’est pour cette raison qu’ils sont plus bas au cours des années 1985–1992.</p>
</div>
<div id="catch-nafob-ziff" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> <code>catch</code> = <code>nafoB</code> + <code>ziff</code></h2>
<p>Je me crée un jeu <code>catch</code> où je combine les données NAFO 21B et ZIFF selon ce format:</p>
<ul>
<li>1960–1984: données NAFO 21B</li>
<li>1985–2020:
<ul>
<li>Données ZIFF</li>
<li>Données NAFO 21B seulement pour la composante internationale des débarquements</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ziff <span class="ot">&lt;-</span> ziff <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&quot;ZIFF&quot;</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">pays =</span> <span class="st">&quot;Canada&quot;</span>, <span class="co"># pour être constant avec les variables de nafoB</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">prov =</span> <span class="fu">ifelse</span>(prov_deb <span class="sc">==</span> <span class="st">&quot;Inconnu&quot;</span>, <span class="fu">as.character</span>(prov_att), <span class="fu">as.character</span>(prov_deb)),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">engin =</span> <span class="fu">as.character</span>(engin),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">catch =</span> pds_vif) <span class="co"># débarquements en kg</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>nafoB <span class="ot">&lt;-</span> nafoB <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&quot;NAFO 21B&quot;</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">engin =</span> <span class="fu">as.character</span>(engin),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">an_gestion =</span> <span class="fu">as.character</span>(annee),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">catch =</span> catch <span class="sc">*</span> <span class="dv">1000</span>) <span class="co"># débarquements en kg</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>nafoB <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pays <span class="sc">!=</span> <span class="st">&quot;Canada&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(annee) <span class="sc">%&gt;%</span> unique <span class="sc">%&gt;%</span> sort</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [16] 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1989 1990</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [31] 1991 1992</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># j&#39;ai des débarquements de flotilles étrangères passé 1985. ZIFF ne contiendra pas ces débarquements</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>catch <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(nafoB <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">&lt;</span> <span class="dv">1985</span>),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>                   nafoB <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">&gt;=</span> <span class="dv">1985</span>, pays <span class="sc">!=</span> <span class="st">&quot;Canada&quot;</span>),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>                   ziff) <span class="sc">%&gt;%</span> </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(annee, mois, div, opano, prov, engin, engin_cat, engin_fr, engin_en, source, </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                catch, pays, date_deb, an_gestion)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co"># catch %&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(annee) %&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(catch = sum(catch / 1000, na.rm = T)) %&gt;% # débarquements en tonnes</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(data = ., aes(x = annee, y = catch)) +</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point()</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(catch<span class="sc">$</span>div) <span class="co"># valeurs NA...</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NA    &quot;4R&quot;  &quot;4S&quot;  &quot;3Pn&quot;</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(catch, <span class="fu">is.na</span>(div))); <span class="fu">length</span>(cor) <span class="co"># 10156 lignes</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 10156</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(catch<span class="sc">$</span>opano[cor]) <span class="co"># la division n&#39;a pas été inscrite.</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;4R&quot;  &quot;3Pn&quot; &quot;4S&quot;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>catch<span class="sc">$</span>div[cor] <span class="ot">&lt;-</span> catch<span class="sc">$</span>opano[cor]</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(catch, opano <span class="sc">==</span> <span class="st">&quot;3P&quot;</span>)); <span class="fu">length</span>(cor) <span class="co"># 17445 lignes</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 17445</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(catch<span class="sc">$</span>div[cor]) <span class="co"># la zone unitaire devrait être 3Pn</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;3Pn&quot;</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>catch<span class="sc">$</span>opano[cor] <span class="ot">&lt;-</span> <span class="st">&quot;3Pn&quot;</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(catch, <span class="fu">nchar</span>(opano) <span class="sc">==</span> <span class="dv">2</span>)); <span class="fu">length</span>(cor) <span class="co"># 7872 lignes</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 7872</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(catch<span class="sc">$</span>div[cor]) <span class="co"># on ne sait pas quelle est la zone unitaire exacte...</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;4R&quot; &quot;4S&quot;</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(catch) <span class="co"># 593461 obs et 14 var</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 593461     14</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(catch, <span class="at">file =</span> dat_catch)</span></code></pre></div>
</div>
</div>
<div id="échantillonneurs-à-quai" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Échantillonneurs à quai</h1>
<div id="lectures" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Lectures</h2>
<div id="fl" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> FL</h3>
<p><code>lf</code> = length frequency = données de fréquences de longueur</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lf <span class="ot">&lt;-</span> <span class="fu">read.lf</span>(<span class="at">file =</span> intrant_lf, <span class="at">year =</span> <span class="cn">NULL</span>, <span class="at">language =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;3PN|4R|4S&quot;</span>, opano)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      as_tibble</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lf) <span class="ot">&lt;-</span> <span class="fu">recode</span>(<span class="fu">names</span>(lf), <span class="st">&quot;nafo&quot;</span> <span class="ot">=</span> <span class="st">&quot;div&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Travail sur opano et div</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(lf<span class="sc">$</span>div) <span class="co"># problème avec 3P</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;3P&quot; &quot;4R&quot; &quot;4S&quot; NA</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(lf, <span class="sc">!</span><span class="fu">is.na</span>(div) <span class="sc">&amp;</span> div <span class="sc">==</span> <span class="st">&quot;3P&quot;</span>)); <span class="fu">length</span>(cor) <span class="co"># 14667 lignes</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 14667</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(lf<span class="sc">$</span>opano[cor]) <span class="co"># 3Pn</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;3PN&quot;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>lf<span class="sc">$</span>div[cor] <span class="ot">&lt;-</span> <span class="st">&quot;3Pn&quot;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(lf, <span class="fu">is.na</span>(div))); <span class="fu">length</span>(cor) <span class="co"># 13737 lignes</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 13737</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(lf<span class="sc">$</span>opano[cor]) <span class="co"># div devrait être 4S</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;4SI&quot; &quot;4SX&quot; &quot;4SY&quot;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>lf<span class="sc">$</span>div[cor] <span class="ot">&lt;-</span> <span class="st">&quot;4S&quot;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(lf<span class="sc">$</span>opano) <span class="co"># la 3e lettre devrait être en minuscule</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;3PN&quot; &quot;4R&quot;  &quot;4RA&quot; &quot;4RB&quot; &quot;4RC&quot; &quot;4RD&quot; &quot;4S&quot;  &quot;4SI&quot; &quot;4SS&quot; &quot;4SV&quot; &quot;4SW&quot; &quot;4SX&quot;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] &quot;4SY&quot; &quot;4SZ&quot;</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>lf<span class="sc">$</span>opano <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(lf<span class="sc">$</span>opano,<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">tolower</span>(<span class="fu">substr</span>(lf<span class="sc">$</span>opano,<span class="dv">3</span>,<span class="dv">3</span>)))</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(lf) <span class="co"># 109138 obs et 34 var</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 109138     34</span></span></code></pre></div>
</div>
<div id="caractéristiques-biologiques" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Caractéristiques biologiques</h3>
<p>Ces données incluent les âges.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bio <span class="ot">&lt;-</span> <span class="fu">read.bio</span>(<span class="at">file =</span> intrant_bio, <span class="at">year =</span> <span class="cn">NULL</span>, <span class="at">sp =</span> my_sp, <span class="at">language =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;3PN|4R|4S&quot;</span>, opano)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate_at</span>(<span class="at">.vars =</span> <span class="fu">c</span>(<span class="st">&quot;engin&quot;</span>, <span class="st">&quot;engin_fr&quot;</span>, <span class="st">&quot;engin_en&quot;</span>), <span class="at">.funs =</span> as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>       as_tibble</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Travail sur opano et div</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>bio<span class="sc">$</span>opano <span class="ot">&lt;-</span> <span class="fu">as.character</span>(bio<span class="sc">$</span>opano) <span class="co"># pour enlever les niveaux inutilisés</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(bio<span class="sc">$</span>opano) <span class="co"># la 3e lettre devrait être en minuscule</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;4RB&quot; &quot;3PN&quot; &quot;4RC&quot; &quot;4SI&quot; &quot;4SV&quot; &quot;4SS&quot; &quot;4SY&quot; &quot;4S&quot;  &quot;4SX&quot; &quot;4RA&quot; &quot;4RD&quot; &quot;4R&quot; </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] &quot;4SW&quot; &quot;4SZ&quot;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>bio<span class="sc">$</span>opano <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(bio<span class="sc">$</span>opano,<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">tolower</span>(<span class="fu">substr</span>(bio<span class="sc">$</span>opano,<span class="dv">3</span>,<span class="dv">3</span>)))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(bio) <span class="co"># 117002 obs et 24 var</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 117002     24</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> bio <span class="co"># pour la partie sur les échantillons manquants</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>bio <span class="ot">&lt;-</span> bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(longueur))</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(bio) <span class="co"># 85185 obs et 24 var</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 85185    24</span></span></code></pre></div>
</div>
</div>
<div id="échantillons-manquants" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Échantillons manquants</h2>
<p>Pour certaines années (1994–1997), on voit que j’ai plus d’échantillons d’âge que d’échantillons de FL, ce qui est bizarre puisque normalement, l’échantillon d’âge est un sous-échantillon de celui de FL.</p>
<p>Une théorie est que des échantillons auraient été envoyés complets à l’IML ou ailleurs. Là-bas, les spécimens auraient tous servis autant pour les lectures d’âge que pour les FL. Quelqu’un aurait donc dû copier ces données dans les données LF et Âge, et pas seulement dans les données d’âge.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n_lf =</span> <span class="fu">n_distinct</span>(ech_id)) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n_age =</span> <span class="fu">n_distinct</span>(ech_id)) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(a, b, <span class="at">by =</span> <span class="st">&quot;annee&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n_age <span class="sc">&gt;</span> n_lf)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 4 x 3</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   annee  n_lf n_age</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  1994     6    78</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  1995     6   778</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  1996    11   418</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  1997   156   321</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>manque <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(ech_id) <span class="sc">%&gt;%</span> unique,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                  lf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(ech_id) <span class="sc">%&gt;%</span> unique)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(manque) <span class="co"># manque 1478 échantillons pour les années 1993:2020</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1478</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, ech_id <span class="sc">%in%</span> manque) <span class="sc">%&gt;%</span> </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n_tot =</span> <span class="fu">NROW</span>(annee), </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">n_lu =</span> <span class="fu">NROW</span>(annee[<span class="sc">!</span><span class="fu">is.na</span>(age)]),</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">n_non_lu =</span> n_tot <span class="sc">-</span> n_lu) <span class="sc">%&gt;%</span> </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(n_non_lu))</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 4 x 4</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   annee n_tot  n_lu n_non_lu</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  1995  9667  2738     6929</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  1996  6359  1425     4934</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  1997  3568  1114     2454</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  1994   764   733       31</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour ces échantillons, des milliers de spécimens n&#39;ont pas eu leur otolithe lue</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ech_id <span class="sc">%in%</span> manque) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(ech_id)) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 4 x 2</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="do">##   annee     n</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  1994    72</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  1995   772</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  1996   407</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  1997   227</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Les années 1994 à 1997 sont problématiques.</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ech_id <span class="sc">%in%</span> manque) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(engin) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(ech_id)) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 4 x 2</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="do">##   engin     n</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 FPN      76</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 GN      754</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 LHP       5</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 LL      643</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Surtout du filet maillant et de la palangre. J&#39;ai l&#39;impression que ce sont des échantillons provenant de PSfixe, puisque les autres engins étaient également utilisés au début de ce programme.</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">names</span>(lf), <span class="fu">names</span>(temp))</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>max_id <span class="ot">&lt;-</span> <span class="fu">max</span>(lf<span class="sc">$</span>id)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="ot">&lt;-</span> temp <span class="sc">%&gt;%</span> </span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(ech_id <span class="sc">%in%</span> manque) <span class="sc">%&gt;%</span> </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select_at</span>(<span class="fu">all_of</span>(vars)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">div =</span> <span class="fu">ifelse</span>(opano <span class="sc">==</span> <span class="st">&quot;3Pn&quot;</span>, <span class="st">&quot;3Pn&quot;</span>, <span class="fu">substr</span>(opano, <span class="dv">1</span>,<span class="dv">2</span>)),</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_mes =</span> <span class="dv">1</span>, <span class="co"># dans bio, une ligne par poisson</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>                   <span class="at">etat_deb =</span> <span class="st">&quot;Inconnu&quot;</span>, <span class="co"># information non-fournie dans bio</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>                   <span class="at">esp_ech =</span> <span class="dv">10</span>, <span class="co"># dans bio, une ligne par poisson</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                   <span class="at">pds_deb =</span> <span class="cn">NA</span>, <span class="co"># dans bio, une ligne par poisson</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>                   <span class="at">pds_ech =</span> <span class="cn">NA</span>, <span class="co"># dans bio, une ligne par poisson</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                   <span class="at">no_voy =</span> <span class="fu">as.character</span>(no_voy), <span class="co"># pour que le merge fonctionne</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>                   <span class="at">no_prov =</span> <span class="fu">as.character</span>(no_prov), <span class="co"># pour que le merge fonctionne</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nbpc =</span> <span class="fu">as.character</span>(nbpc))  <span class="co"># pour que le merge fonctionne</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> ajout_lf <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(annee, ech_id) <span class="sc">%&gt;%</span> summarise <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.) <span class="sc">+</span> max_id)</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ajout_lf, ids, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;ech_id&quot;</span>))</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf) <span class="co"># 20358 obs et 24 var</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 20358    24</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(lf) <span class="co"># 109138 obs et 34 var</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 109138     34</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>lf <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(lf, ajout_lf)</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(lf) <span class="co"># 129496 obs et 34 var</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 129496     34</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(a,b,manque, ajout_lf, vars, temp, ids)</span></code></pre></div>
</div>
<div id="validation-des-longueurs" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Validation des longueurs</h2>
<p>Je m’assure que les longueurs font du sens. Je ne regarde que les petites valeurs.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lf <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(longueur) <span class="sc">%&gt;%</span> count <span class="sc">%&gt;%</span> ungroup <span class="co"># le 7 cm est à part du reste...</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 138 x 2</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    longueur     n</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">##       &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  1        7     1</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  2       11     1</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  3       12     1</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  4       13     1</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  5       14     2</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  6       16     2</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  7       17     2</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  8       18     3</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  9       19    12</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10       20     4</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 128 more rows</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>lf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(longueur <span class="sc">&lt;</span> <span class="dv">19</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(annee, engin, longueur, ech_id) <span class="co"># Une morue de 7 cm pêchée à la palangre? Invraisemblable.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 13 x 4</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    annee engin longueur ech_id</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  1  1983 LLS         14  41518</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  2  1995 PS          18   1238</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  3  1983 ST          16  41393</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  4  2014 LLS          7  56209</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  5  1995 FPN         16   3568</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  6  1995 FPN         13   3568</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  7  1995 FPN         12   3568</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  8  1995 FPN         18   3568</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  9  1995 FPN         11   3567</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 10  1995 FPN         17   3568</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 11  1995 FPN         18   3567</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 12  1995 FPN         14   3567</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 13  1995 FPN         17   3567</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>lf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ech_id <span class="sc">==</span> <span class="dv">56209</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(<span class="at">x =</span> longueur)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Doit être une erreur de frappe. </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Comme je ne peux savoir si c&#39;est 37 cm ou xx cm, je flag cette ligne comme outlier</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>lf<span class="sc">$</span>outlier <span class="ot">&lt;-</span> F <span class="co"># par défaut</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(lf, longueur <span class="sc">==</span> <span class="dv">7</span>)); <span class="fu">length</span>(cor) <span class="co"># 1 ligne</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>lf<span class="sc">$</span>outlier[cor] <span class="ot">&lt;-</span> T</span></code></pre></div>
</div>
<div id="validation-des-âges" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Validation des âges</h2>
<p>Je m’assure que les âges font du sens.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>bio <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span> count <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="co"># pas de valeurs absurdes à 1ère vue. 1 seule valeur 1 an</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    age     n</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    1     1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2    2    55</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3    3   798</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4    4  5428</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 5    5 10340</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 6    6 13425</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 7    7 14278</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 8    8 13580</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 9    9 11042</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 10  10  6767</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 11  11  4482</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 12  12  2296</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 13  13  1281</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 14  14   592</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 15  15   348</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 16  16   205</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 17  17   112</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 18  18    61</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 19  19    25</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 20  20    28</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 21  21    19</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 22  22     7</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 23  23    10</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 24  24     4</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 25  26     1</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co"># bio comporte pour l&#39;instant plus d&#39;années que la période 1993:2020</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Je ne veux valider les données 1993:2020 qu&#39;en regardant les données de 1993:2020</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>bio <span class="ot">&lt;-</span> bio <span class="sc">%&gt;%</span> </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(<span class="at">periode =</span> <span class="fu">ifelse</span>(annee <span class="sc">%in%</span> my_year, T, F)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>       <span class="fu">group_by</span>(periode, age) <span class="sc">%&gt;%</span> </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(<span class="at">outlier =</span> <span class="fu">outlier</span>(longueur, <span class="at">coef =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>       ungroup</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs étant au-dessus du 75e percentile ou en-dessous du 25e percentile par un facteur de 3 fois l&#39;étendue interquartile sont jugées êtres des outliers.</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(outlier <span class="sc">==</span> T) <span class="sc">%&gt;%</span> <span class="fu">select</span>(annee, longueur, age, outlier) <span class="co"># 18 outliers initialement</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 18 x 4</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="do">##    annee longueur   age outlier</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;int&gt;    &lt;int&gt; &lt;int&gt; &lt;lgl&gt;  </span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="do">##  1  1984       62     4 TRUE   </span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  2  1983       66     4 TRUE   </span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="do">##  3  1983       89     6 TRUE   </span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="do">##  4  1983       64     4 TRUE   </span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="do">##  5  1984       76     4 TRUE   </span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="do">##  6  1984       60     4 TRUE   </span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="do">##  7  1990       92     6 TRUE   </span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="do">##  8  1994       65     4 TRUE   </span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="do">##  9  1994       59     3 TRUE   </span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="do">## 10  1985       90     6 TRUE   </span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="do">## 11  1983      103     7 TRUE   </span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="do">## 12  1983       72     5 TRUE   </span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="do">## 13  1988       61     4 TRUE   </span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="do">## 14  1997       58     3 TRUE   </span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="do">## 15  1993      148    17 TRUE   </span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="do">## 16  1983       70     4 TRUE   </span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="do">## 17  1988       60     4 TRUE   </span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="do">## 18  1983       69     4 TRUE</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(periode <span class="sc">==</span> T), <span class="fu">aes</span>(<span class="at">x =</span> longueur, <span class="at">fill =</span> outlier)) <span class="sc">+</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> age, <span class="at">scale =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-13-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bizarre pour l&#39;âge 1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(periode <span class="sc">==</span> T, age <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(annee, mois, jour, longueur, age)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 1 x 5</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   annee  mois  jour longueur   age</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  1997     7    23       60     1</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lui aussi est un outlier. Impossible d&#39;avoir 1 an/60 cm de long</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>bio[bio<span class="sc">$</span>age <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;outlier&quot;</span>] <span class="ot">&lt;-</span> T</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les vieilles morues, beaucoup de variabilité. Je pense que c&#39;est possible</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  lab1 <span class="ot">&lt;-</span> <span class="st">&quot;Âge&quot;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  lab2 <span class="ot">&lt;-</span> <span class="st">&quot;Longueur (cm)&quot;</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  lab3 <span class="ot">&lt;-</span> <span class="st">&quot;Valeur aberrante&quot;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  lab1 <span class="ot">&lt;-</span> <span class="st">&quot;Age&quot;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  lab2 <span class="ot">&lt;-</span> <span class="st">&quot;Length (cm)&quot;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  lab3 <span class="ot">&lt;-</span> <span class="st">&quot;Outlier&quot;</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la figure, je n&#39;utilise que les données de 1993--2020.</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(bio) <span class="co"># 85185 obs et 26 var</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 85185    26</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(periode <span class="sc">==</span> T)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(temp) <span class="co"># 27386 obs et 26 var</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 27386    26</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>outlier <span class="ot">&lt;-</span> <span class="fu">as.character</span>(temp<span class="sc">$</span>outlier) <span class="sc">%&gt;%</span> <span class="fu">recode</span>(., <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> lab3)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(temp<span class="sc">$</span>longueur)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  18 148</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>brks_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">10</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>labs_y <span class="ot">&lt;-</span> brks_y</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>labs_y[labs_y <span class="sc">%%</span> <span class="dv">25</span> <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>brks_x <span class="ot">&lt;-</span> <span class="fu">min</span>(temp<span class="sc">$</span>age)<span class="sc">:</span><span class="fu">max</span>(temp<span class="sc">$</span>age)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>labs_x <span class="ot">&lt;-</span> brks_x</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Nbre de morues âgées</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> temp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span> count <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">lab =</span> <span class="fu">format</span>(n, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T))</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>graph1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> temp, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> longueur, <span class="at">group =</span> age)) <span class="sc">+</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>(<span class="at">data =</span> temp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(outlier <span class="sc">==</span> lab3), <span class="fu">aes</span>(<span class="at">color =</span> outlier)) <span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> lab1, <span class="at">y =</span> lab2, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brks_y, <span class="at">labels =</span> labs_y) <span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> brks_x, <span class="at">labels =</span> labs_x, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text</span>(<span class="at">data =</span> nb, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">label =</span> lab, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.9</span>))</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>graph1</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-13-2.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(periode <span class="sc">==</span> T, outlier <span class="sc">==</span> T) <span class="sc">%&gt;%</span> nrow <span class="co"># 5 outliers pour la période d&#39;intérêt</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(outlier <span class="sc">==</span> T) <span class="sc">%&gt;%</span> nrow <span class="co"># 19 outliers au total</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 19</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>bio<span class="sc">$</span>periode <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># inutile maintenant</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(temp)</span></code></pre></div>
</div>
</div>
<div id="observateurs-en-mer" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Observateurs en mer</h1>
<p>J’ai des débarquements de morues occasionnés par des crevettiers, mais je n’ai pas de données d’échantillonneurs à quai où des morues ont été mesurées pour cet engin. Je dois donc faire appel aux données d’observateurs en mer.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>catch <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, engin_fr <span class="sc">==</span> <span class="st">&quot;Chalut à crevettes&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">deb =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  ungroup</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 28 x 2</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    annee   deb</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  1  1993 83350</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  2  1994  4968</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  3  1995   169</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  4  1996    38</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  5  1997  1142</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  6  1998    30</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  7  1999    88</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  8  2000    55</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  9  2001    10</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 10  2002    10</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 18 more rows</span></span></code></pre></div>
<p>J’ai des débarquements à partir de 1993. Selon <span class="citation"><a href="#ref-Savard2013_fr" role="doc-biblioref">Savard et al.</a> (<a href="#ref-Savard2013_fr" role="doc-biblioref">2013</a>)</span>, la grille séparatrice aurait été obligatoire à l’hiver 1993. Je ne peux donc pas regrouper le chalut à crevette avec les autres chaluts de fond, puisqu’on assume que les morues débarquées seront beaucoup plus petites.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(lf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin) <span class="sc">%&gt;%</span> unique, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin) <span class="sc">%&gt;%</span> unique) </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="do">## character(0)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tous les engins de lf sont dans bio</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin_fr) <span class="sc">%&gt;%</span> unique</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;Filets maillants calés (ancrés)&quot;                         </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [2] &quot;Palangres calées&quot;                                        </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  [3] &quot;Filets maillants (non spécifiés)&quot;                        </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  [4] &quot;Palangres (non spécifiées)&quot;                              </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  [5] &quot;Palangrotte&quot;                                             </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  [6] &quot;Filets-pièges fixes non couverts&quot;                        </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] &quot;Hameçons et lignes (non spécifiés)&quot;                      </span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  [8] &quot;Chalut de fond à panneaux (arrière)&quot;                     </span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  [9] &quot;Pièges (non spécifiés)&quot;                                  </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [10] &quot;Seine danoise ou écossaise ou pairée (2 navires)&quot;        </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [11] &quot;Lignes à main et lignes à cannes (manoeuvrées à la main)&quot;</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [12] &quot;Seine bourse&quot;                                            </span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] &quot;Chalut pélagique&quot;</span></span></code></pre></div>
<p>Je n’ai aucun débarquement de morues par des chaluttiers à crevette dans les données d’échantillonneurs à quai. Je vais devoir avoir recours aux données des observateurs en mer.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(dat_obs_1990_1998); <span class="fu">dim</span>(JOP1) <span class="co"># 22550 obs et 44 var. </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 22550    44</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Données fournies par Hugues Benoît via courriel le 9 sept. 2021</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># représente les FL des morues capturées par des chaluts à crevette. La période 1990-1998 n&#39;est actuellement pas disponible via la base de données et c&#39;est pourquoi Hugues me fournit une copie qu&#39;il avait sur son ordi personnel.</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(JOP1<span class="sc">$</span>spec) <span class="co"># juste de la morue</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 10</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(JOP1<span class="sc">$</span>mspec) <span class="co"># visait la crevette nordique</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2210</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>JOP1 <span class="sc">%&gt;%</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">year</span>(<span class="fu">ymd</span>(act_date))) <span class="sc">%&gt;%</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee, gear) <span class="sc">%&gt;%</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  count <span class="sc">%&gt;%</span> </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gear, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 8 x 5</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   annee  OTB1  OTB2  GRL1  GRL2</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  1990  1558   294     0     0</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  1991  1143  4138     0     0</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  1992  2512 11203     0     0</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  1993     0   722    63    59</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 5  1994     0   196     0     0</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 6  1996     0     0     0    13</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 7  1997     0   272     0    94</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 8  1998     0     0    48   235</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co"># À partir de 1993, la grille de Nordmore fait son entrée</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(JOP1) <span class="ot">&lt;-</span> <span class="fu">recode</span>(<span class="fu">names</span>(JOP1), <span class="st">&quot;act_no&quot;</span> <span class="ot">=</span> <span class="st">&quot;no_voy&quot;</span>, <span class="st">&quot;sub_acti&quot;</span> <span class="ot">=</span> <span class="st">&quot;id&quot;</span>, <span class="st">&quot;uarea&quot;</span> <span class="ot">=</span> <span class="st">&quot;opano&quot;</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;fish_len&quot;</span> <span class="ot">=</span> <span class="st">&quot;longueur&quot;</span>, <span class="st">&quot;no_fish&quot;</span> <span class="ot">=</span> <span class="st">&quot;n_mes&quot;</span>, <span class="st">&quot;wt_samp&quot;</span> <span class="ot">=</span> <span class="st">&quot;pds_ech&quot;</span>, <span class="st">&quot;act_date&quot;</span> <span class="ot">=</span> <span class="st">&quot;date&quot;</span>,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;gear&quot;</span> <span class="ot">=</span> <span class="st">&quot;engin&quot;</span>)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>JOP1 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(no_voy, id, cfvn) <span class="sc">%&gt;%</span> nrow <span class="co"># 854 activités de pêche unique</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 854</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>JOP1 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(capt_no) <span class="sc">%&gt;%</span> nrow <span class="co"># 854 activités de pêche unique. capt_no identifie chaque activité de pêche</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 854</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>JOP1 <span class="sc">%&gt;%</span> </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(capt_no) <span class="sc">%&gt;%</span> </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">c</span>(<span class="st">&quot;pds_ech&quot;</span>, <span class="st">&quot;wt_kept&quot;</span>, <span class="st">&quot;wt_dscrd&quot;</span>), <span class="at">.funs =</span> n_distinct) <span class="sc">%&gt;%</span> </span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>  summary <span class="co"># problème avec les pds_ech...</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="do">##     capt_no           pds_ech         wt_kept     wt_dscrd</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="do">##  Min.   :    152   Min.   :1.000   Min.   :1   Min.   :1  </span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="do">##  1st Qu.:  31151   1st Qu.:1.000   1st Qu.:1   1st Qu.:1  </span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="do">##  Median :  43600   Median :1.000   Median :1   Median :1  </span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mean   : 433040   Mean   :1.107   Mean   :1   Mean   :1  </span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="do">##  3rd Qu.: 367653   3rd Qu.:1.000   3rd Qu.:1   3rd Qu.:1  </span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="do">##  Max.   :2047813   Max.   :3.000   Max.   :1   Max.   :1</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour une même activité, il semble que parfois, des échantillons aient été pris peut-être à différents moments durant la remontée de la capture à bord (ex: début, fin)</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Je vais combiner les lignes</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>JOP1 <span class="sc">%&gt;%</span> </span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(capt_no) <span class="sc">%&gt;%</span> </span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(pds_ech)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(capt_no) <span class="sc">%&gt;%</span> </span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>  unique <span class="sc">%&gt;%</span> </span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>  length</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 69</span></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="co"># 69 activités de la sorte</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Je vais régler cette problématique. J&#39;en profite pour ne conserver que les variables qui m&#39;intéressent.</span></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> JOP1 <span class="sc">%&gt;%</span> </span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>     <span class="fu">group_by</span>(capt_no) <span class="sc">%&gt;%</span> </span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>     <span class="fu">summarise</span>(<span class="at">pds_ech =</span> <span class="fu">sum</span>(<span class="fu">unique</span>(pds_ech), <span class="at">na.rm =</span> T),</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>               <span class="at">opano =</span> <span class="fu">unique</span>(opano),</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">wt_kept =</span> <span class="fu">unique</span>(wt_kept),</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>               <span class="at">wt_dscrd =</span> <span class="fu">unique</span>(wt_dscrd),</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>               <span class="at">pds_capt =</span> wt_kept <span class="sc">+</span> wt_dscrd,</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>               <span class="at">date =</span> <span class="fu">ymd</span>(<span class="fu">unique</span>(date)),</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>               <span class="at">annee =</span> <span class="fu">year</span>(date),</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>               <span class="at">engin =</span> <span class="fu">unique</span>(engin)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>     ungroup</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(a) <span class="co"># 854 obs et 9 var</span></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 854   9</span></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> JOP1 <span class="sc">%&gt;%</span> </span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>     <span class="fu">group_by</span>(capt_no, longueur) <span class="sc">%&gt;%</span> </span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>     <span class="fu">summarise</span>(<span class="at">n_mes =</span> <span class="fu">sum</span>(n_mes)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>     ungroup</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(b) <span class="co"># 18744 obs et 3 var = moins de lignes que JOP1, car multiples échantillons par capt_no combinés.</span></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 18744     3</span></span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="ot">&lt;-</span> <span class="fu">full_join</span>(a, b, <span class="at">by =</span> <span class="st">&quot;capt_no&quot;</span>); <span class="fu">dim</span>(ajout_lf) <span class="co"># 18744 obs et 11 var</span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 18744    11</span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>ajout_lf</span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 18,744 x 11</span></span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a><span class="do">##    capt_no pds_ech opano wt_kept wt_dscrd pds_capt date       annee engin</span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a><span class="do">##      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;</span></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a><span class="do">##  1     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a><span class="do">##  2     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a><span class="do">##  3     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a><span class="do">##  4     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a><span class="do">##  5     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a><span class="do">##  6     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a><span class="do">##  7     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a><span class="do">##  8     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a><span class="do">##  9     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a><span class="do">## 10     152     1.5 4Si        35       75      110 1991-04-19  1991 OTB2 </span></span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 18,734 more rows, and 2 more variables: longueur &lt;dbl&gt;, n_mes &lt;dbl&gt;</span></span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(a,b)</span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(ajout_lf, pds_ech <span class="sc">&gt;</span> pds_capt)); <span class="fu">length</span>(cor) <span class="co"># 1466 lignes</span></span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1466</span></span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> ajout_lf[cor, ] <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(capt_no) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(capt_no) <span class="sc">%&gt;%</span> unique</span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ids)</span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 41</span></span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Je n&#39;utiliserai pas ces activités (41), puisque le poids de l&#39;échantillon ne peut être &gt; que celui de capture</span></span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ajout_lf<span class="sc">$</span>annee, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a><span class="do">##  1990  1991  1992  1993  1994  1996  1997  1998  &lt;NA&gt; </span></span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a><span class="do">##   935  2695 13413   843   196    13   366   283     0</span></span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf) <span class="co"># 18744 obs et 11 var</span></span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 18744    11</span></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="ot">&lt;-</span> ajout_lf <span class="sc">%&gt;%</span> </span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(<span class="sc">!</span>(capt_no <span class="sc">%in%</span> ids)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="co"># je ne garde que les donneées dans les années d&#39;intérêt</span></span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf) <span class="co"># 1701 obs et 11 var. On perd bcp de lignes (le gros des données était de 1990:1992)</span></span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1701   11</span></span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="sc">%&gt;%</span> </span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(capt_no) <span class="sc">%&gt;%</span> </span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">c</span>(<span class="st">&quot;pds_ech&quot;</span>, <span class="st">&quot;pds_capt&quot;</span>), <span class="at">.funs =</span> unique) <span class="sc">%&gt;%</span> </span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(<span class="at">x =</span> pds_capt, <span class="at">y =</span> pds_ech)) <span class="sc">+</span></span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-16-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># La majeure partie du temps, toute la capture est échantillonnée</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(ajout_lf<span class="sc">$</span>date) <span class="co"># du 18 avril 1993 au 3 sept 1998</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;1993-04-18&quot; &quot;1998-09-03&quot;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ajout_lf<span class="sc">$</span>longueur) <span class="co"># au cm près = parfait</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 13 15 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [26] 41 42 43 46 47 50 40 45 48 49 16 44 55 61 62 52 51 54 56 59 60 82 53 58 57</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [51] 63 65 14 10 11 12 64 84 85 86 87 88 89 90 91 92 93 94 95 66</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ajout_lf<span class="sc">$</span>engin)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;OTB2&quot; &quot;GRL1&quot; &quot;GRL2&quot;</span></span></code></pre></div>
<p>Maintenant avec les données post-1998.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(dat_obs_1999); <span class="fu">str</span>(obs) <span class="co"># liste avec 2 jeux de données</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">## List of 2</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ catch: tibble [440,207 x 26] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ no_voy  : chr [1:440207] &quot;J16-0563&quot; &quot;A17-0081&quot; &quot;A17-0082&quot; &quot;J01-0081B&quot; ...</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ no_affec: chr [1:440207] &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; ...</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ no_sorti: chr [1:440207] &quot;01&quot; &quot;01&quot; &quot;01&quot; &quot;01&quot; ...</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ trait   : int [1:440207] 1 5 3 63 46 64 63 65 67 68 ...</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ nbpc    : int [1:440207] 3 4 4 7 7 7 9 9 9 9 ...</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ engin   : chr [1:440207] &quot;OTB2&quot; &quot;OTB2&quot; &quot;OTB2&quot; &quot;OTB2&quot; ...</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ larg_eng: num [1:440207] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ div_nafo: chr [1:440207] &quot;5Zj&quot; &quot;5Zj&quot; &quot;5Zj&quot; &quot;4Wl&quot; ...</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ zone    : chr [1:440207] NA NA NA NA ...</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ lat_deb : num [1:440207] 42.1 42.1 42.1 42.9 43.2 ...</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ long_deb: num [1:440207] -67 -67 -67.1 -62.4 -61.4 ...</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ quadril : chr [1:440207] NA NA NA NA ...</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ lat_fin : num [1:440207] NA 42 42.1 43 43.1 ...</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ long_fin: num [1:440207] NA -66.9 -66.9 -62.2 -61.5 ...</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ prof    : num [1:440207] 84 84 65 250 160 230 140 144 142 140 ...</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ hr_deb  : num [1:440207] 14.5 10.7 11 7 13.3 ...</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ duree   : num [1:440207] 3.25 4.18 4.38 1.5 4.67 ...</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ vitesse : num [1:440207] 3.3 3.5 3.8 3.2 3.5 3.5 3 3 3 3 ...</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ esp_vis : int [1:440207] 11 11 11 14 14 14 14 14 14 14 ...</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ esp_capt: int [1:440207] 70 70 70 70 70 70 70 70 70 70 ...</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ pdv_cons: num [1:440207] 0 0 0 1 3 2 5 6 5 10 ...</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ pdv_rej : num [1:440207] 4 3 1 0 0 0 0 0 0 0 ...</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ cod_bris: int [1:440207] 1 1 1 1 6 1 6 1 1 1 ...</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ l_trait : logi [1:440207] NA NA NA NA NA NA ...</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ date    : Date[1:440207], format: &quot;2016-09-22&quot; &quot;2017-10-23&quot; ...</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ annee   : num [1:440207] 2016 2017 2017 2001 2001 ...</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ fl   : tibble [674,668 x 16] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ no_voy  : chr [1:674668] &quot;EC06Z1-62&quot; &quot;EC06Z1-62&quot; &quot;EC06Z1-66&quot; &quot;EC06Z1-66&quot; ...</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ no_affec: chr [1:674668] &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; ...</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ no_sorti: chr [1:674668] &quot;01&quot; &quot;01&quot; &quot;01&quot; &quot;01&quot; ...</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ trait   : int [1:674668] 40 45 8 20 20 20 20 13 64 64 ...</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ espece  : int [1:674668] 70 70 70 70 70 70 70 70 70 70 ...</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ pds_capt: num [1:674668] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ pds_ech : num [1:674668] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ grp_mes : int [1:674668] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ typ_mes : int [1:674668] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ sexe    : chr [1:674668] &quot;M&quot; &quot;I&quot; &quot;M&quot; &quot;I&quot; ...</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ longueur: num [1:674668] 34 79 34 24 29 30 34 20 33 37 ...</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ nb_pois : int [1:674668] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ taille  : num [1:674668] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ nb_vif  : int [1:674668] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ nb_mort : int [1:674668] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ test    : chr [1:674668] &quot;test&quot; &quot;test&quot; &quot;test&quot; &quot;test&quot; ...</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>obs<span class="sc">$</span>catch <span class="sc">%&gt;%</span> </span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(esp_vis <span class="sc">==</span> <span class="dv">2211</span>, esp_capt <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span>  <span class="co"># visant la crevette nordique et ayant débarqué de la morue franche</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee, engin) <span class="sc">%&gt;%</span> </span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>  count <span class="sc">%&gt;%</span> </span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> engin, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 22 x 5</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="do">##    annee   GRL  GRL2  GRL1    TT</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a><span class="do">##  1  1999    29   360     0     0</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="do">##  2  2000    24   186     0     0</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="do">##  3  2001     0   221     1     0</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="do">##  4  2002    16    84     0     0</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a><span class="do">##  5  2003    15   363     2     0</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a><span class="do">##  6  2004     2   345     0     0</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a><span class="do">##  7  2005     0   204     0     0</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a><span class="do">##  8  2006    14   184     0     1</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a><span class="do">##  9  2007    63   145     4     0</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a><span class="do">## 10  2008    24   291     0     2</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 12 more rows</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a><span class="co"># OTB n&#39;est plus du tout utilisé...</span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Données de captures</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> obs<span class="sc">$</span>catch <span class="sc">%&gt;%</span> </span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">opano =</span> div_nafo,</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>            <span class="at">pds_capt =</span> pdv_cons <span class="sc">+</span> pdv_rej) <span class="sc">%&gt;%</span> </span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>     <span class="fu">filter</span>(esp_vis <span class="sc">==</span> <span class="dv">2211</span>, esp_capt <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span>  <span class="co"># visant la crevette nordique et ayant débarqué de la morue franche</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>     <span class="fu">select</span>(no_voy, no_affec, no_sorti, trait, opano, date, annee, pds_capt, engin)</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(a) <span class="co"># 5522 obs et 8 var</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5522    9</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>a <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(no_voy, no_affec, no_sorti, trait) <span class="sc">%&gt;%</span> nrow <span class="co"># ok. 1 ligne par trait de pêche</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5522</span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a><span class="co"># no_voy, no_affec, no_sorti, trait sont les variables à utiliser pour la clé pour identifier une activité de pêche.</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(a<span class="sc">$</span>date) <span class="co"># du 2 avril 1999 au 19 sept 2020</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;1999-04-02&quot; &quot;2020-09-19&quot;</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Données de LF</span></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> obs<span class="sc">$</span>fl <span class="sc">%&gt;%</span> </span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>     <span class="fu">filter</span>(espece <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># juste la morue</span></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">longueur =</span> <span class="fu">round</span>(longueur, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co"># pour avoir des valeurs au cm près </span></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>     <span class="fu">group_by</span>(no_voy, no_affec, no_sorti, trait, longueur) <span class="sc">%&gt;%</span> </span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>     <span class="fu">summarise</span>(<span class="at">n_mes =</span> <span class="fu">sum</span>(nb_pois)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>     ungroup</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(b) <span class="co"># 142199 obs et 6 var</span></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 142199      6</span></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> obs<span class="sc">$</span>fl <span class="sc">%&gt;%</span> </span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>     <span class="fu">filter</span>(espece <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>     <span class="fu">group_by</span>(no_voy, no_affec, no_sorti, trait) <span class="sc">%&gt;%</span> </span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>     <span class="fu">summarise</span>(<span class="at">pds_ech =</span> <span class="fu">sum</span>(<span class="fu">unique</span>(pds_ech))) <span class="sc">%&gt;%</span> <span class="co"># peut y avoir plus d&#39;un éch par activité de pêche (ex: début/fin)</span></span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>     ungroup</span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(d) <span class="co"># 8738 obs et 5 var</span></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 8738    5</span></span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>obs<span class="sc">$</span>fl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(espece <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(no_voy, no_affec, no_sorti, trait) <span class="sc">%&gt;%</span> nrow <span class="co"># 8738</span></span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 8738</span></span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">full_join</span>(b, d, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;no_voy&quot;</span>, <span class="st">&quot;no_affec&quot;</span>, <span class="st">&quot;no_sorti&quot;</span>, <span class="st">&quot;trait&quot;</span>))</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(b) <span class="co"># 142199 obs et 7 var</span></span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 142199      7</span></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinaison</span></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(b) <span class="co"># 142199 obs et 7 var</span></span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 142199      7</span></span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>ajout_lf2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(b, a, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;no_voy&quot;</span>, <span class="st">&quot;no_affec&quot;</span>, <span class="st">&quot;no_sorti&quot;</span>, <span class="st">&quot;trait&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(date)) <span class="co"># les lignes où date est NA sont des lignes où l&#39;appariement n&#39;a pas fonctionné</span></span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf2) <span class="co"># 8110 obs et 12 var</span></span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 8110   12</span></span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(a,b,d)</span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(ajout_lf2<span class="sc">$</span>date) <span class="co"># du 2 avril 1999 au 19 sept 2020</span></span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;1999-04-02&quot; &quot;2020-09-19&quot;</span></span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ajout_lf2<span class="sc">$</span>engin, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a><span class="do">##  GRL GRL1 GRL2   TT &lt;NA&gt; </span></span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a><span class="do">##   63   12 7062  973    0</span></span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>ajout_lf2 <span class="sc">%&gt;%</span> </span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(no_voy, no_affec, no_sorti, trait) <span class="sc">%&gt;%</span> </span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">c</span>(<span class="st">&quot;pds_ech&quot;</span>, <span class="st">&quot;pds_capt&quot;</span>), <span class="at">.funs =</span> unique) <span class="sc">%&gt;%</span> </span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(<span class="at">x =</span> pds_capt, <span class="at">y =</span> pds_ech)) <span class="sc">+</span></span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-17-1.png" width="864" style="display: block; margin: auto;" /> Pour chaque activité de pêche, je vais leur assigner un id unique (<em>ech_id</em>).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>val_max <span class="ot">&lt;-</span> <span class="fu">max</span>(lf<span class="sc">$</span>ech_id); val_max <span class="co"># 65965</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 65965</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Données 1990-1998</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>cle <span class="ot">&lt;-</span> <span class="st">&quot;capt_no&quot;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>echs <span class="ot">&lt;-</span> ajout_lf <span class="sc">%&gt;%</span> <span class="fu">distinct_at</span>(cle) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ech_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ech_id =</span> ech_id <span class="sc">+</span> val_max)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf) <span class="co"># 1701 obs et 11 var</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1701   11</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ajout_lf, echs, <span class="at">by =</span> cle)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf) <span class="co"># 1701 obs et 12 var</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1701   12</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Données 1999-maintenant</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>val_max <span class="ot">&lt;-</span> <span class="fu">max</span>(ajout_lf<span class="sc">$</span>ech_id); val_max <span class="co"># 66116</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 66116</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>cle <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;no_voy&quot;</span>, <span class="st">&quot;no_affec&quot;</span>, <span class="st">&quot;no_sorti&quot;</span>, <span class="st">&quot;trait&quot;</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>echs <span class="ot">&lt;-</span> ajout_lf2 <span class="sc">%&gt;%</span> <span class="fu">distinct_at</span>(cle) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ech_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ech_id =</span> ech_id <span class="sc">+</span> val_max)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf2) <span class="co"># 8110 obs et 12 var</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 8110   12</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>ajout_lf2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ajout_lf2, echs, <span class="at">by =</span> cle)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf2) <span class="co"># 8110 obs et 13 var</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 8110   13</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(echs, cle, val_max)</span></code></pre></div>
<p>Combinaison</p>
<p>La description des codes d’engin est retrouvée <a href="\dcqcimlna01a\BD_Peches\Observateur\Documentation\Description_codes%20engin.xlsx">ici</a>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout_lf, ajout_lf2) <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&quot;observateur&quot;</span>, <span class="co"># pour laisser une trace de la provenance de ces données</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mois =</span> <span class="fu">month</span>(date)) <span class="sc">%&gt;%</span>  </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;3Pn|4R|4S&quot;</span>, opano)) <span class="co"># juste les données de 3Pn4RS désirées</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf) <span class="co"># 7640 obs et 18 var</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 7640   18</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_fr <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># vide initialement</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_en <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># vide initialement</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ajout_lf<span class="sc">$</span>engin)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;OTB2&quot; &quot;GRL1&quot; &quot;GRL2&quot; &quot;TT&quot;   &quot;GRL&quot;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(ajout_lf, engin <span class="sc">==</span> <span class="st">&quot;OTB2&quot;</span>)); <span class="fu">length</span>(cor) <span class="co"># 1189 lignes</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1189</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_fr[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Chalut de fond à panneaux (arrière)&quot;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_en[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Stern otter trawl&quot;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(ajout_lf, engin <span class="sc">==</span> <span class="st">&quot;GRL1&quot;</span>)); <span class="fu">length</span>(cor) <span class="co"># 123 lignes</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 123</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_fr[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Chalut à crevettes (de côté) avec grille&quot;</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_en[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Shrimp trawl (side) with grid&quot;</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(ajout_lf, engin <span class="sc">==</span> <span class="st">&quot;GRL2&quot;</span>)); <span class="fu">length</span>(cor) <span class="co"># 5365 lignes</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5365</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_fr[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Chalut à crevettes (arrière) avec grille&quot;</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_en[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Shrimp trawl (stern) with grid&quot;</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(ajout_lf, engin <span class="sc">==</span> <span class="st">&quot;TT&quot;</span>)); <span class="fu">length</span>(cor) <span class="co"># 900 lignes</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 900</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_fr[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Chalut double&quot;</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_en[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Twin trawl&quot;</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(ajout_lf, engin <span class="sc">==</span> <span class="st">&quot;GRL&quot;</span>)); <span class="fu">length</span>(cor) <span class="co"># 63 lignes</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 63</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_fr[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Chalut à crevettes (non spécifié) avec grille&quot;</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>engin_en[cor] <span class="ot">&lt;-</span> <span class="st">&quot;Shrimp trawl (unspecified) with grid&quot;</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ajout_lf<span class="sc">$</span>engin_fr, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="do">##      Chalut à crevettes (arrière) avec grille </span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="do">##                                          5365 </span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="do">##      Chalut à crevettes (de côté) avec grille </span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="do">##                                           123 </span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Chalut à crevettes (non spécifié) avec grille </span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="do">##                                            63 </span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="do">##           Chalut de fond à panneaux (arrière) </span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="do">##                                          1189 </span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a><span class="do">##                                 Chalut double </span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a><span class="do">##                                           900 </span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a><span class="do">##                                          &lt;NA&gt; </span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="do">##                                             0</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="ot">&lt;-</span> ajout_lf <span class="sc">%&gt;%</span> </span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(ech_id, annee, opano, mois, date, engin, engin_fr, engin_en, source, longueur, n_mes, pds_ech)</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_lf) <span class="co"># 7640 obs et 12 var</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 7640   12</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(ajout_lf<span class="sc">$</span>ech_id) <span class="co"># 1546 échantillons</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1546</span></span></code></pre></div>
<p>Vérification des outliers de longueur.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ajout_lf <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(longueur) <span class="sc">%&gt;%</span> count <span class="sc">%&gt;%</span> ungroup <span class="co"># ok</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 78 x 2</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    longueur     n</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">##       &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  1        4     2</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  2        5     1</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  3        6     6</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  4        7     6</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  5        8    27</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  6        9    57</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  7       10   118</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  8       11   160</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  9       12   186</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10       13   224</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 68 more rows</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> ajout_lf</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(ajout_lf<span class="sc">$</span>longueur)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]   4 121</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>bin <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>brks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">125</span>, <span class="at">by =</span> bin); brks</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1]   0   5  10  15  20  25  30  35  40  45  50  55  60  65  70  75  80  85  90</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [20]  95 100 105 110 115 120 125</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>cl <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># vide initialement</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> brks){</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(test, longueur <span class="sc">&gt;=</span> i <span class="sc">&amp;</span> longueur <span class="sc">&lt;</span> (i <span class="sc">+</span> bin)))</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  test<span class="sc">$</span>cl[cor] <span class="ot">&lt;-</span> i <span class="sc">+</span> (bin <span class="sc">/</span> <span class="dv">2</span>) <span class="co"># pour être au milieu de la bin</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(cor)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>test <span class="sc">%&gt;%</span> </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cl) <span class="sc">%&gt;%</span> </span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_mes =</span> <span class="fu">sum</span>(n_mes)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(<span class="at">x =</span> cl, <span class="at">y =</span> n_mes)) <span class="sc">+</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-20-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parfait</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(test)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>ajout_lf<span class="sc">$</span>outlier <span class="ot">&lt;-</span> F <span class="co"># par défaut</span></span></code></pre></div>
<p>Je peux maintenant ajouter à <code>lf</code> ces 2 jeux de données.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lf <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(lf <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&quot;quai&quot;</span>), ajout_lf)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(lf) <span class="co"># 137136 obs et 38 var</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 137136     38</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ajout_lf, ajout_lf2, JOP1)</span></code></pre></div>
</div>
<div id="relevé-multispécifique-du-ngsl" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Relevé multispécifique du nGSL</h1>
<p>Bien que les observateurs en mer récoltent des otolithes, je n’ai pas de données d’âge associées à ce programme pour utiliser dans les analyses. Après discussion avec Hugues, on en est venu à la conclusion qu’il était approprié d’utiliser les données d’âge du relevé multispécifique du nGSL.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(intrant_ngsl) <span class="co"># ouvre ngsl</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Je vais prendre toutes les morues disponibles, en autant que des valeurs d&#39;âge/longueur sont présentes</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> ngsl<span class="sc">$</span>carbio <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(longueur)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(<span class="at">longueur =</span> <span class="fu">round</span>(longueur<span class="sc">/</span><span class="dv">10</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co"># en cm, arrondi à l&#39;entier</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(nav, rel, trait, longueur, age) <span class="sc">%&gt;%</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">left_join</span>(., ngsl<span class="sc">$</span>set <span class="sc">%&gt;%</span> <span class="fu">select</span>(nav, rel, trait, annee, opano), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;nav&quot;</span>, <span class="st">&quot;rel&quot;</span>, <span class="st">&quot;trait&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, opano <span class="sc">%in%</span> opanos) <span class="sc">%&gt;%</span> <span class="co"># juste 3Pn4RS</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">select</span>(annee, longueur, age)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dat) <span class="co"># 19915 obs et 3 var</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 19915     3</span></span></code></pre></div>
<p>Pour chaque cellule de catch où l’engin est le chalut à crevettes, je vais me créer un échantillon bidon où j’utiliserai les données annuelles du relevé nGSL.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ajout_bio <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">mois =</span> <span class="dv">8</span>, <span class="co"># le relevé nGSL est essentiellement au août</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">engin =</span> <span class="st">&quot;OTB2&quot;</span>, <span class="co"># est un chalut de fond. J&#39;aurais pu mettre un autre code pour les chaluts à crev.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">engin_fr =</span> <span class="st">&quot;Chalut de fond à panneaux (arrière)&quot;</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">engin_en =</span> <span class="st">&quot;Stern otter trawl&quot;</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">source =</span> <span class="st">&quot;nGSL&quot;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_bio) <span class="co"># 19915 obs et 8 var</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 19915     8</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>val_max <span class="ot">&lt;-</span> <span class="fu">max</span>(bio<span class="sc">$</span>ech_id); val_max <span class="co"># 65965</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 65965</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">annee =</span> my_year) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ech_id =</span> id <span class="sc">+</span> val_max)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_bio) <span class="co"># 19915 obs et 8 var</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 19915     8</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>ajout_bio <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ajout_bio, ids <span class="sc">%&gt;%</span> <span class="fu">select</span>(annee, ech_id), <span class="at">by =</span> <span class="st">&quot;annee&quot;</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_bio) <span class="co"># 19915 obs et 9 var</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 19915     9</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(val_max, ids, ngsl, dat)</span></code></pre></div>
<p>Je valide ensuite les âges.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ajout_bio <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span> count <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="co"># pas de valeurs absurdes à 1ère vue. 1 seule valeur 1 an</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    age    n</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    0   72</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2    1 1516</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3    2 3239</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4    3 3616</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 5    4 3436</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 6    5 2497</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 7    6 2192</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 8    7 1527</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 9    8  887</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 10   9  500</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 11  10  253</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 12  11  103</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 13  12   51</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 14  13   18</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 15  14    5</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 16  15    1</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 17  16    2</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Relation âge-longueur</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>ajout_bio <span class="ot">&lt;-</span> ajout_bio <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">outlier =</span> <span class="fu">outlier</span>(longueur, <span class="at">coef =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs étant au-dessus du 75e percentile ou en-dessous du 25e percentile par un facteur de 3 fois l&#39;étendue interquartile sont jugées êtres des outliers.</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>ajout_bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(outlier <span class="sc">==</span> T) <span class="sc">%&gt;%</span> <span class="fu">select</span>(annee, longueur, age, outlier) <span class="co"># 2 outliers initialement</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 2 x 4</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   annee longueur   age outlier</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt;    &lt;dbl&gt; &lt;int&gt; &lt;lgl&gt;  </span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  1995      104    10 TRUE   </span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  2016       94     8 TRUE</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ajout_bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year), <span class="fu">aes</span>(<span class="at">x =</span> longueur, <span class="at">fill =</span> outlier)) <span class="sc">+</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> age, <span class="at">scale =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-24-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Je vais supprimer ces 2 outliers</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_bio) <span class="co"># 19915 obs et 10 var</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 19915    10</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>ajout_bio <span class="ot">&lt;-</span> ajout_bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(outlier <span class="sc">==</span> F)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ajout_bio) <span class="co"># 19913 obs et 10 var</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 19913    10</span></span></code></pre></div>
<p>Je peux maintenant ajouter à <code>bio</code> ces données.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(bio) <span class="co"># 85185 obs et 25 var</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 85185    25</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>bio <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(bio <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">&quot;quai&quot;</span>), ajout_bio)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(bio) <span class="co"># 105098 obs et 26 var</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 105098     26</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ajout_bio)</span></code></pre></div>
</div>
<div id="classes-dengins" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Classes d’engins</h1>
<p>Je me base en partie sur les regroupements présentés par <span class="citation"><a href="#ref-Frechet1986a" role="doc-biblioref">Fréchet et Gascon</a> (<a href="#ref-Frechet1986a" role="doc-biblioref">1986</a>)</span>.</p>
<div id="débarquements-1" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Débarquements</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(catch <span class="sc">%&gt;%</span> <span class="fu">filter</span>(source <span class="sc">==</span> <span class="st">&quot;NAFO 21B&quot;</span>, annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin) <span class="sc">%&gt;%</span> unique,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>        catch <span class="sc">%&gt;%</span> <span class="fu">filter</span>(source <span class="sc">==</span> <span class="st">&quot;ZIFF&quot;</span>, annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin) <span class="sc">%&gt;%</span> unique)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="do">## character(0)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># NAFO 21B ne fournit aucun engin qui n&#39;est pas mentionné dans les données ZIFF</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>engins_deb <span class="ot">&lt;-</span> catch <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(source <span class="sc">==</span> <span class="st">&quot;ZIFF&quot;</span>, <span class="sc">!</span><span class="fu">is.na</span>(engin), annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">distinct</span>(engin, engin_fr, engin_en, engin_cat) <span class="sc">%&gt;%</span> </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">engin_groupe =</span> <span class="fu">as.character</span>(<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> <span class="co"># vide initialement</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">arrange</span>(engin)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(engins_deb) <span class="co"># 21 obs et 5 var</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 21  5</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  grp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Chaluts à crevette&quot;</span>, <span class="st">&quot;Autres chaluts&quot;</span>, <span class="st">&quot;Seines&quot;</span>, <span class="st">&quot;Filets maillants&quot;</span>, <span class="st">&quot;Palangres&quot;</span>, </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Engins manuels&quot;</span>, <span class="st">&quot;Trappes&quot;</span>, <span class="st">&quot;Autres / inconnus&quot;</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  grp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Shrimp trawls&quot;</span>, <span class="st">&quot;Other trawls&quot;</span>, <span class="st">&quot;Seines&quot;</span>, <span class="st">&quot;Gillnets&quot;</span>, <span class="st">&quot;Longlines&quot;</span>, <span class="st">&quot;Hand gear&quot;</span>, </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Traps&quot;</span>, <span class="st">&quot;Others / unknown&quot;</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>engins_deb[engins_deb<span class="sc">$</span>engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">19</span>), <span class="st">&quot;engin_groupe&quot;</span>] <span class="ot">&lt;-</span> grp[<span class="dv">1</span>]</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>engins_deb[engins_deb<span class="sc">$</span>engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">18</span>), <span class="st">&quot;engin_groupe&quot;</span>] <span class="ot">&lt;-</span> grp[<span class="dv">2</span>]</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>engins_deb[engins_deb<span class="sc">$</span>engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">22</span>), <span class="st">&quot;engin_groupe&quot;</span>] <span class="ot">&lt;-</span> grp[<span class="dv">3</span>]</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>engins_deb[engins_deb<span class="sc">$</span>engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">41</span>), <span class="st">&quot;engin_groupe&quot;</span>] <span class="ot">&lt;-</span> grp[<span class="dv">4</span>]</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>engins_deb[engins_deb<span class="sc">$</span>engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>), <span class="st">&quot;engin_groupe&quot;</span>] <span class="ot">&lt;-</span> grp[<span class="dv">5</span>]</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>engins_deb[engins_deb<span class="sc">$</span>engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">53</span>,<span class="dv">55</span>,<span class="dv">59</span>), <span class="st">&quot;engin_groupe&quot;</span>] <span class="ot">&lt;-</span> grp[<span class="dv">6</span>]</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>engins_deb[engins_deb<span class="sc">$</span>engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">61</span>,<span class="dv">62</span>,<span class="dv">67</span>,<span class="dv">68</span>), <span class="st">&quot;engin_groupe&quot;</span>] <span class="ot">&lt;-</span> grp[<span class="dv">7</span>]</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>engins_deb[engins_deb<span class="sc">$</span>engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">71</span>,<span class="dv">99</span>), <span class="st">&quot;engin_groupe&quot;</span>] <span class="ot">&lt;-</span> grp[<span class="dv">8</span>]</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(engins_deb<span class="sc">$</span>engin_groupe, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># 0 valeur NA = parfait</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="do">##         Gillnets        Hand gear        Longlines     Other trawls </span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a><span class="do">##                1                3                2                6 </span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Others / unknown           Seines    Shrimp trawls            Traps </span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="do">##                2                2                1                4 </span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="do">##             &lt;NA&gt; </span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="do">##                0</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>engins_deb<span class="sc">$</span>engin_groupe <span class="ot">&lt;-</span> <span class="fu">factor</span>(engins_deb<span class="sc">$</span>engin_groupe, <span class="at">levels =</span> grp, <span class="at">ordered =</span> T)</span></code></pre></div>
<p><code>catch</code> contient des valeurs <em>NA</em> pour certaines colonnes associées aux engins. Je vais corriger ça.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>catch[, <span class="fu">c</span>(<span class="st">&quot;engin_cat&quot;</span>, <span class="st">&quot;engin_fr&quot;</span>, <span class="st">&quot;engin_en&quot;</span>)] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(catch, <span class="fu">is.na</span>(engin))); <span class="fu">length</span>(cor) <span class="co"># 1681</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1681</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>catch<span class="sc">$</span>engin[cor] <span class="ot">&lt;-</span> <span class="dv">99</span> <span class="co"># sera dans le groupe Autres / inconnus</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(catch) <span class="co"># 593461 obs et 11 var</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 593461     11</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>catch <span class="ot">&lt;-</span> <span class="fu">left_join</span>(catch, engins_deb <span class="sc">%&gt;%</span> <span class="fu">select</span>(engin, engin_fr, engin_en), <span class="at">by =</span> <span class="st">&quot;engin&quot;</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(catch) <span class="co"># 593461 obs et 13 var</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 593461     13</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(catch, <span class="at">file =</span> dat_catch)</span></code></pre></div>
<p>Je vais également rajouter de l’information sur l’importance de ces engins dans la pêche.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ajout_tot <span class="ot">&lt;-</span> catch <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, <span class="sc">!</span><span class="fu">is.na</span>(catch)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">group_by</span>(engin) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>             ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">perc_tot =</span> catch <span class="sc">/</span> <span class="fu">sum</span>(catch) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">select</span>(<span class="sc">-</span>catch) <span class="co"># inutile</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>ajout_min_max <span class="ot">&lt;-</span> catch <span class="sc">%&gt;%</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, <span class="sc">!</span><span class="fu">is.na</span>(catch)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">factor</span>(annee), </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">engin =</span> <span class="fu">factor</span>(engin)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">group_by</span>(annee, engin, <span class="at">.drop =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">mutate</span>(<span class="at">perc =</span> catch <span class="sc">/</span> <span class="fu">sum</span>(catch) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">group_by</span>(engin) <span class="sc">%&gt;%</span> </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">min</span>(perc),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">max =</span> <span class="fu">max</span>(perc),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ans =</span> <span class="fu">NROW</span>(engin[perc <span class="sc">&gt;</span> <span class="dv">0</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                 ungroup</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(engins_deb) <span class="co"># 21 obs et 5 var</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 21  5</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>engins_deb <span class="ot">&lt;-</span> <span class="fu">left_join</span>(engins_deb, ajout_tot, <span class="at">by =</span> <span class="st">&quot;engin&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">left_join</span>(., ajout_min_max, <span class="at">by =</span> <span class="st">&quot;engin&quot;</span>)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(engins_deb) <span class="co"># 21 obs et 9 var</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 21  9</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(engins_deb, <span class="at">file =</span> dat_engin_deb)</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ajout_tot, ajout_min_max)</span></code></pre></div>
</div>
<div id="échantillonneurs-à-quai-1" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Échantillonneurs à quai</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(lf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin) <span class="sc">%&gt;%</span> unique, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>        bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin) <span class="sc">%&gt;%</span> unique) </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;GRL1&quot; &quot;GRL2&quot; &quot;TT&quot;   &quot;GRL&quot;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Quelques codes de chalut à crevettes ne sont pas dans les données bio</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(bio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin) <span class="sc">%&gt;%</span> unique, </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        lf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(engin) <span class="sc">%&gt;%</span> unique) </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="do">## character(0)</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tous les engins de bio sont dans lf</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>engins_obs <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> <span class="co"># pour n&#39;avoir que ceux observés de 1993 à 2020</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">distinct</span>(source, engin, engin_fr, engin_en)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(engins_obs) <span class="co"># 18 obs et 4 var</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 18  4</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>engins_obs <span class="co"># Je vais utiliser les définitions retrouvées dans bio</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 18 x 4</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="do">##    engin source      engin_fr                                      engin_en     </span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;                                         &lt;chr&gt;        </span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 LL    quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 LLS   quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 GN    quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 LX    quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 OTB2  quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 OTM   quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 FIX   quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 GNS   quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 LHP   quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 PS    quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 11 SDN   quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 12 LLG   quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 13 FPN   quai        &lt;NA&gt;                                          &lt;NA&gt;         </span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 14 OTB2  observateur Chalut de fond à panneaux (arrière)           Stern otter ~</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 15 GRL1  observateur Chalut à crevettes (de côté) avec grille      Shrimp trawl~</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 16 GRL2  observateur Chalut à crevettes (arrière) avec grille      Shrimp trawl~</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 17 TT    observateur Chalut double                                 Twin trawl   </span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 18 GRL   observateur Chalut à crevettes (non spécifié) avec grille Shrimp trawl~</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(engins_obs)){</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(engins_obs<span class="sc">$</span>engin_fr[i])){</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(bio, engin <span class="sc">==</span> engins_obs<span class="sc">$</span>engin[i]))</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    ajout <span class="ot">&lt;-</span> bio[cor, ] <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(engin, engin_fr, engin_en) <span class="sc">%&gt;%</span> summarise <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    engins_obs<span class="sc">$</span>engin_fr[i] <span class="ot">&lt;-</span> ajout<span class="sc">$</span>engin_fr</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>    engins_obs<span class="sc">$</span>engin_en[i] <span class="ot">&lt;-</span> ajout<span class="sc">$</span>engin_en</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(cor, ajout)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>engins_obs <span class="co"># parfait</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 18 x 4</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="do">##    engin source      engin_fr                          engin_en                 </span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;                             &lt;chr&gt;                    </span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 LL    quai        Palangres (non spécifiées)        Longlines (not specified)</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 LLS   quai        Palangres calées                  Set longlines            </span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 GN    quai        Filets maillants (non spécifiés)  Gillnets (not specified) </span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 LX    quai        Hameçons et lignes (non spécifié~ Hooks and lines (not spe~</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 OTB2  quai        Chalut de fond à panneaux (arriè~ Stern otter trawl        </span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 OTM   quai        Chalut pélagique                  Midwater trawl           </span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 FIX   quai        Pièges (non spécifiés)            Traps (not specified)    </span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 GNS   quai        Filets maillants calés (ancrés)   Set gillnets (anchored)  </span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 LHP   quai        Lignes à main et lignes à cannes~ Handlines and pole-lines~</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 PS    quai        Seine bourse                      Purse seine              </span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="do">## 11 SDN   quai        Seine danoise ou écossaise ou pa~ Danish or Scottish or Pa~</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="do">## 12 LLG   quai        Palangrotte                       Handline                 </span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a><span class="do">## 13 FPN   quai        Filets-pièges fixes non couverts  Stationary uncovered pou~</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a><span class="do">## 14 OTB2  observateur Chalut de fond à panneaux (arriè~ Stern otter trawl        </span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a><span class="do">## 15 GRL1  observateur Chalut à crevettes (de côté) ave~ Shrimp trawl (side) with~</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a><span class="do">## 16 GRL2  observateur Chalut à crevettes (arrière) ave~ Shrimp trawl (stern) wit~</span></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a><span class="do">## 17 TT    observateur Chalut double                     Twin trawl               </span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a><span class="do">## 18 GRL   observateur Chalut à crevettes (non spécifié~ Shrimp trawl (unspecifie~</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># vide initialement</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(engins_obs, source <span class="sc">==</span> <span class="st">&quot;observateur&quot;</span>))</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cor) <span class="co"># 5 lignes</span></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe[cor] <span class="ot">&lt;-</span> grp[<span class="dv">1</span>]</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(engins_obs, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span> <span class="sc">&amp;</span> engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;OTB2&quot;</span>, <span class="st">&quot;OTM&quot;</span>)))</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cor) <span class="co"># 2 lignes</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe[cor] <span class="ot">&lt;-</span> grp[<span class="dv">2</span>]</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(engins_obs, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span> <span class="sc">&amp;</span> engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;SDN&quot;</span>, <span class="st">&quot;PS&quot;</span>)))</span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cor) <span class="co"># 2 lignes</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe[cor] <span class="ot">&lt;-</span> grp[<span class="dv">3</span>]</span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(engins_obs, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span> <span class="sc">&amp;</span> engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;GN&quot;</span>, <span class="st">&quot;GNS&quot;</span>)))</span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cor) <span class="co"># 2 lignes</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe[cor] <span class="ot">&lt;-</span> grp[<span class="dv">4</span>]</span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(engins_obs, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span> <span class="sc">&amp;</span> engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;LL&quot;</span>, <span class="st">&quot;LLS&quot;</span>)))</span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cor) <span class="co"># 2 lignes</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe[cor] <span class="ot">&lt;-</span> grp[<span class="dv">5</span>]</span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(engins_obs, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span> <span class="sc">&amp;</span> engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;LHP&quot;</span>, <span class="st">&quot;LLG&quot;</span>, <span class="st">&quot;LX&quot;</span>)))</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cor) <span class="co"># 3 lignes</span></span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe[cor] <span class="ot">&lt;-</span> grp[<span class="dv">6</span>]</span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(engins_obs, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span> <span class="sc">&amp;</span> engin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;FPN&quot;</span>, <span class="st">&quot;FIX&quot;</span>)))</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cor) <span class="co"># 2 lignes</span></span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe[cor] <span class="ot">&lt;-</span> grp[<span class="dv">7</span>]</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(engins_obs, <span class="fu">is.na</span>(engin_groupe)))</span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cor) <span class="co"># 0 ligne</span></span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a><span class="co">#engins_obs$engin_groupe[cor] &lt;- grp[8] # autres engins ou inconnus. Non-utilisé ici.</span></span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(engins_obs<span class="sc">$</span>engin_groupe, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>) <span class="co"># 0 valeur NA = parfait</span></span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a><span class="do">##      Gillnets     Hand gear     Longlines  Other trawls        Seines </span></span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a><span class="do">##             2             3             2             2             2 </span></span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a><span class="do">## Shrimp trawls         Traps          &lt;NA&gt; </span></span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a><span class="do">##             5             2             0</span></span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a>engins_obs<span class="sc">$</span>engin_groupe <span class="ot">&lt;-</span> <span class="fu">factor</span>(engins_obs<span class="sc">$</span>engin_groupe, <span class="at">levels =</span> grp[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">ordered =</span> T)</span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(engins_obs, <span class="at">file =</span> dat_engin_obs)</span></code></pre></div>
</div>
</div>
<div id="tableaux-résumés" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Tableaux résumés</h1>
<div id="fl-1" class="section level2 tabset" number="8.1">
<h2 class="tabset"><span class="header-section-number">8.1</span> FL</h2>
<div id="table1-état-au-débarquement" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> <code>table1</code>: état au débarquement</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>etat <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># seulement les données à quai</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span> <span class="co"># 1 ligne par échantillon de FL</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(annee, etat_deb) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">etat_deb =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, etat_deb)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;etat_deb&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;n&quot;</span>, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>pese <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># seulement les données à quai </span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span> <span class="co"># 1 ligne par échantillon de FL</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">n_total =</span> <span class="fu">n</span>(),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nb_pds_ech =</span> <span class="fu">NROW</span>(pds_ech[<span class="fu">is.na</span>(pds_ech)]),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">perc_ech =</span> (nb_pds_ech <span class="sc">/</span> n_total) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nb_pds_deb =</span> <span class="fu">NROW</span>(pds_deb[<span class="fu">is.na</span>(pds_deb)]),</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">perc_deb =</span> (nb_pds_deb <span class="sc">/</span> n_total) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        ungroup</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(etat, pese, <span class="at">by =</span> <span class="st">&quot;annee&quot;</span>)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>tot <span class="ot">&lt;-</span> table1 <span class="sc">%&gt;%</span> </span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>       <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">8</span>), <span class="at">.fns =</span> sum)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>tot <span class="ot">&lt;-</span> <span class="fu">left_join</span>(tot, tot <span class="sc">%&gt;%</span> </span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mutate</span>(<span class="at">perc_ech =</span> <span class="fu">round</span>(nb_pds_ech <span class="sc">/</span> n_total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>                             <span class="at">perc_deb =</span> <span class="fu">round</span>(nb_pds_deb <span class="sc">/</span> n_total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(annee, perc_ech, perc_deb),</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">by =</span> <span class="st">&quot;annee&quot;</span>)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(table1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">as.character</span>(annee)), tot)</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table1) <span class="co"># 29 obs et 9 var</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29  9</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(etat, pese, tot)</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Inventaire des échantillons de fréquence de longueur selon l’état au débarquement et l’année de prélèvement.  Le nombre annuel d’échantillons dont soit le poids d’échantillon ou le poids du débarquement n’est pas fourni est également montré. Source: données du programme d&#39;échantillonnage commercial du MPO.&quot;</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, <span class="st">&quot;Entier&quot;</span>, <span class="st">&quot;Éviscéré non-étêté&quot;</span>, <span class="st">&quot;Inconnu&quot;</span>, <span class="st">&quot;Total&quot;</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Nb&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">% du total&quot;</span>), <span class="dv">2</span>))</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  headers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;État au débarquement&quot;</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">&quot;Échantillons non-pesés&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Débarquements non-pesés&quot;</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Inventory of length frequency samples according to the state at landing and the year of collection. The annual number of samples where either the sample weight or the landing weight is not reported are provided. Source: DFO port sampling program data.&quot;</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Whole&quot;</span>, <span class="st">&quot;Gutted head on&quot;</span>, <span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Total&quot;</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Nb&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">% of total&quot;</span>), <span class="dv">2</span>))</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  headers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;State at landing&quot;</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">&quot;Unweighted samples&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Unweighted landings&quot;</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table1, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">%&gt;%</span> </span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="at">.vars =</span> <span class="fu">c</span>(<span class="st">&quot;perc_ech&quot;</span>, <span class="st">&quot;perc_deb&quot;</span>), <span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">round</span>(x, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="at">.vars =</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(table1), <span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;&quot;</span>, <span class="fu">format</span>(x, <span class="at">big.mark =</span> bm, <span class="at">decimal.mark =</span> dm))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="at">header =</span> headers, <span class="at">bold =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en foncé</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Inventory of length frequency samples according to the state at landing and the year of collection. The annual number of samples where either the sample weight or the landing weight is not reported are provided. Source: DFO port sampling program data.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
State at landing
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Unweighted samples
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Unweighted landings
</div>
</th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Whole
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Gutted head on
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Unknown
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Nb
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
% of total
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Nb
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
% of total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
8.9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.6
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
92.3
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
92.3
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
772
</td>
<td style="text-align:right;">
778
</td>
<td style="text-align:right;">
772
</td>
<td style="text-align:right;">
99.2
</td>
<td style="text-align:right;">
774
</td>
<td style="text-align:right;">
99.5
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
407
</td>
<td style="text-align:right;">
418
</td>
<td style="text-align:right;">
407
</td>
<td style="text-align:right;">
97.4
</td>
<td style="text-align:right;">
407
</td>
<td style="text-align:right;">
97.4
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
227
</td>
<td style="text-align:right;">
383
</td>
<td style="text-align:right;">
299
</td>
<td style="text-align:right;">
78.1
</td>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
77.8
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
38.1
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.4
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.8
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
10.7
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
12.5
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
11.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.9
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
11.9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.4
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
9.3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7.0
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
15.6
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
19.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.2
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
14.3
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
23.1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.8
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
20.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
42.1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.3
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
36.4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
9.1
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
16.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
17.2
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
20.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
229
</td>
<td style="text-align:right;font-weight: bold;">
716
</td>
<td style="text-align:right;font-weight: bold;">
1,478
</td>
<td style="text-align:right;font-weight: bold;">
2,423
</td>
<td style="text-align:right;font-weight: bold;">
1,652
</td>
<td style="text-align:right;font-weight: bold;">
68.2
</td>
<td style="text-align:right;font-weight: bold;">
1,564
</td>
<td style="text-align:right;font-weight: bold;">
64.5
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor)</span></code></pre></div>
</div>
<div id="table2-annéemois" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> <code>table2</code>: ~ année–mois</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">mois =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-mois à remplir</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, mois) <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">n_distinct</span>(ech_id),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(n_mes, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">mois =</span> <span class="fu">as.character</span>(mois),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mois =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(mois) <span class="sc">%&gt;%</span> </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mois =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4) <span class="sc">%&gt;%</span> </span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">nb_ech =</span> <span class="fu">format</span>(nb_ech, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">nb_morues =</span> <span class="fu">format</span>(nb_morues, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">ifelse</span>(nb_ech <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, <span class="fu">paste0</span>(nb_ech, <span class="st">&quot; (&quot;</span>, nb_morues, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table2) <span class="co"># 377 obs et 2 var</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 377   2</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table2, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;mois&quot;</span>))</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table2) <span class="co"># 377 obs et 5 var</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 377   5</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> table2 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;mois&quot;</span>, <span class="at">names_prefix =</span> <span class="st">&quot;M&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;label&quot;</span>)</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table2) <span class="co"># 29 obs et 14 var</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29 14</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>  mois <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jan.&quot;</span>, <span class="st">&quot;Fév.&quot;</span>, <span class="st">&quot;Mar.&quot;</span>, <span class="st">&quot;Avr.&quot;</span>, <span class="st">&quot;Mai&quot;</span>, <span class="st">&quot;Juin&quot;</span>, <span class="st">&quot;Juil.&quot;</span>, <span class="st">&quot;Août&quot;</span>, <span class="st">&quot;Sept.&quot;</span>, <span class="st">&quot;Oct.&quot;</span>, <span class="st">&quot;Nov.&quot;</span>, <span class="st">&quot;Déc.&quot;</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Effectif en échantillons de morues franches collectés pour les fréquences de longueur dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et mois. Les valeurs entre parenthèses sont les effectifs en morues. Source: données du programme d&#39;échantillonnage commercial du MPO.&quot;</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, mois, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>  mois <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jan.&quot;</span>, <span class="st">&quot;Feb.&quot;</span>, <span class="st">&quot;Mar.&quot;</span>, <span class="st">&quot;Apr.&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="st">&quot;July&quot;</span>, <span class="st">&quot;Aug.&quot;</span>, <span class="st">&quot;Sept.&quot;</span>, <span class="st">&quot;Oct.&quot;</span>, <span class="st">&quot;Nov.&quot;</span>, <span class="st">&quot;Dec.&quot;</span>)</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Number of Atlantic cod samples collected for length frequencies in the commercial fishery of NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and month. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.&quot;</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, mois, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table2, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span> </span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, x)) <span class="sc">%&gt;%</span>  </span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en foncé</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Number of Atlantic cod samples collected for length frequencies in the commercial fishery of NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and month. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Jan. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Feb. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Mar. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Apr. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
May
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
June
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
July
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Aug. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sept. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Oct. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Nov. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Dec. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (1,512)
</td>
<td style="text-align:right;">
6 (1,535)
</td>
<td style="text-align:right;">
22 (5,300)
</td>
<td style="text-align:right;">
27 (7,317)
</td>
<td style="text-align:right;">
44 (10,922)
</td>
<td style="text-align:right;">
15 (3,301)
</td>
<td style="text-align:right;">
17 (3,796)
</td>
<td style="text-align:right;">
18 (4,255)
</td>
<td style="text-align:right;">
13 (3,259)
</td>
<td style="text-align:right;">
1 (254)
</td>
<td style="text-align:right;">
169 (41,451)
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (250)
</td>
<td style="text-align:right;">
2 (486)
</td>
<td style="text-align:right;">
1 (257)
</td>
<td style="text-align:right;">
1 (204)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
9 (28)
</td>
<td style="text-align:right;">
64 (926)
</td>
<td style="text-align:right;">
78 (2,151)
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
33 (324)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
48 (396)
</td>
<td style="text-align:right;">
21 (487)
</td>
<td style="text-align:right;">
1 (251)
</td>
<td style="text-align:right;">
101 (1,051)
</td>
<td style="text-align:right;">
249 (2,859)
</td>
<td style="text-align:right;">
187 (2,887)
</td>
<td style="text-align:right;">
112 (1,485)
</td>
<td style="text-align:right;">
21 (693)
</td>
<td style="text-align:right;">
5 (117)
</td>
<td style="text-align:right;">
778 (10,550)
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (250)
</td>
<td style="text-align:right;">
14 (664)
</td>
<td style="text-align:right;">
138 (2,292)
</td>
<td style="text-align:right;">
136 (3,169)
</td>
<td style="text-align:right;">
96 (1,280)
</td>
<td style="text-align:right;">
19 (425)
</td>
<td style="text-align:right;">
12 (569)
</td>
<td style="text-align:right;">
2 (39)
</td>
<td style="text-align:right;">
418 (8,688)
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
1 (9)
</td>
<td style="text-align:right;">
3 (59)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (1,094)
</td>
<td style="text-align:right;">
21 (1,131)
</td>
<td style="text-align:right;">
119 (11,114)
</td>
<td style="text-align:right;">
92 (4,366)
</td>
<td style="text-align:right;">
102 (5,857)
</td>
<td style="text-align:right;">
27 (2,030)
</td>
<td style="text-align:right;">
8 (710)
</td>
<td style="text-align:right;">
4 (98)
</td>
<td style="text-align:right;">
383 (26,468)
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (249)
</td>
<td style="text-align:right;">
4 (531)
</td>
<td style="text-align:right;">
7 (1,559)
</td>
<td style="text-align:right;">
6 (1,266)
</td>
<td style="text-align:right;">
2 (486)
</td>
<td style="text-align:right;">
1 (256)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (4,347)
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (270)
</td>
<td style="text-align:right;">
4 (733)
</td>
<td style="text-align:right;">
15 (2,929)
</td>
<td style="text-align:right;">
12 (2,250)
</td>
<td style="text-align:right;">
5 (1,143)
</td>
<td style="text-align:right;">
5 (700)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
42 (8,025)
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (1,237)
</td>
<td style="text-align:right;">
3 (631)
</td>
<td style="text-align:right;">
8 (1,782)
</td>
<td style="text-align:right;">
12 (2,313)
</td>
<td style="text-align:right;">
6 (1,472)
</td>
<td style="text-align:right;">
2 (442)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36 (7,877)
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (935)
</td>
<td style="text-align:right;">
5 (1,097)
</td>
<td style="text-align:right;">
9 (1,974)
</td>
<td style="text-align:right;">
7 (1,320)
</td>
<td style="text-align:right;">
6 (1,088)
</td>
<td style="text-align:right;">
4 (1,020)
</td>
<td style="text-align:right;">
1 (252)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36 (7,686)
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (1,012)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
8 (1,761)
</td>
<td style="text-align:right;">
9 (1,627)
</td>
<td style="text-align:right;">
5 (1,262)
</td>
<td style="text-align:right;">
2 (470)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28 (6,132)
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (605)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (605)
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (252)
</td>
<td style="text-align:right;">
2 (473)
</td>
<td style="text-align:right;">
13 (2,781)
</td>
<td style="text-align:right;">
2 (352)
</td>
<td style="text-align:right;">
5 (889)
</td>
<td style="text-align:right;">
1 (122)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24 (4,869)
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (507)
</td>
<td style="text-align:right;">
19 (2,954)
</td>
<td style="text-align:right;">
7 (1,167)
</td>
<td style="text-align:right;">
3 (464)
</td>
<td style="text-align:right;">
2 (259)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
34 (5,351)
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (161)
</td>
<td style="text-align:right;">
25 (3,868)
</td>
<td style="text-align:right;">
7 (1,041)
</td>
<td style="text-align:right;">
7 (1,028)
</td>
<td style="text-align:right;">
2 (320)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
42 (6,418)
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (163)
</td>
<td style="text-align:right;">
2 (312)
</td>
<td style="text-align:right;">
23 (3,584)
</td>
<td style="text-align:right;">
2 (314)
</td>
<td style="text-align:right;">
8 (1,023)
</td>
<td style="text-align:right;">
7 (1,131)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
43 (6,527)
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (152)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (1,973)
</td>
<td style="text-align:right;">
6 (930)
</td>
<td style="text-align:right;">
9 (1,368)
</td>
<td style="text-align:right;">
3 (435)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32 (4,858)
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
14 (3,217)
</td>
<td style="text-align:right;">
3 (535)
</td>
<td style="text-align:right;">
10 (1,358)
</td>
<td style="text-align:right;">
4 (701)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
31 (5,811)
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (165)
</td>
<td style="text-align:right;">
10 (1,470)
</td>
<td style="text-align:right;">
8 (1,123)
</td>
<td style="text-align:right;">
7 (949)
</td>
<td style="text-align:right;">
2 (269)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28 (3,976)
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (117)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (1,795)
</td>
<td style="text-align:right;">
5 (780)
</td>
<td style="text-align:right;">
7 (1,168)
</td>
<td style="text-align:right;">
1 (151)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (4,011)
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (17)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (158)
</td>
<td style="text-align:right;">
9 (1,505)
</td>
<td style="text-align:right;">
3 (453)
</td>
<td style="text-align:right;">
3 (601)
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
2 (451)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
20 (3,335)
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (154)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (1,866)
</td>
<td style="text-align:right;">
2 (309)
</td>
<td style="text-align:right;">
4 (681)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19 (3,010)
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
9 (1,415)
</td>
<td style="text-align:right;">
2 (303)
</td>
<td style="text-align:right;">
5 (767)
</td>
<td style="text-align:right;">
1 (152)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
17 (2,637)
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
10 (1,535)
</td>
<td style="text-align:right;">
2 (300)
</td>
<td style="text-align:right;">
2 (300)
</td>
<td style="text-align:right;">
1 (154)
</td>
<td style="text-align:right;">
6 (950)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
22 (3,389)
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (2,017)
</td>
<td style="text-align:right;">
5 (646)
</td>
<td style="text-align:right;">
2 (367)
</td>
<td style="text-align:right;">
1 (152)
</td>
<td style="text-align:right;">
4 (1,066)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25 (4,248)
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (185)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (481)
</td>
<td style="text-align:right;">
11 (1,859)
</td>
<td style="text-align:right;">
6 (890)
</td>
<td style="text-align:right;">
6 (856)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (349)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
29 (4,620)
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (1,887)
</td>
<td style="text-align:right;">
4 (528)
</td>
<td style="text-align:right;">
2 (306)
</td>
<td style="text-align:right;">
6 (1,001)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25 (3,872)
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (156)
</td>
<td style="text-align:right;">
1 (148)
</td>
<td style="text-align:right;">
4 (460)
</td>
<td style="text-align:right;">
1 (152)
</td>
<td style="text-align:right;">
2 (302)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (168)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10 (1,386)
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (151)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
2 (309)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (610)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
34 (333)
</td>
<td style="text-align:right;font-weight: bold;">
3 (59)
</td>
<td style="text-align:right;font-weight: bold;">
6 (1,512)
</td>
<td style="text-align:right;font-weight: bold;">
57 (2,283)
</td>
<td style="text-align:right;font-weight: bold;">
72 (12,078)
</td>
<td style="text-align:right;font-weight: bold;">
97 (15,547)
</td>
<td style="text-align:right;font-weight: bold;">
662 (70,432)
</td>
<td style="text-align:right;font-weight: bold;">
605 (32,648)
</td>
<td style="text-align:right;font-weight: bold;">
510 (32,007)
</td>
<td style="text-align:right;font-weight: bold;">
222 (16,080)
</td>
<td style="text-align:right;font-weight: bold;">
79 (8,495)
</td>
<td style="text-align:right;font-weight: bold;">
76 (1,434)
</td>
<td style="text-align:right;font-weight: bold;">
2,423 (192,908)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor)</span></code></pre></div>
</div>
<div id="table3-annéeopano" class="section level3" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> <code>table3</code>: ~ année–OPANO</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">unique</span>(lf<span class="sc">$</span>opano); op</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;3Pn&quot; &quot;4R&quot;  &quot;4Ra&quot; &quot;4Rb&quot; &quot;4Rc&quot; &quot;4Rd&quot; &quot;4S&quot;  &quot;4Si&quot; &quot;4Ss&quot; &quot;4Sv&quot; &quot;4Sw&quot; &quot;4Sx&quot;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] &quot;4Sy&quot; &quot;4Sz&quot;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>table3 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">opano =</span> <span class="fu">c</span>(op, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-opano à remplir</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, opano) <span class="sc">%&gt;%</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">n_distinct</span>(ech_id),</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(n_mes, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">opano =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(opano) <span class="sc">%&gt;%</span> </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>,</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">opano =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4) <span class="sc">%&gt;%</span> </span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">nb_ech =</span> <span class="fu">format</span>(nb_ech, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">nb_morues =</span> <span class="fu">format</span>(nb_morues, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">ifelse</span>(nb_ech <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, <span class="fu">paste0</span>(nb_ech, <span class="st">&quot; (&quot;</span>, nb_morues, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table3) <span class="co"># 435 obs et 2 var</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 435   2</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>table3 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table3, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;opano&quot;</span>))</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table3) <span class="co"># 435 obs et 5 var</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 435   5</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>table3 <span class="ot">&lt;-</span> table3 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;opano&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;label&quot;</span>)</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table3) <span class="co"># 29 obs et 16 var</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29 16</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(table3) <span class="ot">&lt;-</span> <span class="fu">recode</span>(<span class="fu">names</span>(table3), <span class="st">&quot;4R&quot;</span> <span class="ot">=</span> <span class="st">&quot;4Ru&quot;</span>, <span class="st">&quot;4S&quot;</span> <span class="ot">=</span> <span class="st">&quot;4Su&quot;</span>)</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">names</span>(table3)[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(table3) <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Effectif en échantillons de morues franches collectés pour les fréquences de longueur dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et zone unitaire de l&#39;OPANO. Les valeurs entre parenthèses sont les effectifs en morues. Source: données du programme d&#39;échantillonnage commercial du MPO.&quot;</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, op, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Number of Atlantic cod samples collected for length frequencies in the commercial fishery of NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and NAFO sub-division. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.&quot;</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, op, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table3, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> </span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, x)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en foncé</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Number of Atlantic cod samples collected for length frequencies in the commercial fishery of NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and NAFO sub-division. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
3Pn
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Ru
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Ra
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rb
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rc
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Su
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Si
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Ss
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sw
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sx
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sy
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sz
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
24 (5,652)
</td>
<td style="text-align:right;">
1 (242)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
81 (20,611)
</td>
<td style="text-align:right;">
18 (3,837)
</td>
<td style="text-align:right;">
17 (4,222)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (502)
</td>
<td style="text-align:right;">
1 (250)
</td>
<td style="text-align:right;">
4 (1,001)
</td>
<td style="text-align:right;">
11 (2,532)
</td>
<td style="text-align:right;">
5 (1,264)
</td>
<td style="text-align:right;">
1 (255)
</td>
<td style="text-align:right;">
4 (1,083)
</td>
<td style="text-align:right;">
169 (41,451)
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
36 (751)
</td>
<td style="text-align:right;">
22 (160)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (5)
</td>
<td style="text-align:right;">
1 (250)
</td>
<td style="text-align:right;">
6 (973)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (3)
</td>
<td style="text-align:right;">
8 (9)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
78 (2,151)
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
168 (3,412)
</td>
<td style="text-align:right;">
2 (7)
</td>
<td style="text-align:right;">
196 (2,066)
</td>
<td style="text-align:right;">
62 (583)
</td>
<td style="text-align:right;">
54 (1,042)
</td>
<td style="text-align:right;">
84 (1,311)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (251)
</td>
<td style="text-align:right;">
58 (638)
</td>
<td style="text-align:right;">
153 (1,240)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
778 (10,550)
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
29 (941)
</td>
<td style="text-align:right;">
99 (1,517)
</td>
<td style="text-align:right;">
16 (184)
</td>
<td style="text-align:right;">
27 (231)
</td>
<td style="text-align:right;">
2 (26)
</td>
<td style="text-align:right;">
37 (2,424)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (121)
</td>
<td style="text-align:right;">
53 (826)
</td>
<td style="text-align:right;">
154 (2,418)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
418 (8,688)
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
51 (5,276)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
56 (1,524)
</td>
<td style="text-align:right;">
104 (11,554)
</td>
<td style="text-align:right;">
34 (2,184)
</td>
<td style="text-align:right;">
32 (1,909)
</td>
<td style="text-align:right;">
1 (4)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (260)
</td>
<td style="text-align:right;">
30 (670)
</td>
<td style="text-align:right;">
70 (2,832)
</td>
<td style="text-align:right;">
1 (251)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (4)
</td>
<td style="text-align:right;">
383 (26,468)
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
2 (503)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
7 (985)
</td>
<td style="text-align:right;">
2 (506)
</td>
<td style="text-align:right;">
1 (256)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (251)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
8 (1,846)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (4,347)
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (3,004)
</td>
<td style="text-align:right;">
4 (1,024)
</td>
<td style="text-align:right;">
2 (520)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (782)
</td>
<td style="text-align:right;">
12 (2,695)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
42 (8,025)
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
4 (1,001)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
18 (3,226)
</td>
<td style="text-align:right;">
3 (785)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (484)
</td>
<td style="text-align:right;">
1 (255)
</td>
<td style="text-align:right;">
6 (1,572)
</td>
<td style="text-align:right;">
2 (554)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36 (7,877)
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
3 (562)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (2,190)
</td>
<td style="text-align:right;">
12 (3,065)
</td>
<td style="text-align:right;">
2 (286)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (463)
</td>
<td style="text-align:right;">
4 (872)
</td>
<td style="text-align:right;">
1 (248)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36 (7,686)
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
6 (1,279)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (2,324)
</td>
<td style="text-align:right;">
3 (798)
</td>
<td style="text-align:right;">
1 (165)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (752)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (814)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28 (6,132)
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (248)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (357)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (605)
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
2 (505)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (2,314)
</td>
<td style="text-align:right;">
1 (207)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (252)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (572)
</td>
<td style="text-align:right;">
2 (482)
</td>
<td style="text-align:right;">
2 (537)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24 (4,869)
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
1 (199)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (157)
</td>
<td style="text-align:right;">
22 (3,386)
</td>
<td style="text-align:right;">
2 (310)
</td>
<td style="text-align:right;">
4 (643)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (656)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
34 (5,351)
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (3,197)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
8 (1,272)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (907)
</td>
<td style="text-align:right;">
5 (794)
</td>
<td style="text-align:right;">
1 (161)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (87)
</td>
<td style="text-align:right;">
42 (6,418)
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (172)
</td>
<td style="text-align:right;">
20 (2,941)
</td>
<td style="text-align:right;">
7 (1,100)
</td>
<td style="text-align:right;">
3 (476)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (312)
</td>
<td style="text-align:right;">
6 (906)
</td>
<td style="text-align:right;">
4 (620)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
43 (6,527)
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (251)
</td>
<td style="text-align:right;">
15 (2,266)
</td>
<td style="text-align:right;">
3 (461)
</td>
<td style="text-align:right;">
4 (608)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (151)
</td>
<td style="text-align:right;">
7 (1,121)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32 (4,858)
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (219)
</td>
<td style="text-align:right;">
19 (3,291)
</td>
<td style="text-align:right;">
1 (227)
</td>
<td style="text-align:right;">
1 (199)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (347)
</td>
<td style="text-align:right;">
6 (1,528)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
31 (5,811)
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (356)
</td>
<td style="text-align:right;">
1 (155)
</td>
<td style="text-align:right;">
12 (1,505)
</td>
<td style="text-align:right;">
1 (156)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (764)
</td>
<td style="text-align:right;">
4 (741)
</td>
<td style="text-align:right;">
2 (299)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28 (3,976)
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
2 (339)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (89)
</td>
<td style="text-align:right;">
9 (1,310)
</td>
<td style="text-align:right;">
1 (161)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (466)
</td>
<td style="text-align:right;">
6 (1,077)
</td>
<td style="text-align:right;">
4 (569)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (4,011)
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
3 (468)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (983)
</td>
<td style="text-align:right;">
1 (158)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (668)
</td>
<td style="text-align:right;">
6 (908)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
20 (3,335)
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (966)
</td>
<td style="text-align:right;">
2 (312)
</td>
<td style="text-align:right;">
1 (159)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (462)
</td>
<td style="text-align:right;">
6 (956)
</td>
<td style="text-align:right;">
1 (155)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19 (3,010)
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (769)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (121)
</td>
<td style="text-align:right;">
1 (152)
</td>
<td style="text-align:right;">
1 (163)
</td>
<td style="text-align:right;">
6 (982)
</td>
<td style="text-align:right;">
3 (450)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
17 (2,637)
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
1 (148)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (478)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (802)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
3 (454)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (1,006)
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (201)
</td>
<td style="text-align:right;">
22 (3,389)
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
7 (1,079)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (1,066)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (45)
</td>
<td style="text-align:right;">
1 (152)
</td>
<td style="text-align:right;">
4 (700)
</td>
<td style="text-align:right;">
7 (1,053)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (153)
</td>
<td style="text-align:right;">
25 (4,248)
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
4 (694)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (767)
</td>
<td style="text-align:right;">
4 (625)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
2 (321)
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
1 (153)
</td>
<td style="text-align:right;">
5 (713)
</td>
<td style="text-align:right;">
4 (596)
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
2 (301)
</td>
<td style="text-align:right;">
29 (4,620)
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (112)
</td>
<td style="text-align:right;">
10 (1,586)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
1 (155)
</td>
<td style="text-align:right;">
2 (305)
</td>
<td style="text-align:right;">
5 (802)
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (612)
</td>
<td style="text-align:right;">
25 (3,872)
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (45)
</td>
<td style="text-align:right;">
1 (115)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (168)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (458)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (151)
</td>
<td style="text-align:right;">
2 (299)
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
10 (1,386)
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (151)
</td>
<td style="text-align:right;">
1 (152)
</td>
<td style="text-align:right;">
1 (157)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (150)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (610)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
336 (21,730)
</td>
<td style="text-align:right;font-weight: bold;">
127 (2,282)
</td>
<td style="text-align:right;font-weight: bold;">
282 (5,741)
</td>
<td style="text-align:right;font-weight: bold;">
520 (71,524)
</td>
<td style="text-align:right;font-weight: bold;">
153 (16,857)
</td>
<td style="text-align:right;font-weight: bold;">
213 (17,459)
</td>
<td style="text-align:right;font-weight: bold;">
3 (406)
</td>
<td style="text-align:right;font-weight: bold;">
11 (1,853)
</td>
<td style="text-align:right;font-weight: bold;">
26 (4,868)
</td>
<td style="text-align:right;font-weight: bold;">
186 (10,053)
</td>
<td style="text-align:right;font-weight: bold;">
503 (29,731)
</td>
<td style="text-align:right;font-weight: bold;">
40 (6,959)
</td>
<td style="text-align:right;font-weight: bold;">
5 (854)
</td>
<td style="text-align:right;font-weight: bold;">
18 (2,591)
</td>
<td style="text-align:right;font-weight: bold;">
2,423 (192,908)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(op)</span></code></pre></div>
</div>
<div id="table4-annéeengin_cat" class="section level3" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> <code>table4</code>: ~ année–<em>engin_cat</em></h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>engins <span class="ot">&lt;-</span> <span class="fu">levels</span>(engins_obs<span class="sc">$</span>engin_groupe); engins</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Shrimp trawls&quot; &quot;Other trawls&quot;  &quot;Seines&quot;        &quot;Gillnets&quot;     </span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [5] &quot;Longlines&quot;     &quot;Hand gear&quot;     &quot;Traps&quot;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>table4 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">engin_groupe =</span> <span class="fu">c</span>(engins, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-engin à remplir</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(., engins_obs, <span class="at">by =</span> <span class="st">&quot;engin&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, engin_groupe) <span class="sc">%&gt;%</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">n_distinct</span>(ech_id),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(n_mes, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">engin_groupe =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(engin_groupe) <span class="sc">%&gt;%</span> </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">engin_groupe =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4) <span class="sc">%&gt;%</span> </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">nb_ech =</span> <span class="fu">format</span>(nb_ech, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">nb_morues =</span> <span class="fu">format</span>(nb_morues, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">ifelse</span>(nb_ech <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, <span class="fu">paste0</span>(nb_ech, <span class="st">&quot; (&quot;</span>, nb_morues, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table4) <span class="co"># 232 obs et 2 var</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 232   2</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>table4 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table4, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;engin_groupe&quot;</span>))</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table4) <span class="co"># 232 obs et 5 var</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 232   5</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>table4 <span class="ot">&lt;-</span> table4 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;engin_groupe&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;label&quot;</span>)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table4) <span class="co"># 29 obs et 9 var</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29  9</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>engin <span class="ot">&lt;-</span> <span class="fu">names</span>(table4)[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(table4) <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Effectif en échantillons de morues franches collectés pour les fréquences de longueur dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et regroupement d&#39;engin. Les valeurs entre parenthèses sont les effectifs en morues. Source: données du programme d&#39;échantillonnage commercial du MPO.&quot;</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, engin, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Number of Atlantic cod samples collected for length frequencies in the commercial fishery of NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and gear grouping. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.&quot;</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, engin, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table4, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>table4 <span class="sc">%&gt;%</span> </span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, x)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en gras</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Number of Atlantic cod samples collected for length frequencies in the commercial fishery of NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and gear grouping. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Shrimp trawls
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Other trawls
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Seines
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Gillnets
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Longlines
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Hand gear
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Traps
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
58 (15,303)
</td>
<td style="text-align:right;">
59 (15,557)
</td>
<td style="text-align:right;">
10 (2,451)
</td>
<td style="text-align:right;">
33 (7,188)
</td>
<td style="text-align:right;">
30 (7,021)
</td>
<td style="text-align:right;">
5 (905)
</td>
<td style="text-align:right;">
32 (8,329)
</td>
<td style="text-align:right;">
227 (56,754)
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
1 (190)
</td>
<td style="text-align:right;">
1 (190)
</td>
<td style="text-align:right;">
4 (947)
</td>
<td style="text-align:right;">
9 (12)
</td>
<td style="text-align:right;">
64 (1,002)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
79 (2,341)
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (494)
</td>
<td style="text-align:right;">
350 (3,490)
</td>
<td style="text-align:right;">
389 (6,225)
</td>
<td style="text-align:right;">
5 (99)
</td>
<td style="text-align:right;">
30 (242)
</td>
<td style="text-align:right;">
778 (10,550)
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
1 (121)
</td>
<td style="text-align:right;">
1 (121)
</td>
<td style="text-align:right;">
9 (1,958)
</td>
<td style="text-align:right;">
249 (3,809)
</td>
<td style="text-align:right;">
130 (2,382)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
29 (418)
</td>
<td style="text-align:right;">
419 (8,809)
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (264)
</td>
<td style="text-align:right;">
150 (3,056)
</td>
<td style="text-align:right;">
103 (8,377)
</td>
<td style="text-align:right;">
111 (14,552)
</td>
<td style="text-align:right;">
17 (219)
</td>
<td style="text-align:right;">
383 (26,468)
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (1,081)
</td>
<td style="text-align:right;">
7 (1,766)
</td>
<td style="text-align:right;">
9 (1,500)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (4,347)
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
30 (4,937)
</td>
<td style="text-align:right;">
6 (1,544)
</td>
<td style="text-align:right;">
6 (1,544)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
42 (8,025)
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
18 (3,279)
</td>
<td style="text-align:right;">
16 (4,012)
</td>
<td style="text-align:right;">
2 (586)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36 (7,877)
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (286)
</td>
<td style="text-align:right;">
14 (2,605)
</td>
<td style="text-align:right;">
18 (4,361)
</td>
<td style="text-align:right;">
2 (434)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36 (7,686)
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (165)
</td>
<td style="text-align:right;">
9 (1,659)
</td>
<td style="text-align:right;">
18 (4,308)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28 (6,132)
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (605)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (605)
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
11 (1,834)
</td>
<td style="text-align:right;">
13 (3,035)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24 (4,869)
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (189)
</td>
<td style="text-align:right;">
24 (3,715)
</td>
<td style="text-align:right;">
9 (1,447)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
34 (5,351)
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
29 (4,349)
</td>
<td style="text-align:right;">
12 (1,890)
</td>
<td style="text-align:right;">
1 (179)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
42 (6,418)
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
27 (4,104)
</td>
<td style="text-align:right;">
16 (2,423)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
43 (6,527)
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
22 (3,308)
</td>
<td style="text-align:right;">
10 (1,550)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32 (4,858)
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19 (3,625)
</td>
<td style="text-align:right;">
11 (1,947)
</td>
<td style="text-align:right;">
1 (239)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
31 (5,811)
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
18 (2,398)
</td>
<td style="text-align:right;">
9 (1,389)
</td>
<td style="text-align:right;">
1 (189)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28 (3,976)
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
15 (2,323)
</td>
<td style="text-align:right;">
10 (1,535)
</td>
<td style="text-align:right;">
1 (153)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (4,011)
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
11 (2,129)
</td>
<td style="text-align:right;">
8 (1,075)
</td>
<td style="text-align:right;">
1 (131)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
20 (3,335)
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (1,921)
</td>
<td style="text-align:right;">
5 (779)
</td>
<td style="text-align:right;">
2 (310)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19 (3,010)
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
9 (1,443)
</td>
<td style="text-align:right;">
6 (886)
</td>
<td style="text-align:right;">
2 (308)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
17 (2,637)
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10 (1,535)
</td>
<td style="text-align:right;">
12 (1,854)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
22 (3,389)
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10 (1,565)
</td>
<td style="text-align:right;">
15 (2,683)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25 (4,248)
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
11 (1,699)
</td>
<td style="text-align:right;">
17 (2,766)
</td>
<td style="text-align:right;">
1 (155)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
29 (4,620)
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (1,987)
</td>
<td style="text-align:right;">
12 (1,885)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25 (3,872)
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (312)
</td>
<td style="text-align:right;">
7 (1,074)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10 (1,386)
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (610)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (610)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
60 (15,614)
</td>
<td style="text-align:right;font-weight: bold;">
61 (15,868)
</td>
<td style="text-align:right;font-weight: bold;">
33 (6,754)
</td>
<td style="text-align:right;font-weight: bold;">
1,111 (69,363)
</td>
<td style="text-align:right;font-weight: bold;">
960 (70,431)
</td>
<td style="text-align:right;font-weight: bold;">
150 (21,284)
</td>
<td style="text-align:right;font-weight: bold;">
108 (9,208)
</td>
<td style="text-align:right;font-weight: bold;">
2,483 (208,522)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor, engins)</span></code></pre></div>
</div>
</div>
<div id="âge" class="section level2 tabset" number="8.2">
<h2 class="tabset"><span class="header-section-number">8.2</span> Âge</h2>
<div id="table5-annéemois" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> <code>table5</code>: ~ année–mois</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>table5 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">mois =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-mois à remplir</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> bio <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, mois) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">n_distinct</span>(ech_id),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">mois =</span> <span class="fu">as.character</span>(mois),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mois =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(mois) <span class="sc">%&gt;%</span> </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>,</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mois =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4) <span class="sc">%&gt;%</span> </span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">nb_ech =</span> <span class="fu">format</span>(nb_ech, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">nb_morues =</span> <span class="fu">format</span>(nb_morues, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">ifelse</span>(nb_ech <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, <span class="fu">paste0</span>(nb_ech, <span class="st">&quot; (&quot;</span>, nb_morues, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table5) <span class="co"># 377 obs et 2 var</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 377   2</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>table5 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table5, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;mois&quot;</span>))</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table5) <span class="co"># 377 obs et 5 var</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 377   5</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>table5 <span class="ot">&lt;-</span> table5 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;mois&quot;</span>, <span class="at">names_prefix =</span> <span class="st">&quot;M&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;label&quot;</span>)</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table5) <span class="co"># 29 obs et 14 var</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29 14</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>  mois <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jan.&quot;</span>, <span class="st">&quot;Fév.&quot;</span>, <span class="st">&quot;Mar.&quot;</span>, <span class="st">&quot;Avr.&quot;</span>, <span class="st">&quot;Mai&quot;</span>, <span class="st">&quot;Juin&quot;</span>, <span class="st">&quot;Juil.&quot;</span>, <span class="st">&quot;Août&quot;</span>, <span class="st">&quot;Sept.&quot;</span>, <span class="st">&quot;Oct.&quot;</span>, <span class="st">&quot;Nov.&quot;</span>, <span class="st">&quot;Déc.&quot;</span>)</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Effectif en échantillons de morues franches collectés pour les lectures d&#39;âge dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et mois. Les valeurs entre parenthèses sont les effectifs en morues. Source: données du programme d&#39;échantillonnage commercial du MPO.&quot;</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, mois, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>  mois <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jan.&quot;</span>, <span class="st">&quot;Feb.&quot;</span>, <span class="st">&quot;Mar.&quot;</span>, <span class="st">&quot;Apr.&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="st">&quot;July&quot;</span>, <span class="st">&quot;Aug.&quot;</span>, <span class="st">&quot;Sept.&quot;</span>, <span class="st">&quot;Oct.&quot;</span>, <span class="st">&quot;Nov.&quot;</span>, <span class="st">&quot;Dec.&quot;</span>)</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Number of Atlantic cod samples collected for age readings in the commercial fishery of NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and month. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.&quot;</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, mois, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table5, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>table5 <span class="sc">%&gt;%</span> </span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, x)) <span class="sc">%&gt;%</span>  </span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en foncé</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Number of Atlantic cod samples collected for age readings in the commercial fishery of NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and month. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Jan. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Feb. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Mar. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Apr. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
May
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
June
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
July
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Aug. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sept. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Oct. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Nov. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Dec. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (129)
</td>
<td style="text-align:right;">
4 (99)
</td>
<td style="text-align:right;">
16 (558)
</td>
<td style="text-align:right;">
22 (450)
</td>
<td style="text-align:right;">
18 (376)
</td>
<td style="text-align:right;">
8 (286)
</td>
<td style="text-align:right;">
7 (175)
</td>
<td style="text-align:right;">
16 (440)
</td>
<td style="text-align:right;">
13 (392)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
109 (2,905)
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (50)
</td>
<td style="text-align:right;">
2 (74)
</td>
<td style="text-align:right;">
1 (35)
</td>
<td style="text-align:right;">
1 (21)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
9 (26)
</td>
<td style="text-align:right;">
63 (705)
</td>
<td style="text-align:right;">
77 (911)
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
33 (301)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
39 (237)
</td>
<td style="text-align:right;">
18 (269)
</td>
<td style="text-align:right;">
1 (41)
</td>
<td style="text-align:right;">
49 (170)
</td>
<td style="text-align:right;">
130 (424)
</td>
<td style="text-align:right;">
122 (528)
</td>
<td style="text-align:right;">
106 (685)
</td>
<td style="text-align:right;">
19 (200)
</td>
<td style="text-align:right;">
5 (32)
</td>
<td style="text-align:right;">
522 (2,887)
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (308)
</td>
<td style="text-align:right;">
68 (433)
</td>
<td style="text-align:right;">
57 (409)
</td>
<td style="text-align:right;">
37 (164)
</td>
<td style="text-align:right;">
15 (311)
</td>
<td style="text-align:right;">
7 (98)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
197 (1,723)
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (55)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (215)
</td>
<td style="text-align:right;">
11 (265)
</td>
<td style="text-align:right;">
62 (613)
</td>
<td style="text-align:right;">
52 (331)
</td>
<td style="text-align:right;">
39 (198)
</td>
<td style="text-align:right;">
21 (430)
</td>
<td style="text-align:right;">
5 (122)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
199 (2,229)
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (45)
</td>
<td style="text-align:right;">
4 (101)
</td>
<td style="text-align:right;">
7 (246)
</td>
<td style="text-align:right;">
6 (164)
</td>
<td style="text-align:right;">
2 (59)
</td>
<td style="text-align:right;">
1 (44)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (659)
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (44)
</td>
<td style="text-align:right;">
4 (142)
</td>
<td style="text-align:right;">
12 (349)
</td>
<td style="text-align:right;">
8 (204)
</td>
<td style="text-align:right;">
4 (88)
</td>
<td style="text-align:right;">
5 (157)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
34 (984)
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (173)
</td>
<td style="text-align:right;">
2 (63)
</td>
<td style="text-align:right;">
8 (240)
</td>
<td style="text-align:right;">
12 (348)
</td>
<td style="text-align:right;">
6 (143)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
33 (967)
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (153)
</td>
<td style="text-align:right;">
5 (204)
</td>
<td style="text-align:right;">
7 (251)
</td>
<td style="text-align:right;">
7 (221)
</td>
<td style="text-align:right;">
5 (175)
</td>
<td style="text-align:right;">
4 (170)
</td>
<td style="text-align:right;">
1 (35)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
33 (1,209)
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (146)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
8 (274)
</td>
<td style="text-align:right;">
9 (292)
</td>
<td style="text-align:right;">
3 (92)
</td>
<td style="text-align:right;">
2 (73)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (877)
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (39)
</td>
<td style="text-align:right;">
2 (74)
</td>
<td style="text-align:right;">
13 (414)
</td>
<td style="text-align:right;">
2 (68)
</td>
<td style="text-align:right;">
5 (140)
</td>
<td style="text-align:right;">
1 (33)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24 (768)
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (38)
</td>
<td style="text-align:right;">
17 (359)
</td>
<td style="text-align:right;">
3 (86)
</td>
<td style="text-align:right;">
2 (67)
</td>
<td style="text-align:right;">
2 (60)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25 (610)
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (32)
</td>
<td style="text-align:right;">
25 (517)
</td>
<td style="text-align:right;">
6 (141)
</td>
<td style="text-align:right;">
4 (81)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36 (771)
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (33)
</td>
<td style="text-align:right;">
2 (70)
</td>
<td style="text-align:right;">
19 (511)
</td>
<td style="text-align:right;">
2 (53)
</td>
<td style="text-align:right;">
8 (175)
</td>
<td style="text-align:right;">
7 (276)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
39 (1,118)
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (35)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (401)
</td>
<td style="text-align:right;">
6 (247)
</td>
<td style="text-align:right;">
9 (121)
</td>
<td style="text-align:right;">
3 (105)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32 (909)
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (396)
</td>
<td style="text-align:right;">
3 (120)
</td>
<td style="text-align:right;">
6 (188)
</td>
<td style="text-align:right;">
4 (150)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (854)
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (42)
</td>
<td style="text-align:right;">
9 (269)
</td>
<td style="text-align:right;">
6 (199)
</td>
<td style="text-align:right;">
3 (98)
</td>
<td style="text-align:right;">
2 (67)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (675)
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (31)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (338)
</td>
<td style="text-align:right;">
4 (132)
</td>
<td style="text-align:right;">
4 (105)
</td>
<td style="text-align:right;">
1 (28)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
22 (634)
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (15)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (45)
</td>
<td style="text-align:right;">
9 (249)
</td>
<td style="text-align:right;">
3 (82)
</td>
<td style="text-align:right;">
1 (34)
</td>
<td style="text-align:right;">
1 (28)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
16 (453)
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (35)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (337)
</td>
<td style="text-align:right;">
2 (77)
</td>
<td style="text-align:right;">
4 (136)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19 (585)
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
9 (281)
</td>
<td style="text-align:right;">
2 (60)
</td>
<td style="text-align:right;">
5 (183)
</td>
<td style="text-align:right;">
1 (31)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
17 (555)
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (33)
</td>
<td style="text-align:right;">
10 (256)
</td>
<td style="text-align:right;">
2 (79)
</td>
<td style="text-align:right;">
2 (78)
</td>
<td style="text-align:right;">
1 (33)
</td>
<td style="text-align:right;">
5 (193)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (672)
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (450)
</td>
<td style="text-align:right;">
4 (142)
</td>
<td style="text-align:right;">
2 (79)
</td>
<td style="text-align:right;">
1 (41)
</td>
<td style="text-align:right;">
4 (152)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24 (864)
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (43)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (104)
</td>
<td style="text-align:right;">
11 (426)
</td>
<td style="text-align:right;">
6 (200)
</td>
<td style="text-align:right;">
6 (213)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (66)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
29 (1,052)
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (36)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (426)
</td>
<td style="text-align:right;">
4 (172)
</td>
<td style="text-align:right;">
2 (76)
</td>
<td style="text-align:right;">
6 (244)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25 (954)
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (43)
</td>
<td style="text-align:right;">
1 (38)
</td>
<td style="text-align:right;">
4 (156)
</td>
<td style="text-align:right;">
1 (39)
</td>
<td style="text-align:right;">
2 (76)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (24)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10 (376)
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (42)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (47)
</td>
<td style="text-align:right;">
2 (91)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (180)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
33 (301)
</td>
<td style="text-align:right;font-weight: bold;">
3 (55)
</td>
<td style="text-align:right;font-weight: bold;">
5 (129)
</td>
<td style="text-align:right;font-weight: bold;">
46 (430)
</td>
<td style="text-align:right;font-weight: bold;">
62 (1,869)
</td>
<td style="text-align:right;font-weight: bold;">
78 (2,166)
</td>
<td style="text-align:right;font-weight: bold;">
441 (8,773)
</td>
<td style="text-align:right;font-weight: bold;">
347 (4,644)
</td>
<td style="text-align:right;font-weight: bold;">
292 (3,563)
</td>
<td style="text-align:right;font-weight: bold;">
200 (3,406)
</td>
<td style="text-align:right;font-weight: bold;">
66 (1,308)
</td>
<td style="text-align:right;font-weight: bold;">
68 (737)
</td>
<td style="text-align:right;font-weight: bold;">
1,641 (27,381)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor)</span></code></pre></div>
</div>
<div id="table6-annéeopano" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> <code>table6</code>: ~ année–OPANO</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(bio<span class="sc">$</span>opano)); op</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;3Pn&quot; &quot;4R&quot;  &quot;4Ra&quot; &quot;4Rb&quot; &quot;4Rc&quot; &quot;4Rd&quot; &quot;4S&quot;  &quot;4Si&quot; &quot;4Ss&quot; &quot;4Sv&quot; &quot;4Sw&quot; &quot;4Sx&quot;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] &quot;4Sy&quot; &quot;4Sz&quot;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>table6 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">opano =</span> <span class="fu">c</span>(op, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-opano à remplir</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> bio <span class="sc">%&gt;%</span> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, opano) <span class="sc">%&gt;%</span> </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">n_distinct</span>(ech_id),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">opano =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(opano) <span class="sc">%&gt;%</span> </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>,</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">opano =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4) <span class="sc">%&gt;%</span> </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">nb_ech =</span> <span class="fu">format</span>(nb_ech, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">nb_morues =</span> <span class="fu">format</span>(nb_morues, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">ifelse</span>(nb_ech <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, <span class="fu">paste0</span>(nb_ech, <span class="st">&quot; (&quot;</span>, nb_morues, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table6) <span class="co"># 435 obs et 2 var</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 435   2</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>table6 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table6, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;opano&quot;</span>))</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table6) <span class="co"># 435 obs et 5 var</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 435   5</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>table6 <span class="ot">&lt;-</span> table6 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;opano&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;label&quot;</span>)</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table6) <span class="co"># 29 obs et 16 var</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29 16</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">names</span>(table6)[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(table6) <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(table6) <span class="ot">&lt;-</span> <span class="fu">recode</span>(<span class="fu">names</span>(table6), <span class="st">&quot;4R&quot;</span> <span class="ot">=</span> <span class="st">&quot;4Ru&quot;</span>, <span class="st">&quot;4S&quot;</span> <span class="ot">=</span> <span class="st">&quot;4Su&quot;</span>)</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Effectif en échantillons de morues franches collectés pour les lectures d&#39;âge de longueur dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et sous-division OPANO. Les valeurs entre parenthèses sont les effectifs en morues. Le &#39;u&#39; dnas 4Ru et 4Su signifie &#39;non-déterminé&#39;. Source: données du programme d&#39;échantillonnage commercial du MPO.&quot;</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, op, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Number of Atlantic cod samples collected for age readings in the commercial fishery of NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and NAFO sub-division. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.&quot;</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, op, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table6, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>table6 <span class="sc">%&gt;%</span> </span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, x)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en foncé</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Number of Atlantic cod samples collected for age readings in the commercial fishery of NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and NAFO sub-division. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
3Pn
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4R
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Ra
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rb
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rc
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4S
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Si
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Ss
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sw
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sx
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sy
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sz
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
19 (679)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
50 (1,090)
</td>
<td style="text-align:right;">
10 (285)
</td>
<td style="text-align:right;">
12 (385)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (27)
</td>
<td style="text-align:right;">
1 (44)
</td>
<td style="text-align:right;">
4 (108)
</td>
<td style="text-align:right;">
6 (113)
</td>
<td style="text-align:right;">
1 (43)
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
4 (94)
</td>
<td style="text-align:right;">
109 (2,905)
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
35 (537)
</td>
<td style="text-align:right;">
22 (152)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (4)
</td>
<td style="text-align:right;">
1 (50)
</td>
<td style="text-align:right;">
6 (156)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (3)
</td>
<td style="text-align:right;">
8 (9)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
77 (911)
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
151 (1,206)
</td>
<td style="text-align:right;">
2 (6)
</td>
<td style="text-align:right;">
101 (440)
</td>
<td style="text-align:right;">
35 (180)
</td>
<td style="text-align:right;">
19 (88)
</td>
<td style="text-align:right;">
49 (291)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (41)
</td>
<td style="text-align:right;">
45 (169)
</td>
<td style="text-align:right;">
119 (466)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
522 (2,887)
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
21 (370)
</td>
<td style="text-align:right;">
61 (526)
</td>
<td style="text-align:right;">
12 (70)
</td>
<td style="text-align:right;">
10 (52)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
14 (354)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
20 (40)
</td>
<td style="text-align:right;">
59 (311)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
197 (1,723)
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
38 (1,057)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
30 (242)
</td>
<td style="text-align:right;">
22 (248)
</td>
<td style="text-align:right;">
12 (113)
</td>
<td style="text-align:right;">
16 (237)
</td>
<td style="text-align:right;">
1 (3)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (55)
</td>
<td style="text-align:right;">
20 (74)
</td>
<td style="text-align:right;">
55 (157)
</td>
<td style="text-align:right;">
1 (39)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (4)
</td>
<td style="text-align:right;">
199 (2,229)
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
2 (77)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
7 (199)
</td>
<td style="text-align:right;">
2 (85)
</td>
<td style="text-align:right;">
1 (43)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (46)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
8 (209)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (659)
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
16 (401)
</td>
<td style="text-align:right;">
4 (153)
</td>
<td style="text-align:right;">
2 (80)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (57)
</td>
<td style="text-align:right;">
10 (293)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
34 (984)
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
2 (63)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
18 (482)
</td>
<td style="text-align:right;">
3 (114)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (81)
</td>
<td style="text-align:right;">
1 (38)
</td>
<td style="text-align:right;">
6 (152)
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
33 (967)
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
2 (78)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (433)
</td>
<td style="text-align:right;">
12 (466)
</td>
<td style="text-align:right;">
2 (72)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (49)
</td>
<td style="text-align:right;">
2 (65)
</td>
<td style="text-align:right;">
1 (46)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
33 (1,209)
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
6 (214)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10 (302)
</td>
<td style="text-align:right;">
3 (120)
</td>
<td style="text-align:right;">
1 (50)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (118)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (73)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (877)
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
2 (71)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (390)
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (110)
</td>
<td style="text-align:right;">
2 (75)
</td>
<td style="text-align:right;">
2 (48)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24 (768)
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
1 (27)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (35)
</td>
<td style="text-align:right;">
15 (322)
</td>
<td style="text-align:right;">
1 (38)
</td>
<td style="text-align:right;">
3 (107)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (81)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
25 (610)
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
16 (245)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
8 (219)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (145)
</td>
<td style="text-align:right;">
4 (96)
</td>
<td style="text-align:right;">
1 (32)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (34)
</td>
<td style="text-align:right;">
36 (771)
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
17 (492)
</td>
<td style="text-align:right;">
7 (238)
</td>
<td style="text-align:right;">
3 (109)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (70)
</td>
<td style="text-align:right;">
6 (127)
</td>
<td style="text-align:right;">
4 (82)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
39 (1,118)
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (15)
</td>
<td style="text-align:right;">
15 (363)
</td>
<td style="text-align:right;">
3 (124)
</td>
<td style="text-align:right;">
4 (147)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
7 (223)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32 (909)
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (34)
</td>
<td style="text-align:right;">
16 (549)
</td>
<td style="text-align:right;">
1 (31)
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (85)
</td>
<td style="text-align:right;">
5 (118)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (854)
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (31)
</td>
<td style="text-align:right;">
1 (28)
</td>
<td style="text-align:right;">
8 (261)
</td>
<td style="text-align:right;">
1 (33)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (173)
</td>
<td style="text-align:right;">
3 (66)
</td>
<td style="text-align:right;">
2 (83)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (675)
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
2 (49)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (29)
</td>
<td style="text-align:right;">
6 (210)
</td>
<td style="text-align:right;">
1 (31)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (101)
</td>
<td style="text-align:right;">
5 (99)
</td>
<td style="text-align:right;">
4 (115)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
22 (634)
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
1 (15)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (103)
</td>
<td style="text-align:right;">
1 (45)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (34)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (91)
</td>
<td style="text-align:right;">
6 (165)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
16 (453)
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (203)
</td>
<td style="text-align:right;">
2 (72)
</td>
<td style="text-align:right;">
1 (35)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (109)
</td>
<td style="text-align:right;">
6 (129)
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19 (585)
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (186)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (32)
</td>
<td style="text-align:right;">
1 (31)
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
6 (159)
</td>
<td style="text-align:right;">
3 (110)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
17 (555)
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
1 (51)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (107)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (142)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (33)
</td>
<td style="text-align:right;">
3 (113)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (141)
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (48)
</td>
<td style="text-align:right;">
21 (672)
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
7 (270)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (152)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (41)
</td>
<td style="text-align:right;">
4 (114)
</td>
<td style="text-align:right;">
7 (253)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (34)
</td>
<td style="text-align:right;">
24 (864)
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
4 (144)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (158)
</td>
<td style="text-align:right;">
4 (138)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (1)
</td>
<td style="text-align:right;">
2 (69)
</td>
<td style="text-align:right;">
1 (33)
</td>
<td style="text-align:right;">
1 (43)
</td>
<td style="text-align:right;">
5 (182)
</td>
<td style="text-align:right;">
4 (170)
</td>
<td style="text-align:right;">
1 (42)
</td>
<td style="text-align:right;">
2 (72)
</td>
<td style="text-align:right;">
29 (1,052)
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (40)
</td>
<td style="text-align:right;">
10 (407)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (36)
</td>
<td style="text-align:right;">
1 (32)
</td>
<td style="text-align:right;">
2 (84)
</td>
<td style="text-align:right;">
5 (147)
</td>
<td style="text-align:right;">
1 (41)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (167)
</td>
<td style="text-align:right;">
25 (954)
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (40)
</td>
<td style="text-align:right;">
1 (41)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (24)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (122)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (39)
</td>
<td style="text-align:right;">
2 (75)
</td>
<td style="text-align:right;">
1 (35)
</td>
<td style="text-align:right;">
10 (376)
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (42)
</td>
<td style="text-align:right;">
1 (54)
</td>
<td style="text-align:right;">
1 (37)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1 (47)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (180)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
287 (4,638)
</td>
<td style="text-align:right;font-weight: bold;">
86 (715)
</td>
<td style="text-align:right;font-weight: bold;">
155 (1,131)
</td>
<td style="text-align:right;font-weight: bold;">
329 (7,678)
</td>
<td style="text-align:right;font-weight: bold;">
84 (2,123)
</td>
<td style="text-align:right;font-weight: bold;">
132 (2,640)
</td>
<td style="text-align:right;font-weight: bold;">
3 (41)
</td>
<td style="text-align:right;font-weight: bold;">
10 (361)
</td>
<td style="text-align:right;font-weight: bold;">
22 (862)
</td>
<td style="text-align:right;font-weight: bold;">
129 (1,632)
</td>
<td style="text-align:right;font-weight: bold;">
346 (3,624)
</td>
<td style="text-align:right;font-weight: bold;">
35 (1,247)
</td>
<td style="text-align:right;font-weight: bold;">
5 (201)
</td>
<td style="text-align:right;font-weight: bold;">
18 (488)
</td>
<td style="text-align:right;font-weight: bold;">
1,641 (27,381)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(op)</span></code></pre></div>
</div>
<div id="table7-annéeengin_cat" class="section level3" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> <code>table7</code>: ~ année–<em>engin_cat</em></h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>engins <span class="ot">&lt;-</span> <span class="fu">levels</span>(engins_obs<span class="sc">$</span>engin_groupe)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>engins <span class="ot">&lt;-</span> engins[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># on enlève les shrimp trawl = aucune morue âgée pour cet engin</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>table7 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">engin_groupe =</span> <span class="fu">c</span>(engins, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-engin à remplir</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> bio <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(., engins_obs, <span class="at">by =</span> <span class="st">&quot;engin&quot;</span>, source <span class="sc">==</span> <span class="st">&quot;quai&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, engin_groupe) <span class="sc">%&gt;%</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">n_distinct</span>(ech_id),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">engin_groupe =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(engin_groupe) <span class="sc">%&gt;%</span> </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">nb_ech =</span> <span class="fu">sum</span>(nb_ech, <span class="at">na.rm =</span> T),</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nb_morues =</span> <span class="fu">sum</span>(nb_morues, <span class="at">na.rm =</span> T),</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>,</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">engin_groupe =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4) <span class="sc">%&gt;%</span> </span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">nb_ech =</span> <span class="fu">format</span>(nb_ech, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">nb_morues =</span> <span class="fu">format</span>(nb_morues, <span class="at">big.mark =</span> bm, <span class="at">trim =</span> T),</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">ifelse</span>(nb_ech <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, <span class="fu">paste0</span>(nb_ech, <span class="st">&quot; (&quot;</span>, nb_morues, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table7) <span class="co"># 203 obs et 2 var</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 203   2</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>table7 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table7, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;engin_groupe&quot;</span>))</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table7) <span class="co"># 203 obs et 5 var</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 232   5</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>table7 <span class="ot">&lt;-</span> table7 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;engin_groupe&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;label&quot;</span>)</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table7) <span class="co"># 29 obs et 8 var</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29  9</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>engin <span class="ot">&lt;-</span> <span class="fu">names</span>(table7)[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(table7) <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Effectif en échantillons de morues franches collectés pour les fréquences de longueur dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et regroupement d&#39;engins. Les valeurs entre parenthèses sont les effectifs en morues. Source: données du programme d&#39;échantillonnage commercial du MPO.&quot;</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, engin, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Number of Atlantic cod samples collected for age readings in the commercial fishery of NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and gear grouping. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.&quot;</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, engin, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table7, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>table7 <span class="sc">%&gt;%</span> </span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, x)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en gras</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Number of Atlantic cod samples collected for age readings in the commercial fishery of NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and gear grouping. Values in brackets are the number of cods. Source: DFO dockside monitoring program data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Other trawls
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Seines
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Gillnets
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Longlines
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Hand gear
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Traps
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
47 (1,309)
</td>
<td style="text-align:right;">
8 (240)
</td>
<td style="text-align:right;">
19 (619)
</td>
<td style="text-align:right;">
22 (901)
</td>
<td style="text-align:right;">
1 (24)
</td>
<td style="text-align:right;">
13 (207)
</td>
<td style="text-align:right;">
156 (4,587)
</td>
<td style="text-align:right;">
46 (1,287)
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
1 (682)
</td>
<td style="text-align:right;">
4 (130)
</td>
<td style="text-align:right;">
9 (12)
</td>
<td style="text-align:right;">
64 (769)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
79 (2,275)
</td>
<td style="text-align:right;">
1 (682)
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
1 (252)
</td>
<td style="text-align:right;">
4 (76)
</td>
<td style="text-align:right;">
219 (798)
</td>
<td style="text-align:right;">
296 (1,994)
</td>
<td style="text-align:right;">
3 (19)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
524 (3,391)
</td>
<td style="text-align:right;">
1 (252)
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
1 (561)
</td>
<td style="text-align:right;">
9 (298)
</td>
<td style="text-align:right;">
76 (332)
</td>
<td style="text-align:right;">
86 (761)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (332)
</td>
<td style="text-align:right;">
199 (2,845)
</td>
<td style="text-align:right;">
1 (561)
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
1 (665)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
113 (412)
</td>
<td style="text-align:right;">
86 (1,817)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
201 (3,559)
</td>
<td style="text-align:right;">
1 (665)
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
1 (693)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5 (162)
</td>
<td style="text-align:right;">
7 (281)
</td>
<td style="text-align:right;">
9 (216)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
23 (2,045)
</td>
<td style="text-align:right;">
1 (693)
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
1 (840)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
23 (590)
</td>
<td style="text-align:right;">
6 (233)
</td>
<td style="text-align:right;">
5 (161)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
36 (2,664)
</td>
<td style="text-align:right;">
1 (840)
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
1 (630)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
18 (433)
</td>
<td style="text-align:right;">
13 (479)
</td>
<td style="text-align:right;">
2 (55)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
35 (2,227)
</td>
<td style="text-align:right;">
1 (630)
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
1 (567)
</td>
<td style="text-align:right;">
2 (72)
</td>
<td style="text-align:right;">
14 (465)
</td>
<td style="text-align:right;">
17 (672)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
35 (2,343)
</td>
<td style="text-align:right;">
1 (567)
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
1 (351)
</td>
<td style="text-align:right;">
1 (50)
</td>
<td style="text-align:right;">
9 (255)
</td>
<td style="text-align:right;">
16 (572)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28 (1,579)
</td>
<td style="text-align:right;">
1 (351)
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
1 (742)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2 (1,484)
</td>
<td style="text-align:right;">
1 (742)
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
1 (1,061)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
11 (291)
</td>
<td style="text-align:right;">
13 (477)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (2,890)
</td>
<td style="text-align:right;">
1 (1,061)
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
1 (861)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
18 (376)
</td>
<td style="text-align:right;">
7 (234)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
27 (2,332)
</td>
<td style="text-align:right;">
1 (861)
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
1 (836)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24 (424)
</td>
<td style="text-align:right;">
12 (347)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
38 (2,443)
</td>
<td style="text-align:right;">
1 (836)
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
1 (841)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
23 (608)
</td>
<td style="text-align:right;">
16 (510)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
41 (2,800)
</td>
<td style="text-align:right;">
1 (841)
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
1 (760)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
22 (520)
</td>
<td style="text-align:right;">
10 (389)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
34 (2,429)
</td>
<td style="text-align:right;">
1 (760)
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
1 (709)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
15 (457)
</td>
<td style="text-align:right;">
11 (397)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
28 (2,272)
</td>
<td style="text-align:right;">
1 (709)
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
1 (417)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (363)
</td>
<td style="text-align:right;">
9 (312)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
23 (1,509)
</td>
<td style="text-align:right;">
1 (417)
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
1 (595)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (338)
</td>
<td style="text-align:right;">
10 (296)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
24 (1,824)
</td>
<td style="text-align:right;">
1 (595)
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
1 (889)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
7 (214)
</td>
<td style="text-align:right;">
8 (214)
</td>
<td style="text-align:right;">
1 (25)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
18 (2,231)
</td>
<td style="text-align:right;">
1 (889)
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
1 (810)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (343)
</td>
<td style="text-align:right;">
5 (181)
</td>
<td style="text-align:right;">
2 (61)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
21 (2,205)
</td>
<td style="text-align:right;">
1 (810)
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
1 (853)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
9 (288)
</td>
<td style="text-align:right;">
6 (210)
</td>
<td style="text-align:right;">
2 (57)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19 (2,261)
</td>
<td style="text-align:right;">
1 (853)
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
1 (864)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10 (256)
</td>
<td style="text-align:right;">
11 (416)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
23 (2,400)
</td>
<td style="text-align:right;">
1 (864)
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
1 (909)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10 (339)
</td>
<td style="text-align:right;">
14 (525)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
26 (2,682)
</td>
<td style="text-align:right;">
1 (909)
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
1 (824)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
11 (405)
</td>
<td style="text-align:right;">
17 (617)
</td>
<td style="text-align:right;">
1 (30)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
31 (2,700)
</td>
<td style="text-align:right;">
1 (824)
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
1 (759)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
13 (494)
</td>
<td style="text-align:right;">
12 (460)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
27 (2,472)
</td>
<td style="text-align:right;">
1 (759)
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
1 (751)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3 (120)
</td>
<td style="text-align:right;">
7 (256)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12 (1,878)
</td>
<td style="text-align:right;">
1 (751)
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
1 (796)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4 (180)
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6 (1,772)
</td>
<td style="text-align:right;">
1 (796)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
74 (20,827)
</td>
<td style="text-align:right;font-weight: bold;">
28 (866)
</td>
<td style="text-align:right;font-weight: bold;">
717 (9,914)
</td>
<td style="text-align:right;font-weight: bold;">
785 (14,500)
</td>
<td style="text-align:right;font-weight: bold;">
26 (648)
</td>
<td style="text-align:right;font-weight: bold;">
39 (539)
</td>
<td style="text-align:right;font-weight: bold;">
1,742 (68,099)
</td>
<td style="text-align:right;font-weight: bold;">
73 (20,805)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor, engins)</span></code></pre></div>
</div>
</div>
<div id="débarquements-2" class="section level2 tabset" number="8.3">
<h2 class="tabset"><span class="header-section-number">8.3</span> Débarquements</h2>
<div id="table8-annéemois" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> <code>table8</code>: ~ année–mois</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>table8 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">mois =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-mois à remplir</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> catch <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, mois) <span class="sc">%&gt;%</span> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">mois =</span> <span class="fu">as.character</span>(mois),</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">mois =</span> <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(mois) <span class="sc">%&gt;%</span> </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T),</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>, </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mois =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4)</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table8) <span class="co"># 377 obs et 2 var</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 377   2</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>table8 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table8, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;mois&quot;</span>))</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table8) <span class="co"># 377 obs et 3 var</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 377   3</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>table8 <span class="ot">&lt;-</span> table8 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;mois&quot;</span>, <span class="at">names_prefix =</span> <span class="st">&quot;M&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;catch&quot;</span>)</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table8) <span class="co"># 29 obs et 14 var</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29 14</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ajout1, ajout2, ajout3, ajout4, ajout)</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  mois <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jan.&quot;</span>, <span class="st">&quot;Fév.&quot;</span>, <span class="st">&quot;Mar.&quot;</span>, <span class="st">&quot;Avr.&quot;</span>, <span class="st">&quot;Mai&quot;</span>, <span class="st">&quot;Juin&quot;</span>, <span class="st">&quot;Juil.&quot;</span>, <span class="st">&quot;Août&quot;</span>, <span class="st">&quot;Sept.&quot;</span>, <span class="st">&quot;Oct.&quot;</span>, <span class="st">&quot;Nov.&quot;</span>, <span class="st">&quot;Déc.&quot;</span>)</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Débarquements reportés (t) de morue franche dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et mois. Source: données ZIFF.&quot;</span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, mois, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  mois <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jan.&quot;</span>, <span class="st">&quot;Feb.&quot;</span>, <span class="st">&quot;Mar.&quot;</span>, <span class="st">&quot;Apr.&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="st">&quot;July&quot;</span>, <span class="st">&quot;Aug.&quot;</span>, <span class="st">&quot;Sept.&quot;</span>, <span class="st">&quot;Oct.&quot;</span>, <span class="st">&quot;Nov.&quot;</span>, <span class="st">&quot;Dec.&quot;</span>)</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Reported landings (t) of Atlantic cod in the commercial fishery of the NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and month. Source: ZIFF data.&quot;</span></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, mois, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table8, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>table8 <span class="sc">%&gt;%</span> </span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(<span class="at">.predicate =</span> is.numeric, <span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, <span class="fu">format</span>(<span class="fu">round</span>(x, <span class="dv">0</span>), <span class="at">nsmall =</span> <span class="dv">0</span>, <span class="at">big.mark =</span> bm))) <span class="sc">%&gt;%</span>  </span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en foncé</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Reported landings (t) of Atlantic cod in the commercial fishery of the NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and month. Source: ZIFF data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Jan. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Feb. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Mar. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Apr. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
May
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
June
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
July
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Aug. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sept. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Oct. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Nov. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Dec. 
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
1,255
</td>
<td style="text-align:right;">
1,244
</td>
<td style="text-align:right;">
1,489
</td>
<td style="text-align:right;">
4,350
</td>
<td style="text-align:right;">
3,811
</td>
<td style="text-align:right;">
2,234
</td>
<td style="text-align:right;">
1,119
</td>
<td style="text-align:right;">
1,088
</td>
<td style="text-align:right;">
1,173
</td>
<td style="text-align:right;">
629
</td>
<td style="text-align:right;">
18,452
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
206
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
537
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
185
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
317
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
357
</td>
<td style="text-align:right;">
255
</td>
<td style="text-align:right;">
1,189
</td>
<td style="text-align:right;">
962
</td>
<td style="text-align:right;">
815
</td>
<td style="text-align:right;">
1,038
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
4,792
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
246
</td>
<td style="text-align:right;">
908
</td>
<td style="text-align:right;">
1,051
</td>
<td style="text-align:right;">
418
</td>
<td style="text-align:right;">
552
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3,229
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
870
</td>
<td style="text-align:right;">
1,985
</td>
<td style="text-align:right;">
1,458
</td>
<td style="text-align:right;">
1,031
</td>
<td style="text-align:right;">
1,014
</td>
<td style="text-align:right;">
395
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
6,890
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
538
</td>
<td style="text-align:right;">
907
</td>
<td style="text-align:right;">
1,251
</td>
<td style="text-align:right;">
1,533
</td>
<td style="text-align:right;">
1,087
</td>
<td style="text-align:right;">
775
</td>
<td style="text-align:right;">
398
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
6,857
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
455
</td>
<td style="text-align:right;">
518
</td>
<td style="text-align:right;">
1,847
</td>
<td style="text-align:right;">
1,269
</td>
<td style="text-align:right;">
1,339
</td>
<td style="text-align:right;">
865
</td>
<td style="text-align:right;">
293
</td>
<td style="text-align:right;">
125
</td>
<td style="text-align:right;">
6,950
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
173
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
2,519
</td>
<td style="text-align:right;">
1,484
</td>
<td style="text-align:right;">
843
</td>
<td style="text-align:right;">
869
</td>
<td style="text-align:right;">
393
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6,529
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
389
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1,887
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:right;">
537
</td>
<td style="text-align:right;">
356
</td>
<td style="text-align:right;">
207
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
3,274
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
2,434
</td>
<td style="text-align:right;">
628
</td>
<td style="text-align:right;">
774
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4,461
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
3,285
</td>
<td style="text-align:right;">
591
</td>
<td style="text-align:right;">
645
</td>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
669
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
5,652
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
3,711
</td>
<td style="text-align:right;">
447
</td>
<td style="text-align:right;">
1,126
</td>
<td style="text-align:right;">
578
</td>
<td style="text-align:right;">
447
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6,483
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
2,973
</td>
<td style="text-align:right;">
924
</td>
<td style="text-align:right;">
1,240
</td>
<td style="text-align:right;">
551
</td>
<td style="text-align:right;">
301
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6,158
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
176
</td>
<td style="text-align:right;">
1,691
</td>
<td style="text-align:right;">
693
</td>
<td style="text-align:right;">
690
</td>
<td style="text-align:right;">
696
</td>
<td style="text-align:right;">
687
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
4,700
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
1,362
</td>
<td style="text-align:right;">
882
</td>
<td style="text-align:right;">
556
</td>
<td style="text-align:right;">
499
</td>
<td style="text-align:right;">
185
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3,552
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1,006
</td>
<td style="text-align:right;">
163
</td>
<td style="text-align:right;">
315
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1,775
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
671
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
296
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1,303
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
699
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
220
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1,222
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
644
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
344
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
1,262
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
731
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
137
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1,267
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
840
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
156
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1,373
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
903
</td>
<td style="text-align:right;">
706
</td>
<td style="text-align:right;">
637
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
206
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
2,671
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
861
</td>
<td style="text-align:right;">
774
</td>
<td style="text-align:right;">
323
</td>
<td style="text-align:right;">
221
</td>
<td style="text-align:right;">
268
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
2,578
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
304
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
775
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
382
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
662
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
227
</td>
<td style="text-align:right;font-weight: bold;">
283
</td>
<td style="text-align:right;font-weight: bold;">
1,494
</td>
<td style="text-align:right;font-weight: bold;">
1,601
</td>
<td style="text-align:right;font-weight: bold;">
3,496
</td>
<td style="text-align:right;font-weight: bold;">
8,195
</td>
<td style="text-align:right;font-weight: bold;">
38,200
</td>
<td style="text-align:right;font-weight: bold;">
17,096
</td>
<td style="text-align:right;font-weight: bold;">
15,245
</td>
<td style="text-align:right;font-weight: bold;">
10,277
</td>
<td style="text-align:right;font-weight: bold;">
6,853
</td>
<td style="text-align:right;font-weight: bold;">
1,328
</td>
<td style="text-align:right;font-weight: bold;">
104,294
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor)</span></code></pre></div>
</div>
<div id="table9-annéeopano" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> <code>table9</code>: ~ année–OPANO</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> catch <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(opano) <span class="sc">%&gt;%</span> unique <span class="sc">%&gt;%</span> <span class="fu">sort</span>()</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>table9 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">opano =</span> <span class="fu">c</span>(op, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-opano à remplir</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> catch <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, opano) <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">opano =</span> <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(opano) <span class="sc">%&gt;%</span> </span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T),</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>, </span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">opano =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4)</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table9) <span class="co"># 435 obs et 2 var</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 435   2</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>table9 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table9, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;opano&quot;</span>))</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table9) <span class="co"># 435 obs et 3 var</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 435   3</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>table9 <span class="ot">&lt;-</span> table9 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;opano&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;catch&quot;</span>)</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table9) <span class="co"># 29 obs et 16 var</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29 16</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ajout1, ajout2, ajout3, ajout4, ajout)</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">names</span>(table9)[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(table9)<span class="sc">-</span><span class="dv">1</span>)]</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Débarquements reportés (t) de morue franche dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et zone unitaire de l&#39;OPANO. Source: données ZIFF.&quot;</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, op, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Reported landings (t) of Atlantic cod in the commercial fishery of the NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and NAFO sub-division. Source: ZIFF data.&quot;</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, op, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table9, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>table9 <span class="sc">%&gt;%</span> </span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(<span class="at">.predicate =</span> is.numeric, <span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, <span class="fu">format</span>(<span class="fu">round</span>(x, <span class="dv">0</span>), <span class="at">nsmall =</span> <span class="dv">0</span>, <span class="at">big.mark =</span> bm))) <span class="sc">%&gt;%</span>  </span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en foncé</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Reported landings (t) of Atlantic cod in the commercial fishery of the NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and NAFO sub-division. Source: ZIFF data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
3Pn
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Ra
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rb
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rc
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Rd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Ru
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Si
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Ss
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Su
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sw
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sx
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sy
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4Sz
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
3,194
</td>
<td style="text-align:right;">
4,071
</td>
<td style="text-align:right;">
5,679
</td>
<td style="text-align:right;">
2,021
</td>
<td style="text-align:right;">
1,723
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
340
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
342
</td>
<td style="text-align:right;">
654
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:right;">
249
</td>
<td style="text-align:right;">
18,452
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
114
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
537
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
185
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
317
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
2,006
</td>
<td style="text-align:right;">
806
</td>
<td style="text-align:right;">
600
</td>
<td style="text-align:right;">
593
</td>
<td style="text-align:right;">
299
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
327
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4,792
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
877
</td>
<td style="text-align:right;">
387
</td>
<td style="text-align:right;">
367
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
637
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
526
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3,229
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
1,165
</td>
<td style="text-align:right;">
1,551
</td>
<td style="text-align:right;">
1,478
</td>
<td style="text-align:right;">
908
</td>
<td style="text-align:right;">
944
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
124
</td>
<td style="text-align:right;">
632
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6,890
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
1,478
</td>
<td style="text-align:right;">
1,215
</td>
<td style="text-align:right;">
1,469
</td>
<td style="text-align:right;">
772
</td>
<td style="text-align:right;">
865
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
714
</td>
<td style="text-align:right;">
83
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6,857
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
1,740
</td>
<td style="text-align:right;">
1,311
</td>
<td style="text-align:right;">
1,267
</td>
<td style="text-align:right;">
992
</td>
<td style="text-align:right;">
722
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
252
</td>
<td style="text-align:right;">
570
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6,950
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
1,713
</td>
<td style="text-align:right;">
1,172
</td>
<td style="text-align:right;">
1,377
</td>
<td style="text-align:right;">
795
</td>
<td style="text-align:right;">
591
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
686
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6,529
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
389
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
783
</td>
<td style="text-align:right;">
595
</td>
<td style="text-align:right;">
642
</td>
<td style="text-align:right;">
297
</td>
<td style="text-align:right;">
350
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
442
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3,274
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
856
</td>
<td style="text-align:right;">
976
</td>
<td style="text-align:right;">
701
</td>
<td style="text-align:right;">
437
</td>
<td style="text-align:right;">
770
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
278
</td>
<td style="text-align:right;">
293
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4,461
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
1,208
</td>
<td style="text-align:right;">
1,196
</td>
<td style="text-align:right;">
680
</td>
<td style="text-align:right;">
434
</td>
<td style="text-align:right;">
1,168
</td>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
297
</td>
<td style="text-align:right;">
427
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5,652
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
1,081
</td>
<td style="text-align:right;">
1,575
</td>
<td style="text-align:right;">
939
</td>
<td style="text-align:right;">
748
</td>
<td style="text-align:right;">
914
</td>
<td style="text-align:right;">
369
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
668
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6,483
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
1,131
</td>
<td style="text-align:right;">
1,704
</td>
<td style="text-align:right;">
973
</td>
<td style="text-align:right;">
665
</td>
<td style="text-align:right;">
829
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
194
</td>
<td style="text-align:right;">
610
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6,158
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
1,357
</td>
<td style="text-align:right;">
922
</td>
<td style="text-align:right;">
799
</td>
<td style="text-align:right;">
424
</td>
<td style="text-align:right;">
593
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4,700
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
705
</td>
<td style="text-align:right;">
1,135
</td>
<td style="text-align:right;">
546
</td>
<td style="text-align:right;">
270
</td>
<td style="text-align:right;">
224
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
276
</td>
<td style="text-align:right;">
346
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3,552
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
510
</td>
<td style="text-align:right;">
188
</td>
<td style="text-align:right;">
143
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
239
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1,775
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
372
</td>
<td style="text-align:right;">
188
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
181
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1,303
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
185
</td>
<td style="text-align:right;">
366
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
151
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
163
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1,222
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
153
</td>
<td style="text-align:right;">
492
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
167
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1,262
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
155
</td>
<td style="text-align:right;">
422
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
197
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
1,267
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
510
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1,373
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
345
</td>
<td style="text-align:right;">
1,202
</td>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
230
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
194
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
2,671
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
439
</td>
<td style="text-align:right;">
1,239
</td>
<td style="text-align:right;">
206
</td>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
247
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
2,578
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
249
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
775
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
662
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
21,910
</td>
<td style="text-align:right;font-weight: bold;">
24,281
</td>
<td style="text-align:right;font-weight: bold;">
19,274
</td>
<td style="text-align:right;font-weight: bold;">
10,843
</td>
<td style="text-align:right;font-weight: bold;">
11,611
</td>
<td style="text-align:right;font-weight: bold;">
654
</td>
<td style="text-align:right;font-weight: bold;">
298
</td>
<td style="text-align:right;font-weight: bold;">
699
</td>
<td style="text-align:right;font-weight: bold;">
90
</td>
<td style="text-align:right;font-weight: bold;">
3,632
</td>
<td style="text-align:right;font-weight: bold;">
9,250
</td>
<td style="text-align:right;font-weight: bold;">
932
</td>
<td style="text-align:right;font-weight: bold;">
267
</td>
<td style="text-align:right;font-weight: bold;">
552
</td>
<td style="text-align:right;font-weight: bold;">
104,294
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor)</span></code></pre></div>
</div>
<div id="table10-annéeengin_cat" class="section level3" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> <code>table10</code>: ~ année–<em>engin_cat</em></h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(catch) <span class="co"># 593461 obs et 13 var</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 593461     13</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>catch <span class="ot">&lt;-</span> <span class="fu">left_join</span>(catch, engins_deb <span class="sc">%&gt;%</span> <span class="fu">select</span>(engin, engin_groupe), <span class="at">by =</span> <span class="st">&quot;engin&quot;</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(catch) <span class="co"># 593461 obs et 14 var</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 593461     14</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>engins <span class="ot">&lt;-</span> <span class="fu">levels</span>(catch<span class="sc">$</span>engin_groupe)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>table10 <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">c</span>(my_year, <span class="st">&quot;Total&quot;</span>), <span class="at">engin_groupe =</span> <span class="fu">c</span>(engins, <span class="st">&quot;Total&quot;</span>)) <span class="co"># cellules année-engins à remplir</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>ajout1 <span class="ot">&lt;-</span> catch <span class="sc">%&gt;%</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee, engin_groupe) <span class="sc">%&gt;%</span> </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="fu">as.character</span>(annee))</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>ajout2 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">engin_groupe =</span> <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>ajout3 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(engin_groupe) <span class="sc">%&gt;%</span> </span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> <span class="co"># en tonnes</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>          ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>ajout4 <span class="ot">&lt;-</span> ajout1 <span class="sc">%&gt;%</span> </span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> T),</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">annee =</span> <span class="st">&quot;Total&quot;</span>, </span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">engin_groupe =</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>          ungroup</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ajout1, ajout2, ajout3, ajout4)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table10) <span class="co"># 261 obs et 2 var</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 261   2</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>table10 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(table10, ajout, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;annee&quot;</span>, <span class="st">&quot;engin_groupe&quot;</span>))</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table10) <span class="co"># 261 obs et 3 var</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 261   3</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>table10 <span class="ot">&lt;-</span> table10 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">&quot;annee&quot;</span>, <span class="at">names_from =</span> <span class="st">&quot;engin_groupe&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;catch&quot;</span>)</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(table10) <span class="co"># 29 obs et 10 var</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 29 10</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ajout1, ajout2, ajout3, ajout4, ajout)</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>engin <span class="ot">&lt;-</span> <span class="fu">names</span>(table10)[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(table10) <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Débarquements reportés (t) de morue franche dans la pêche commerciale des Divisions OPANO 3Pn--4RS pour la période 1993--2020, ventilé par année et regroupement d&#39;engins. Source: données ZIFF.&quot;</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Année&quot;</span>, engin, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>  cap <span class="ot">&lt;-</span> <span class="st">&quot;Reported landings (t) of Atlantic cod in the commercial fishery of the NAFO Divisions 3Pn--4RS for the period 1993--2020, by year and gear grouping. Source: ZIFF data.&quot;</span></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, engin, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(table10, annee <span class="sc">==</span> <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>table10 <span class="sc">%&gt;%</span> </span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(<span class="at">.predicate =</span> is.numeric, <span class="at">.funs =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">&quot;&quot;</span>, <span class="fu">format</span>(<span class="fu">round</span>(x, <span class="dv">0</span>), <span class="at">nsmall =</span> <span class="dv">0</span>, <span class="at">big.mark =</span> bm))) <span class="sc">%&gt;%</span>  </span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> cap, <span class="at">col.names =</span> col_names, <span class="at">longtable =</span> F, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="fu">ncol</span>(.)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;striped&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">landscape</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> cor, <span class="at">bold =</span> T) <span class="co"># ligne total en gras</span></span></code></pre></div>
<table class="table table-hover table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Reported landings (t) of Atlantic cod in the commercial fishery of the NAFO Divisions 3Pn–4RS for the period 1993–2020, by year and gear grouping. Source: ZIFF data.
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Shrimp trawls
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Other trawls
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Seines
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Gillnets
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Longlines
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Hand gear
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Traps
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Others / unknown
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1993
</td>
<td style="text-align:right;">
83
</td>
<td style="text-align:right;">
10,054
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
2,501
</td>
<td style="text-align:right;">
2,124
</td>
<td style="text-align:right;">
1,041
</td>
<td style="text-align:right;">
2,458
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
18,452
</td>
</tr>
<tr>
<td style="text-align:left;">
1994
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
229
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
537
</td>
</tr>
<tr>
<td style="text-align:left;">
1995
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:right;">
185
</td>
</tr>
<tr>
<td style="text-align:left;">
1996
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
317
</td>
</tr>
<tr>
<td style="text-align:left;">
1997
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
538
</td>
<td style="text-align:right;">
3,857
</td>
<td style="text-align:right;">
265
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4,792
</td>
</tr>
<tr>
<td style="text-align:left;">
1998
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
629
</td>
<td style="text-align:right;">
2,302
</td>
<td style="text-align:right;">
261
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3,229
</td>
</tr>
<tr>
<td style="text-align:left;">
1999
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
3,401
</td>
<td style="text-align:right;">
2,475
</td>
<td style="text-align:right;">
968
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6,890
</td>
</tr>
<tr>
<td style="text-align:left;">
2000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
3,046
</td>
<td style="text-align:right;">
3,167
</td>
<td style="text-align:right;">
557
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6,857
</td>
</tr>
<tr>
<td style="text-align:left;">
2001
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
2,020
</td>
<td style="text-align:right;">
3,963
</td>
<td style="text-align:right;">
864
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6,950
</td>
</tr>
<tr>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
2,672
</td>
<td style="text-align:right;">
3,155
</td>
<td style="text-align:right;">
634
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6,529
</td>
</tr>
<tr>
<td style="text-align:left;">
2003
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
161
</td>
<td style="text-align:right;">
191
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
389
</td>
</tr>
<tr>
<td style="text-align:left;">
2004
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
1,482
</td>
<td style="text-align:right;">
1,408
</td>
<td style="text-align:right;">
310
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3,274
</td>
</tr>
<tr>
<td style="text-align:left;">
2005
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2,285
</td>
<td style="text-align:right;">
1,855
</td>
<td style="text-align:right;">
229
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4,461
</td>
</tr>
<tr>
<td style="text-align:left;">
2006
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
2,685
</td>
<td style="text-align:right;">
2,655
</td>
<td style="text-align:right;">
189
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
5,652
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
3,430
</td>
<td style="text-align:right;">
2,868
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6,483
</td>
</tr>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
3,027
</td>
<td style="text-align:right;">
2,889
</td>
<td style="text-align:right;">
215
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
6,158
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
1,852
</td>
<td style="text-align:right;">
2,615
</td>
<td style="text-align:right;">
207
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
4,700
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1,710
</td>
<td style="text-align:right;">
1,563
</td>
<td style="text-align:right;">
263
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
3,552
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1,004
</td>
<td style="text-align:right;">
671
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1,775
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
820
</td>
<td style="text-align:right;">
403
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1,303
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
670
</td>
<td style="text-align:right;">
415
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1,222
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
785
</td>
<td style="text-align:right;">
342
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1,262
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
872
</td>
<td style="text-align:right;">
342
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1,267
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
866
</td>
<td style="text-align:right;">
433
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
1,373
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1,747
</td>
<td style="text-align:right;">
744
</td>
<td style="text-align:right;">
171
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2,671
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1,793
</td>
<td style="text-align:right;">
711
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
2,578
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
442
</td>
<td style="text-align:right;">
283
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
775
</td>
</tr>
<tr>
<td style="text-align:left;">
2020
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
422
</td>
<td style="text-align:right;">
207
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
662
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
95
</td>
<td style="text-align:right;font-weight: bold;">
10,576
</td>
<td style="text-align:right;font-weight: bold;">
713
</td>
<td style="text-align:right;font-weight: bold;">
41,124
</td>
<td style="text-align:right;font-weight: bold;">
41,876
</td>
<td style="text-align:right;font-weight: bold;">
7,211
</td>
<td style="text-align:right;font-weight: bold;">
2,578
</td>
<td style="text-align:right;font-weight: bold;">
120
</td>
<td style="text-align:right;font-weight: bold;">
104,294
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cor, engins)</span></code></pre></div>
</div>
</div>
</div>
<div id="figures" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Figures</h1>
<div id="graph2-fl---regroupements-dengins" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> <code>graph2</code>: FL - regroupements d’engins</h2>
<p>Pour chaque regroupement d’engins, je veux montrer les FL.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  combi <span class="ot">&lt;-</span> <span class="st">&quot;Combiné&quot;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  lab1 <span class="ot">&lt;-</span> <span class="st">&quot;Longueur (cm)&quot;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  lab2 <span class="ot">&lt;-</span> <span class="st">&quot;Proportion&quot;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  text1 <span class="ot">&lt;-</span> <span class="st">&quot; É = &quot;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  text2 <span class="ot">&lt;-</span> <span class="st">&quot; P)&quot;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;en&quot;</span>){</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  combi <span class="ot">&lt;-</span> <span class="st">&quot;Combined&quot;</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  lab1 <span class="ot">&lt;-</span> <span class="st">&quot;Length (cm)&quot;</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  lab2 <span class="ot">&lt;-</span> <span class="st">&quot;Proportion&quot;</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  text1 <span class="ot">&lt;-</span> <span class="st">&quot; S = &quot;</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  text2 <span class="ot">&lt;-</span> <span class="st">&quot; F)&quot;</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># à définir</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>n_id <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> </span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(source, engin) <span class="sc">%&gt;%</span> </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">nb_id =</span> <span class="fu">n_distinct</span>(ech_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>        ungroup</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> lf <span class="sc">%&gt;%</span> </span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year, outlier <span class="sc">==</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>       <span class="fu">group_by</span>(source, engin, longueur) <span class="sc">%&gt;%</span> </span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>       <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(n_mes, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>       ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>       <span class="fu">left_join</span>(., engins_obs <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, engin, engin_groupe), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;source&quot;</span>, <span class="st">&quot;engin&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>       <span class="fu">left_join</span>(., n_id, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;source&quot;</span>, <span class="st">&quot;engin&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>       <span class="fu">group_by</span>(source, engin) <span class="sc">%&gt;%</span> </span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(<span class="at">engin =</span> <span class="fu">paste0</span>(engin, <span class="st">&quot; (&quot;</span>, <span class="fu">unique</span>(nb_id), text1, <span class="fu">format</span>(<span class="fu">sum</span>(n), <span class="at">big.mark =</span> bm), text2)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>       ungroup</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dat) <span class="co"># 1012 obs et 6 var</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1012    6</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">levels</span>(engins_deb<span class="sc">$</span>engin_groupe), dat<span class="sc">$</span>engin_groupe)</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>g <span class="co"># je veux une figure pour chacun de ces regroupements</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Shrimp trawls&quot; &quot;Other trawls&quot;  &quot;Seines&quot;        &quot;Gillnets&quot;     </span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a><span class="do">## [5] &quot;Longlines&quot;     &quot;Hand gear&quot;     &quot;Traps&quot;</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(dat<span class="sc">$</span>longueur)</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]   4 148</span></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>brks_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>labs_x <span class="ot">&lt;-</span> brks_x</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>labs_x[labs_x <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(g)){</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>  dat_graph <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(engin_groupe <span class="sc">==</span> g[i]) <span class="sc">%&gt;%</span> </span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>               <span class="fu">group_by</span>(engin) <span class="sc">%&gt;%</span> </span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>               ungroup</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dat_graph, <span class="fu">aes</span>(<span class="at">x =</span> longueur, <span class="at">y =</span> prop, <span class="at">color =</span> engin)) <span class="sc">+</span></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>           <span class="fu">facet_wrap</span>(<span class="sc">~</span> engin_groupe) <span class="sc">+</span> <span class="co"># juste pour avoir un titre à chaque panneau</span></span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>           <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;grey50&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>           <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.25</span>,<span class="dv">0</span>), <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>           <span class="fu">labs</span>(<span class="at">x =</span> lab1, <span class="at">y =</span> lab2, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>           <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(brks_x), <span class="fu">max</span>(brks_x)), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> brks_x, <span class="at">labels =</span> labs_x)</span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;graph_&quot;</span>, letters[i]), <span class="at">value =</span> graph)</span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(dat_graph, graph)</span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinaison des figures</span></span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>combi <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(graph_a <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>), </span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a>                   graph_b <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>), </span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>                   graph_c <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>), </span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a>                   graph_d <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>), </span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a>                   graph_e <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>), </span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a>                   graph_f <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>), </span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a>                   graph_g <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>), </span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span>  <span class="dv">2</span>, <span class="at">byrow =</span> T, <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>)</span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a>x_title <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="at">label =</span> lab1, <span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a>y_title <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="at">label =</span> lab2, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">angle =</span> <span class="dv">90</span>)</span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/37052059/how-to-add-a-title-for-a-grid-layout-figure-in-ggplot2</span></span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a>graph2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(y_title, combi, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="dv">1</span>)) <span class="co"># rel_heights values control title margins</span></span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a>graph2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(graph2, x_title, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.05</span>))</span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a>graph2</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-40-1.png" width="864" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(graph_a, graph_b, graph_c, graph_d, graph_e, graph_f, graph_g, x_title, y_title)</span></code></pre></div>
</div>
<div id="graph3-espèces-visées" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> <code>graph3</code>: espèces visées</h2>
<p>L’espèce visée n’est pas une information fournie dans <code>lf</code> ni dans <code>bio</code>. Je vais tenter de l’extraire depuis <code>ziff</code>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>cle <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nbpc&quot;</span>, <span class="st">&quot;date_deb&quot;</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>ziff <span class="sc">%&gt;%</span> <span class="fu">distinct_at</span>(cle) <span class="sc">%&gt;%</span> nrow <span class="co"># 341413</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 341413</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> ziff <span class="sc">%&gt;%</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">group_by_at</span>(cle) <span class="sc">%&gt;%</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">summarise</span>(<span class="at">esp_vis =</span> <span class="fu">unique</span>(prespvis)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>       ungroup</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tmp) <span class="co"># 343222 = plus de lignes = des débarquements avaient &gt; 1 espèce visée?</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 343222      3</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span> </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_at</span>(cle) <span class="sc">%&gt;%</span> </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">esp_vis =</span> <span class="fu">paste</span>(<span class="fu">as.character</span>(<span class="fu">unique</span>(esp_vis)), <span class="at">collapse =</span> <span class="st">&quot;,&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 1,768 x 4</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    nbpc   date_deb       n esp_vis</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt;  &lt;date&gt;     &lt;int&gt; &lt;chr&gt;  </span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 000000 1985-07-01     2 NA,100 </span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 000000 1988-07-21     2 NA,100 </span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 000000 1988-07-22     2 NA,100 </span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 000264 1985-09-04     2 702,100</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 000361 2001-06-19     2 100,142</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 000361 2001-07-12     2 100,142</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 000361 2003-09-20     2 142,100</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 000446 1985-10-18     2 100,702</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 000567 1986-05-27     2 199,100</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 000601 1985-08-02     2 702,NA </span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 1,758 more rows</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Effectivement...</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cle, tmp)</span></code></pre></div>
<p>Je ne suis pas capable d’apparier les données <code>ziff</code> à celles <code>lf</code> pour savoir qu’elle était l’espèce visée pour chaque capture d’où des échantillons ont été prélevés.</p>
<p>Je vais par contre regarder les données <code>ziff</code> pour résumer la période 1993–2020.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>dat_graph <span class="ot">&lt;-</span> ziff <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(dat_graph, <span class="fu">is.na</span>(prespvis))); <span class="fu">length</span>(cor) <span class="co"># 43059 lignes</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 43059</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>dat_graph[cor, ] <span class="sc">%&gt;%</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(prov) <span class="sc">%&gt;%</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nblignes =</span> <span class="fu">n</span>(), <span class="at">catch =</span> <span class="fu">sum</span>(pds_vift, <span class="at">na.rm =</span> T))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 3 x 3</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   prov  nblignes  catch</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt;</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 N-B         26   17.2</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 QC       20103 5080. </span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 T-N      22930 4243.</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co"># La problématique ne semble pas juste être TN</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> dat_graph <span class="sc">%&gt;%</span> </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>       <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">summarise</span>(<span class="at">deb_avec =</span> <span class="fu">sum</span>(pds_vift[<span class="sc">!</span><span class="fu">is.na</span>(prespvis)], <span class="at">na.rm =</span> T),</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">deb_sans =</span> <span class="fu">sum</span>(pds_vift[<span class="fu">is.na</span>(prespvis)], <span class="at">na.rm =</span> T),</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">deb_tot =</span> deb_avec <span class="sc">+</span> deb_sans,</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">perc =</span> deb_sans <span class="sc">/</span> deb_tot <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>       ungroup</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>tmp</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 28 x 5</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="do">##    annee deb_avec deb_sans deb_tot  perc</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  1  1993  17893.      559.  18452.  3.03</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  2  1994    261.      276.    537. 51.3 </span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  3  1995     20.0     165.    185. 89.2 </span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  4  1996     29.4     287.    317. 90.7 </span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  5  1997    470.     4322.   4792. 90.2 </span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  6  1998   2635.      594.   3229. 18.4 </span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  7  1999   6472.      418.   6890.  6.07</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  8  2000   6573.      283.   6857.  4.13</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  9  2001   6773.      178.   6950.  2.56</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 10  2002   6254.      275.   6529.  4.22</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="do">## # ... with 18 more rows</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(annee <span class="sc">!=</span> <span class="dv">1997</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(deb_sans) <span class="sc">%&gt;%</span> mean <span class="co"># en excluant 1997, 186 t par année en moyenne débarquées sans esp_vis</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 185.8846</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 1997 n&#39;est pas une année de moratoire. Pourquoi les espèces visées prennent autant d&#39;importance?</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>dat_graph <span class="sc">%&gt;%</span> </span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(annee <span class="sc">==</span> <span class="dv">1997</span>, <span class="fu">is.na</span>(prespvis)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(prov) <span class="sc">%&gt;%</span> </span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(pds_vift, <span class="at">na.rm =</span> T))</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 2 x 2</span></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a><span class="do">##   prov  catch</span></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 QC     519.</span></span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 T-N   3803.</span></span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a><span class="co"># en 1997, la vaste majorité du problème des espèces visées est dû à TN</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>dat_graph <span class="sc">%&gt;%</span> </span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(annee <span class="sc">==</span> <span class="dv">1997</span>, <span class="fu">is.na</span>(prespvis), prov <span class="sc">==</span> <span class="st">&quot;T-N&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(prespcap) <span class="sc">%&gt;%</span> </span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(pds_vift, <span class="at">na.rm =</span> T))</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 1 x 2</span></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a><span class="do">##   prespcap catch</span></span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a><span class="do">##      &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a><span class="do">## 1       NA 3803.</span></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Même l&#39;espèce principale capturée n&#39;est pas fournie</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>dat_graph <span class="sc">%&gt;%</span> </span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(annee <span class="sc">==</span> <span class="dv">1997</span>, <span class="fu">is.na</span>(prespvis), prov <span class="sc">==</span> <span class="st">&quot;T-N&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(engin_fr) <span class="sc">%&gt;%</span> </span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(pds_vift, <span class="at">na.rm =</span> T))</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 7 x 2</span></span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a><span class="do">##   engin_fr                               catch</span></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;fct&gt;                                  &lt;dbl&gt;</span></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Chalut de fond à panneaux (arrière)   19.4  </span></span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Chalut mésopélagique (arrière)         0.3  </span></span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Filet maillant (fixe)                160.   </span></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Ligne à main (appâtée)               265.   </span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 Palangre                            3301.   </span></span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 Seine danoise                          0.699</span></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a><span class="do">## 7 Trappe                                56.9</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a><span class="co"># À partir de l&#39;engin, on pourrait peut-être statué que ça visait principalement la morue?</span></span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Espèces à ne pas prioriser (en dehors du top 6)</span></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a>dat_graph[<span class="fu">is.na</span>(dat_graph<span class="sc">$</span>prespvis), <span class="st">&quot;prespvis&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co"># pour ne pas avoir des 999 et des NA</span></span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> dat_graph <span class="sc">%&gt;%</span> </span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(annee <span class="sc">%in%</span> my_year) <span class="sc">%&gt;%</span> </span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(prespvis) <span class="sc">%&gt;%</span></span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(pds_vift, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>      ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(<span class="fu">desc</span>(catch)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(prespvis) <span class="sc">%&gt;%</span> </span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>      .[<span class="dv">7</span><span class="sc">:</span><span class="fu">length</span>(.)]</span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a>sp</span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 140 200 360 171 702 143 199 250 928 176 160 174 705 170 101 149 362 110 701</span></span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a><span class="do">## [20] 197 354 141 700 351 352 615   1 617 161 356 359 173 175</span></span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">with</span>(dat_graph, prespvis <span class="sc">%in%</span> sp)); <span class="fu">length</span>(cor) <span class="co"># 9085 lignes</span></span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 9085</span></span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a>dat_graph<span class="sc">$</span>prespvis[cor] <span class="ot">&lt;-</span> <span class="dv">9999</span> <span class="co"># code bidon</span></span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a>dat_graph <span class="ot">&lt;-</span> dat_graph <span class="sc">%&gt;%</span> </span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a>             <span class="fu">group_by</span>(annee, prespvis) <span class="sc">%&gt;%</span></span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a>             <span class="fu">summarise</span>(<span class="at">catch =</span> <span class="fu">sum</span>(pds_vift, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a>             <span class="fu">group_by</span>(annee) <span class="sc">%&gt;%</span> </span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">perc =</span> (catch <span class="sc">/</span> <span class="fu">sum</span>(catch)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a>                    <span class="at">perc_lab =</span> <span class="fu">ifelse</span>(perc <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="st">&quot;&quot;</span>, <span class="fu">format</span>(<span class="fu">round</span>(perc, <span class="dv">1</span>), <span class="at">nsmall =</span> <span class="dv">1</span>, <span class="at">decimal.mark =</span> dm))) <span class="sc">%&gt;%</span> </span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a>             ungroup</span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a>dat_graph<span class="sc">$</span>prespvis <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_graph<span class="sc">$</span>prespvis, <span class="at">levels =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(dat_graph<span class="sc">$</span>prespvis), <span class="at">decreasing =</span> T), <span class="at">ordered =</span> T)</span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">prespvis =</span> <span class="fu">levels</span>(dat_graph<span class="sc">$</span>prespvis),</span>
<span id="cb59-107"><a href="#cb59-107" aria-hidden="true" tabindex="-1"></a>                <span class="at">sp_vis_fr =</span> <span class="fu">c</span>(<span class="st">&quot;Autres&quot;</span>, <span class="st">&quot;Inconnu&quot;</span>, <span class="st">&quot;Flétan du Groenland&quot;</span>, <span class="st">&quot;Plie grise&quot;</span>, <span class="st">&quot;Flétan atlantique&quot;</span>, <span class="st">&quot;Sébastes&quot;</span>, </span>
<span id="cb59-108"><a href="#cb59-108" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Morue franche&quot;</span>),</span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true" tabindex="-1"></a>                <span class="at">sp_vis_en =</span> <span class="fu">c</span>(<span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Greenland halibut&quot;</span>, <span class="st">&quot;Witch flounder&quot;</span>, <span class="st">&quot;Atlantic halibut&quot;</span>, <span class="st">&quot;Redfish&quot;</span>, </span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Atlantic cod&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">sp_vis_fr =</span> <span class="fu">factor</span>(sp_vis_fr, <span class="at">levels =</span> sp_vis_fr),</span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true" tabindex="-1"></a>                <span class="at">sp_vis_en =</span> <span class="fu">factor</span>(sp_vis_en, <span class="at">levels =</span> sp_vis_en))</span>
<span id="cb59-113"><a href="#cb59-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-114"><a href="#cb59-114" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dat_graph) <span class="co"># 193 obs et 5 var</span></span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 193   5</span></span>
<span id="cb59-116"><a href="#cb59-116" aria-hidden="true" tabindex="-1"></a>dat_graph <span class="ot">&lt;-</span> <span class="fu">left_join</span>(dat_graph, ajout, <span class="at">by =</span> <span class="st">&quot;prespvis&quot;</span>)</span>
<span id="cb59-117"><a href="#cb59-117" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dat_graph) <span class="co"># 193 obs et 7 var</span></span>
<span id="cb59-118"><a href="#cb59-118" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 193   7</span></span>
<span id="cb59-119"><a href="#cb59-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true" tabindex="-1"></a>brks_x <span class="ot">&lt;-</span> my_year</span>
<span id="cb59-121"><a href="#cb59-121" aria-hidden="true" tabindex="-1"></a>labs_x <span class="ot">&lt;-</span> brks_x</span>
<span id="cb59-122"><a href="#cb59-122" aria-hidden="true" tabindex="-1"></a>labs_x[labs_x <span class="sc">%%</span> <span class="dv">5</span> <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true" tabindex="-1"></a>brks_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)</span>
<span id="cb59-125"><a href="#cb59-125" aria-hidden="true" tabindex="-1"></a>labs_y <span class="ot">&lt;-</span> brks_y</span>
<span id="cb59-126"><a href="#cb59-126" aria-hidden="true" tabindex="-1"></a>labs_y[labs_y <span class="sc">%%</span> <span class="dv">20</span> <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-128"><a href="#cb59-128" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (langue <span class="sc">==</span> <span class="st">&quot;fr&quot;</span>){</span>
<span id="cb59-129"><a href="#cb59-129" aria-hidden="true" tabindex="-1"></a>  lab1 <span class="ot">&lt;-</span> <span class="st">&quot;Année&quot;</span></span>
<span id="cb59-130"><a href="#cb59-130" aria-hidden="true" tabindex="-1"></a>  lab2 <span class="ot">&lt;-</span> <span class="st">&quot;% des débarquements annuels&quot;</span></span>
<span id="cb59-131"><a href="#cb59-131" aria-hidden="true" tabindex="-1"></a>  lab3 <span class="ot">&lt;-</span> <span class="st">&quot;Espèce visée&quot;</span></span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true" tabindex="-1"></a>  dat_graph<span class="sc">$</span>esp_vis <span class="ot">&lt;-</span> dat_graph<span class="sc">$</span>sp_vis_fr</span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true" tabindex="-1"></a>  lab1 <span class="ot">&lt;-</span> <span class="st">&quot;Year&quot;</span></span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true" tabindex="-1"></a>  lab2 <span class="ot">&lt;-</span> <span class="st">&quot;% of annual landings&quot;</span></span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true" tabindex="-1"></a>  lab3 <span class="ot">&lt;-</span> <span class="st">&quot;Targeted species&quot;</span></span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true" tabindex="-1"></a>  dat_graph<span class="sc">$</span>esp_vis <span class="ot">&lt;-</span> dat_graph<span class="sc">$</span>sp_vis_en</span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true" tabindex="-1"></a>graph3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dat_graph, <span class="fu">aes</span>(<span class="at">x =</span> annee, <span class="at">y =</span> perc, <span class="at">fill =</span> esp_vis)) <span class="sc">+</span></span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-142"><a href="#cb59-142" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> brks_x, <span class="at">labels =</span> labs_x) <span class="sc">+</span></span>
<span id="cb59-143"><a href="#cb59-143" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">breaks =</span> brks_y, <span class="at">labels =</span> labs_y) <span class="sc">+</span></span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Paired&quot;</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> perc_lab), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> lab1, <span class="at">y =</span> lab2, <span class="at">fill =</span> lab3) <span class="sc">+</span></span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true" tabindex="-1"></a>          <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">reverse =</span> T))</span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true" tabindex="-1"></a>graph3</span></code></pre></div>
<p><img src="02_preparation_data_files/figure-html/unnamed-chunk-42-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="sauvegarde" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Sauvegarde</h1>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(lf, <span class="at">file =</span> dat_LF)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(bio, <span class="at">file =</span> dat_bio)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;^graph[0-9]+&quot;</span>), <span class="at">file =</span> <span class="fu">paste0</span>(result, <span class="st">&quot;02_graphs_&quot;</span>, langue,<span class="st">&quot;.Rda&quot;</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;^table[0-9]+&quot;</span>), <span class="at">file =</span> <span class="fu">paste0</span>(result, <span class="st">&quot;02_tables_&quot;</span>, langue,<span class="st">&quot;.Rda&quot;</span>))</span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Frechet1986a" class="csl-entry">
Fréchet, A., et Gascon, D. 1986. <span>Une nouvelle matrice de capture a l’âge pour Ie stock de morue des divisions 4R, 4S et 3Pn</span>. CSCPCA Doc. de Rech. 86/104: 34 p.
</div>
<div id="ref-Savard2013_fr" class="csl-entry">
Savard, L., Gauthier, J., Bourdages, H., et Desgagnés, M. 2013. <span>Prises accessoires de la pêche à la crevette nordique dans l’estuaire et le golfe du Saint-Laurent</span>. Secr. can. de consult. sci. du MPO. Doc. de rech. 2012/151: ii + 56 p.
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
